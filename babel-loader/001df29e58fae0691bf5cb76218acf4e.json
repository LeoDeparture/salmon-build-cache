{"ast":null,"code":"import \"antd/lib/back-top/style\";\nimport _BackTop from \"antd/lib/back-top\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _Object$assign from \"@babel/runtime-corejs2/core-js/object/assign\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _Object$keys2 from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"antd/lib/layout/style\";\nimport _Layout from \"antd/lib/layout\";\nimport groupBy from 'lodash/groupBy';\nimport Link from 'next/link';\nimport React from 'react';\nimport styled from 'styled-components';\nimport { TemplateContext } from '../containers/Contexts';\nimport { groupAndFormat } from './commonJs';\nimport ProcessIndicator from './ProcessIndicator';\nimport BasicInfo from './step/BasicInfo';\nimport Cost from './step/Cost';\nimport PreviewAndConfirm from './step/PreviewAndConfirm';\nimport ServiceTime from './step/ServiceTime';\nimport StudentAndOrder from './step/StudentAndOrder';\nimport TargetPosition from './step/TargetPosition';\nvar Content = _Layout.Content;\n\nvar RootComponent =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(RootComponent, _React$Component);\n\n  function RootComponent() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, RootComponent);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(RootComponent)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      step: 0,\n      createFormVariables: {\n        templateId: _this.props.templateId,\n        expiresInMinutes: 0,\n        note: '',\n        studentName: '',\n        studentIDNumber: '',\n        studentPhoneNumber: '',\n        studentEmail: '',\n        studentWechat: '',\n        orderSource: '',\n        orderId: '',\n        servicePeriodTypeId: '',\n        servicePeriodStartAt: '',\n        servicePeriodEndAt: '',\n        freezePeriodStartAt: '',\n        freezePeriodEndAt: '',\n        companyLevelId: '',\n        companyExcludedIds: [],\n        businessLineId: '',\n        targetCityIds: [],\n        targetForeignCityIds: [],\n        paymentTypeId: '',\n        originalPrice: 0,\n        discount: 0,\n        deposit: 0,\n        left: 0,\n        totalPrice: 0,\n        timeLimit: 0,\n        priceDifferenceTypeId: '',\n        companyLevelComposeRepayId: '',\n        repay: '',\n        companyLevelComposeReturnId: '',\n        return: '',\n        refundTypeId: ''\n      },\n      previewData: null,\n      companysGroupByLevelName: null,\n      companysGroupByIndustry: null\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"componentDidMount\", function () {\n      var agreementCompanies = _this.props.agreementCompanies; // 以 companyLevel name 分组公司数据\n\n      var companysGroupByLevelName = groupBy(agreementCompanies, function (v) {\n        return v.level.name;\n      });\n\n      _this.setState({\n        companysGroupByLevelName: companysGroupByLevelName\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderCompanyOptions\", function (selectedCompanyLevel) {\n      var name = selectedCompanyLevel.name;\n\n      var companys = _objectSpread({}, _this.state.companysGroupByLevelName);\n\n      var result = []; // 保留选择的类型\n\n      for (var _i = 0, _Object$keys = _Object$keys2(companys); _i < _Object$keys.length; _i++) {\n        var key = _Object$keys[_i];\n\n        if (key === name) {\n          result = groupAndFormat(companys[key], function (v) {\n            return v.industry;\n          });\n        }\n      }\n\n      return result;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"updatePreviewData\", function (previewData) {\n      _this.setState({\n        previewData: previewData\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"assignVariables\",\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(obj) {\n        var tempVariables;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                tempVariables = _objectSpread({}, _this.state.createFormVariables);\n\n                _Object$assign(tempVariables, obj);\n\n                _this.setState({\n                  createFormVariables: tempVariables\n                });\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"toLastStep\", function () {\n      _this.setState(function (prevState) {\n        return {\n          step: prevState.step - 1\n        };\n      });\n\n      _this.backTop.scrollToTop();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"toNextStep\", function () {\n      _this.setState(function (prevState) {\n        return {\n          step: prevState.step + 1\n        };\n      });\n\n      _this.backTop.scrollToTop();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onRefBackTop\", function (ref) {\n      _this.backTop = ref;\n    });\n\n    return _this;\n  }\n\n  _createClass(RootComponent, [{\n    key: \"render\",\n    value: function render() {\n      var step = this.state.step;\n      var _this$props = this.props,\n          enumData = _this$props.enumData,\n          templateType = _this$props.templateType;\n      return React.createElement(React.Fragment, null, React.createElement(HeaderWrapper, null, React.createElement(TemplateContext.Consumer, null, function (template) {\n        return React.createElement(\"h1\", null, \"\\u804C\\u95EE \", template.name, \"\\u670D\\u52A1\\u534F\\u8BAE\");\n      }), React.createElement(Link, {\n        href: '/agreement-management'\n      }, React.createElement(_Button, {\n        style: HeaderButtonStyle,\n        type: \"default\"\n      }, \"\\u53D6\\u6D88\"))), React.createElement(BodyWrapper, null, React.createElement(BodyHeaderWrapper, null, React.createElement(ProcessIndicator, {\n        step: step,\n        templateType: templateType\n      })), React.createElement(BodyContentWrapper, null, React.createElement(BasicInfo, {\n        hidden: step !== 0,\n        toNextStep: this.toNextStep,\n        assignVariables: this.assignVariables\n      }), React.createElement(StudentAndOrder, {\n        hidden: step !== 1,\n        toLastStep: this.toLastStep,\n        toNextStep: this.toNextStep,\n        assignVariables: this.assignVariables\n      }), React.createElement(ServiceTime, {\n        hidden: step !== 2,\n        toLastStep: this.toLastStep,\n        toNextStep: this.toNextStep,\n        assignVariables: this.assignVariables,\n        servicePeriodTypes: enumData.listServicePeriodTypeEnum\n      }), templateType === 'alpha' && React.createElement(TargetPosition, {\n        hidden: step !== 3,\n        toLastStep: this.toLastStep,\n        toNextStep: this.toNextStep,\n        assignVariables: this.assignVariables,\n        agreementCompanyLevels: enumData.listAgreementCompanyLevelEnum,\n        businessLines: enumData.listAgreementBusinessLineEnum,\n        foreignCities: enumData.listForeignCityEnum,\n        renderCompanyOptions: this.renderCompanyOptions\n      }), React.createElement(Cost, {\n        hidden: step !== (templateType === 'alpha' ? 4 : 3),\n        templateType: templateType,\n        toLastStep: this.toLastStep,\n        toNextStep: this.toNextStep,\n        assignVariables: this.assignVariables,\n        enumData: enumData,\n        variables: this.state.createFormVariables,\n        createAgreementView: this.props.createAgreementView,\n        updatePreviewData: this.updatePreviewData,\n        renderCompanyOptions: this.renderCompanyOptions\n      })), React.createElement(PreviewAndConfirm, {\n        hidden: step !== (templateType === 'alpha' ? 5 : 4),\n        templateType: templateType,\n        previewData: this.state.previewData,\n        variables: this.state.createFormVariables,\n        createAgreement: this.props.createAgreement,\n        toLastStep: this.toLastStep\n      })), React.createElement(_BackTop, {\n        ref: this.onRefBackTop\n      }));\n    }\n  }]);\n\n  return RootComponent;\n}(React.Component);\n\nexport default RootComponent; // Header\n\nvar HeaderWrapper = styled.div.withConfig({\n  displayName: \"RootComponent__HeaderWrapper\",\n  componentId: \"sc-1iswasg-0\"\n})([\"display:flex;align-items:center;justify-content:space-between;height:60px;background-color:#fff;h1{margin:0 0 0 32px;font-size:20px;line-height:60px;color:#4a4a4a;}\"]);\nvar HeaderButtonStyle = {\n  marginRight: '24px'\n}; // Body\n\nvar BodyWrapper = styled(Content).withConfig({\n  displayName: \"RootComponent__BodyWrapper\",\n  componentId: \"sc-1iswasg-1\"\n})([\"min-width:1136px;min-height:852px;padding-bottom:40px;margin:24px;background-color:#fff;\"]);\nvar BodyHeaderWrapper = styled.div.withConfig({\n  displayName: \"RootComponent__BodyHeaderWrapper\",\n  componentId: \"sc-1iswasg-2\"\n})([\"display:flex;align-items:center;justify-content:center;height:112px;min-width:1136px;\"]);\nvar BodyContentWrapper = styled.div.withConfig({\n  displayName: \"RootComponent__BodyContentWrapper\",\n  componentId: \"sc-1iswasg-3\"\n})([\"display:flex;align-items:center;flex-direction:column;width:500px;margin:0 auto;\"]); // 子组件通用\n\nexport var ChildTitle = styled.p.withConfig({\n  displayName: \"RootComponent__ChildTitle\",\n  componentId: \"sc-1iswasg-4\"\n})([\"margin:30px 0 40px 0;font-size:16px;font-weight:bold;line-height:24px;color:rgba(0,0,0,0.85);text-align:center;&:first-child{margin-top:0;}\"]);\nexport var HiddenStyle = {\n  display: 'none'\n};\nexport var FormStyle = {\n  width: '100%'\n};\nexport var FormItemTitle = styled.span.withConfig({\n  displayName: \"RootComponent__FormItemTitle\",\n  componentId: \"sc-1iswasg-5\"\n})([\"margin-right:8px;font-size:16px;line-height:22px;color:#4a4a4a;\"]);\nexport var RequiredFormItemTitle = styled.span.withConfig({\n  displayName: \"RootComponent__RequiredFormItemTitle\",\n  componentId: \"sc-1iswasg-6\"\n})([\"margin-right:8px;font-size:16px;line-height:22px;color:#4a4a4a;&::before{display:inline-block;margin-right:4px;font-family:sans-serif,SimSun;font-size:16px;line-height:1;color:#f5222d;content:'*';}\"]);\nexport var FormItemSubtitle = styled.span.withConfig({\n  displayName: \"RootComponent__FormItemSubtitle\",\n  componentId: \"sc-1iswasg-7\"\n})([\"font-size:12px;line-height:18px;color:#bfbfbf;\"]);\nexport var FormItemBodyWrapper = styled.div.withConfig({\n  displayName: \"RootComponent__FormItemBodyWrapper\",\n  componentId: \"sc-1iswasg-8\"\n})([\"position:relative;\"]);\nexport var ButtonWrapperStyle = {\n  textAlign: 'center'\n};\nexport var buttonStyle = {\n  margin: '0 6px'\n};\nexport var requiredMessage = '此字段无法为空'; // 输入上限规则\n\nexport var lengthLimit = {\n  max: 500,\n  message: '超过输入长度上限'\n}; // 输入框规则 + 输入上限\n\nexport var requireRule = [{\n  message: requiredMessage,\n  required: true,\n  whitespace: true\n}, lengthLimit]; // 非文字输入框规则, 如日期, 选择框\n\nexport var noTxtRequireRule = [{\n  message: requiredMessage,\n  required: true\n}];","map":null,"metadata":{},"sourceType":"module"}
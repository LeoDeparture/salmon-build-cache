{"ast":null,"code":"import \"antd/lib/config-provider/style\";\nimport _ConfigProvider from \"antd/lib/config-provider\";\nimport \"antd/lib/table/style\";\nimport _Table from \"antd/lib/table\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport \"antd/lib/message/style\";\nimport _message from \"antd/lib/message\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport React, { Component } from 'react';\nimport Empty from '../../../../components/Empty';\nimport InlineAccountInfo from '../../../../components/InlineAccountInfo';\nimport OperatorSelect from './OperatorSelect';\n\nvar ReviewConfig =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ReviewConfig, _Component);\n\n  function ReviewConfig(props) {\n    var _this;\n\n    _classCallCheck(this, ReviewConfig);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ReviewConfig).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"onSelectOperator\",\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(creatorId, reviewerId) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _this.setState({\n                  loading: true,\n                  modifiedCreatorId: creatorId\n                });\n\n                _this.props.updateOperator({\n                  creatorId: creatorId,\n                  reviewerId: reviewerId\n                }).then(function (result) {\n                  if (result) {\n                    _message.success('修改成功。');\n                  }\n                }).finally(function () {\n                  _this.setState({\n                    loading: false,\n                    modifiedCreatorId: ''\n                  });\n                });\n\n              case 2:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x, _x2) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    _this.state = {\n      loading: false,\n      modifiedCreatorId: ''\n    };\n    return _this;\n  } // 选择审核人\n\n\n  _createClass(ReviewConfig, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var operators = this.props.operators;\n      var _this$state = this.state,\n          loading = _this$state.loading,\n          modifiedCreatorId = _this$state.modifiedCreatorId; // 处理数据源\n\n      var dataSource = operators.map(function (operator) {\n        return _objectSpread({\n          key: operator.id\n        }, operator);\n      }); // 生成表格 column\n\n      var columnsData = [{\n        title: '服务单创建人',\n        key: 'account',\n        width: '37%',\n        render: function render(account) {\n          return React.createElement(InlineAccountInfo, {\n            account: account\n          });\n        }\n      }, {\n        title: '指定审核人',\n        key: 'reviewer',\n        width: '63%',\n        render: function render(_value, record) {\n          var reviewer = record.reviewer; // 如果审核人列表里面有该id, 执行回填\n\n          var value = reviewer && reviewer.id && operators.find(function (v) {\n            return v.id === reviewer.id;\n          }) ? reviewer.id : '';\n          return React.createElement(OperatorSelect, {\n            value: value,\n            operators: operators,\n            onSelect: _this2.onSelectOperator.bind(_this2, record.id),\n            loading: modifiedCreatorId === record.id && loading\n          });\n        }\n      }];\n      var columns = columnsData.map(function (column) {\n        return _objectSpread({}, column, {\n          dataIndex: column.key,\n          ellipsis: true\n        });\n      });\n\n      var renderEmpty = function renderEmpty() {\n        return React.createElement(Empty, {\n          description: \"\\u6682\\u65E0\\u6570\\u636E\"\n        });\n      };\n\n      return React.createElement(React.Fragment, null, React.createElement(_ConfigProvider, {\n        renderEmpty: renderEmpty\n      }, React.createElement(_Table, {\n        style: {\n          flex: 1\n        },\n        pagination: false,\n        dataSource: dataSource,\n        columns: columns\n      })));\n    }\n  }]);\n\n  return ReviewConfig;\n}(Component);\n\nexport { ReviewConfig as default };","map":null,"metadata":{},"sourceType":"module"}
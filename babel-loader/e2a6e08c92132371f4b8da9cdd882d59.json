{"ast":null,"code":"import \"antd/lib/table/style\";\nimport _Table from \"antd/lib/table\";\nimport _Object$assign from \"@babel/runtime-corejs2/core-js/object/assign\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport \"antd/lib/icon/style\";\nimport _Icon from \"antd/lib/icon\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport { format } from 'date-fns';\nimport Link from 'next/link';\nimport React from 'react';\nimport styled from 'styled-components';\nimport { handleImgError } from '../../../lib/commonJs';\nimport CONFIG from '../../../lib/config';\n\nvar UserManagementTable =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(UserManagementTable, _React$Component);\n\n  function UserManagementTable() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, UserManagementTable);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(UserManagementTable)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSearch\", function (confirm) {\n      // 关闭搜索框\n      confirm(); // 重新请求数据\n\n      var keywords = _this.props.keywords;\n\n      _this.props.refetch(keywords);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleReset\", function (dataIndex, clearFilters) {\n      // clear keywords and refetch data\n      var keywords = _this.props.keywords;\n      keywords[dataIndex] = '';\n\n      _this.setState({\n        keywords: keywords\n      });\n\n      _this.props.refetch(keywords);\n\n      clearFilters();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleChange\", function (dataIndex, e) {\n      var keywords = _this.props.keywords;\n      keywords[dataIndex] = e.target.value;\n\n      _this.setState({\n        keywords: keywords\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"filterDropdownRender\", function (dataIndex, title, funcs) {\n      var confirm = funcs.confirm,\n          clearFilters = funcs.clearFilters;\n      var placeholderText = \"\\u641C\\u7D22\".concat(title);\n      return React.createElement(Dropdown, null, React.createElement(_Input, {\n        style: {\n          width: 130,\n          marginRight: 8\n        },\n        placeholder: placeholderText,\n        value: _this.props.keywords[dataIndex],\n        onChange: _this.handleChange.bind(_assertThisInitialized(_this), dataIndex),\n        onPressEnter: _this.handleSearch.bind(_assertThisInitialized(_this), confirm)\n      }), React.createElement(_Button, {\n        type: \"primary\",\n        onClick: _this.handleSearch.bind(_assertThisInitialized(_this), confirm)\n      }, \"\\u641C\\u7D22\"), React.createElement(_Button, {\n        style: {\n          marginLeft: 8\n        },\n        onClick: _this.handleReset.bind(_assertThisInitialized(_this), dataIndex, clearFilters)\n      }, \"\\u91CD\\u7F6E\"));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"expandedRowRender\", function (record) {\n      var avatar = record.avatar,\n          educationInfo = record.educationInfo,\n          jobSkills = record.jobSkills,\n          certificates = record.certificates;\n      return React.createElement(ExpandedRow, null, React.createElement(\"img\", {\n        alt: \"\\u5934\\u50CF\",\n        src: avatar || '/static/default_avatar.png',\n        onError: handleImgError\n      }), React.createElement(\"div\", {\n        style: {\n          marginLeft: '50px'\n        }\n      }, React.createElement(\"p\", null, \"\\u6559\\u80B2\\u4FE1\\u606F\\uFF1A\", React.createElement(\"span\", null, educationInfo)), React.createElement(\"p\", null, \"\\u6280\\u80FD\\u8BC1\\u4E66\\uFF1A\", React.createElement(\"span\", null, jobSkills)), React.createElement(\"p\", null, \"\\u4ECE\\u4E1A\\u8D44\\u683C\\u8BC1\\uFF1A\", React.createElement(\"span\", null, certificates))));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"operatingRender\", function (_text, record) {\n      var id = record.id;\n      return React.createElement(Link, {\n        href: \"/user-details/\".concat(id)\n      }, React.createElement(\"a\", null, \"\\u67E5\\u770B\\u8BE6\\u60C5\"));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"filterIconRender\", function (dataIndex) {\n      var keywords = _this.props.keywords;\n      return React.createElement(_Icon, {\n        type: \"search\" // 如果搜索关键词存在, 高亮图标\n        ,\n        style: {\n          color: keywords[dataIndex] ? '#108ee9' : '#aaa'\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleStudentsData\", function (data) {\n      return data.map(function (student) {\n        var id = student.id,\n            studentNo = student.studentNo,\n            cvs = student.cvs,\n            createdAt = student.createdAt,\n            operatorAccount = student.operatorAccount;\n        var person = student.account.person;\n        var avatar = person.avatar,\n            name = person.name,\n            nickname = person.nickname,\n            gender = person.gender; // 处理 证书/工作技能/教育 信息\n\n        var otherInfos = {\n          certificates: '',\n          jobSkills: '',\n          educationInfo: ''\n        };\n\n        if (cvs.length > 0) {\n          otherInfos = {\n            certificates: cvs[0].certificates && cvs[0].certificates.length ? cvs[0].certificates.map(function (v) {\n              return v.name;\n            }).join('、') : '- -',\n            jobSkills: cvs[0].jobSkills && cvs[0].jobSkills.length ? cvs[0].jobSkills.map(function (v) {\n              return v.name;\n            }).join('、') : '- -',\n            educationInfo: cvs[0].educationExperiences && cvs[0].educationExperiences.length ? cvs[0].educationExperiences.map(function (v) {\n              return \"\".concat(v.degree.name, \" - \").concat(format(v.graduateTime, 'YYYY/MM'));\n            }).join('、') : '- -'\n          };\n        }\n\n        return _objectSpread({\n          id: id,\n          key: studentNo,\n          studentNo: studentNo,\n          avatar: avatar ? avatar : CONFIG.default.avatar,\n          gender: gender ? gender.name : '- -',\n          name: name ? name : '- -',\n          nickname: nickname ? nickname : '- -',\n          operatorName: operatorAccount ? operatorAccount.account.person.nickname : '- -',\n          createdAt: format(createdAt, 'YYYY/MM/DD'),\n          operating: ''\n        }, otherInfos);\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(UserManagementTable, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          footer = _this$props.footer,\n          dataSource = _this$props.dataSource,\n          pageInfo = _this$props.pageInfo; // header data of table\n\n      var headerData = [['studentNo', 'ID'], ['name', '姓名'], ['gender', '性别'], ['nickname', '昵称'], ['createdAt', '注册日期'], ['operatorName', '运营人员'], ['operating', '操作']];\n      var columns = headerData.map(function (v) {\n        var _v = _slicedToArray(v, 2),\n            dataIndex = _v[0],\n            title = _v[1];\n\n        var item = {\n          dataIndex: dataIndex,\n          key: dataIndex,\n          title: title,\n          ellipsis: true\n        }; // 有筛选项的列, 增加 filterDropdown\n\n        if (dataIndex === 'studentNo' || dataIndex === 'name' || dataIndex === 'nickname' || dataIndex === 'purchasedProducts') {\n          var searchObj = {\n            filterDropdown: _this2.filterDropdownRender.bind(_this2, dataIndex, title),\n            filterIcon: _this2.filterIconRender.bind(_this2, dataIndex)\n          };\n\n          _Object$assign(item, searchObj);\n        } // 渲染查看详情列\n\n\n        if (dataIndex === 'operating') {\n          _Object$assign(item, {\n            render: _this2.operatingRender\n          });\n        }\n\n        return item;\n      });\n      return React.createElement(_Table, {\n        style: {\n          flex: 1\n        },\n        columns: columns,\n        dataSource: this.handleStudentsData(dataSource),\n        expandedRowRender: this.expandedRowRender,\n        footer: pageInfo && pageInfo.hasNextPage ? footer : null,\n        pagination: false,\n        locale: {\n          emptyText: '暂无数据'\n        }\n      });\n    }\n  }]);\n\n  return UserManagementTable;\n}(React.Component); // Styled Components\n\n\nexport { UserManagementTable as default };\nvar ExpandedRow = styled.div.withConfig({\n  displayName: \"UserManagementTable__ExpandedRow\",\n  componentId: \"sc-1xslsnf-0\"\n})([\"display:flex;align-items:center;color:#ccc;span{color:#000;}img{width:100px;height:100px;background-color:#ddd;border-radius:50%;}\"]);\nvar Dropdown = styled.div.withConfig({\n  displayName: \"UserManagementTable__Dropdown\",\n  componentId: \"sc-1xslsnf-1\"\n})([\"padding:8px;background:#fff;border-radius:6px;box-shadow:0 1px 6px rgba(0,0,0,0.2);\"]);","map":null,"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import \"antd/lib/popover/style\";\nimport _Popover from \"antd/lib/popover\";\nimport \"antd/lib/badge/style\";\nimport _Badge from \"antd/lib/badge\";\nimport \"antd/lib/breadcrumb/style\";\nimport _Breadcrumb from \"antd/lib/breadcrumb\";\nimport \"antd/lib/affix/style\";\nimport _Affix from \"antd/lib/affix\";\nimport \"antd/lib/alert/style\";\nimport _Alert from \"antd/lib/alert\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/message/style\";\nimport _message from \"antd/lib/message\";\nimport _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport \"antd/lib/icon/style\";\nimport _Icon from \"antd/lib/icon\";\nimport \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _Object$assign from \"@babel/runtime-corejs2/core-js/object/assign\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport { format } from 'date-fns';\nimport uniqBy from 'lodash/uniqBy';\nimport Link from 'next/link';\nimport Router from 'next/router';\nimport React from 'react';\nimport FilePicker from '../../../../components/FilePicker';\nimport ModalTitle from '../../../../components/ModalTitle';\nimport PageHeader from '../../../../components/PageLayout/PageHeader';\nimport SortableModal from '../../../../components/SortableModal';\nimport { breakLine, errMessage, parseErrorCode } from '../../../../lib/commonJs';\nimport { handleConfirmOtherError } from '../../../../lib/handleError';\nimport { countCourse } from '../../../pathwayTemplate/commonJs';\nimport CourseCountIndicator from '../../../pathwayTemplate/components/CourseCountIndicator';\nimport { AlertWrapper, BlockHeader, Body, ButtonWrapper, CountsContainer, CuttingLine, DeleteFileButton, FileItem, FilesBody, FilesContent, InfoBody, ItemsContainer, NoFileHint } from '../../../pathwayTemplate/components/sessionDetail/SessionDetail';\nimport { BadgeWrapper, Buttons, IconStyle, Info, InfoHeader, Item, ItemContent, ItemTitle, Name, NameWrapper, ToggleWrapper } from '../../../pathwayTemplate/components/templateDetail/TemplateDetail';\nimport { recordToSessionFields } from '../../commonJs';\nimport DeleteSession from '../DeleteSession';\nimport EditSession from '../pathwayDetail/CreateOrEditSession';\nimport ConnectPop from './ConnectPop';\nimport CourseList from './CourseList';\n\nvar SessionDetail =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(SessionDetail, _React$Component);\n\n  function SessionDetail(props) {\n    var _this;\n\n    _classCallCheck(this, SessionDetail);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SessionDetail).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"goBack\", function () {\n      var id = _this.props.session.pathway.id;\n      Router.push(\"/pathway-detail/\".concat(id));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"changeStatus\", function (status) {\n      _this.setState({\n        status: status\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"saveInfo\", function (fields) {\n      var session = _this.state.session;\n\n      _Object$assign(session, _objectSpread({}, fields, {\n        remarks: fields.remarks\n      }));\n\n      _this.setState({\n        session: session\n      }, _this.changeStatus.bind(_assertThisInitialized(_this), 0));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"toggleInfo\", function () {\n      var infoCollapse = _this.state.infoCollapse;\n\n      _this.setState({\n        infoCollapse: !infoCollapse\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"showAlert\", function () {\n      _this.setState({\n        alertVisible: true\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"hideAlert\", function () {\n      _this.setState({\n        alertVisible: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onRefFilePicker\", function (ref) {\n      _this.filePicker = ref;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickAddFile\", function () {\n      _this.filePicker.showPop();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getSelectFiles\",\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(fileLinks) {\n        var session, files;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                session = _this.state.session;\n                files = session.files;\n                session.files = uniqBy(files.concat(fileLinks), 'id');\n\n                _this.setState({\n                  session: session\n                });\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"deleteSelected\",\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(id) {\n        var session, files;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                session = _this.state.session;\n                files = session.files;\n                session.files = files.filter(function (v) {\n                  return v.id !== id;\n                });\n\n                _this.setState({\n                  session: session\n                });\n\n              case 4:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"onRefConnectPop\", function (ref) {\n      _this.connectPop = ref;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickConnect\", function (type) {\n      if (!type) {\n        return;\n      }\n\n      _this.setState({\n        connectType: type,\n        popMode: 'connect'\n      }, _this.connectPop.showPop);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickDisconnect\", function (id) {\n      _Modal.confirm({\n        title: '确认取消',\n        okText: '确认取消关联',\n        okType: 'danger',\n        cancelText: '关闭',\n        centered: true,\n        icon: React.createElement(_Icon, {\n          type: \"delete\",\n          style: {\n            color: 'red'\n          }\n        }),\n        onOk: function onOk() {\n          // 如果不是暂时添加的, 保存到取消关联数组\n          if (id.length !== 8) {\n            var disconnectedCourses = _this.state.disconnectedCourses;\n            disconnectedCourses.push({\n              sessionItemId: id\n            });\n\n            _this.setState({\n              disconnectedCourses: disconnectedCourses\n            });\n          }\n\n          var session = _this.state.session;\n          session.sessionItems = session.sessionItems.filter(function (sessionItem) {\n            return sessionItem.id !== id;\n          });\n\n          _this.setState({\n            session: session\n          });\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickModify\", function (id, type) {\n      if (!id || !type) {\n        return;\n      }\n\n      _this.setState({\n        connectType: type,\n        popMode: 'modify',\n        modifyId: id\n      }, _this.connectPop.showPop);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"clearModifyId\", function () {\n      _this.setState({\n        modifyId: ''\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onConfirmConnect\", function (category, course) {\n      var _this$state = _this.state,\n          session = _this$state.session,\n          popMode = _this$state.popMode;\n      var key = category.type.key; // const { bestStartAt, bestEndAt, tutorType } = fieldsValue;\n\n      var suggestionCourse;\n\n      if (key !== 'SUBSCRIPTION_COURSE') {\n        suggestionCourse = course && course.name;\n      } // 临时添加到列表的数据\n\n\n      var sessionItem = {\n        id: Math.random().toString(36).slice(-8),\n        // 生成 8 位随机字符串, 以用于区分临时添加的课程和已经关联的课程\n        type: category.type,\n        title: category.type.name,\n        courseCategory: category,\n        privateCourse: key === 'PRIVATE_COURSE' ? course : null,\n        groupCourse: key === 'GROUP_COURSE' ? course : null,\n        subscriptionCourse: key === 'SUBSCRIPTION_COURSE' ? course : null,\n        suggestionCourse: suggestionCourse,\n        tutorType: _this.defaultTutorType // bestStartAt: bestStartAt.toISOString(),\n        // bestEndAt: bestEndAt.toISOString(),\n\n      };\n\n      if (popMode === 'connect') {\n        session.sessionItems.push(sessionItem);\n      }\n\n      if (popMode === 'modify') {\n        var modifyId = _this.state.modifyId;\n        var position; // 元素位置\n\n        session.sessionItems.forEach(function (value, index) {\n          if (value.id === modifyId) {\n            position = index;\n          }\n        });\n\n        if (typeof position === 'number') {\n          session.sessionItems.splice(position, 1, sessionItem);\n        }\n      }\n\n      _this.setState({\n        session: session\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setCourseBestTime\", function (id, fieldsValue) {\n      var session = _this.state.session;\n      var bestStartAt = fieldsValue.bestStartAt,\n          bestEndAt = fieldsValue.bestEndAt,\n          tutorType = fieldsValue.tutorType;\n      session.sessionItems.forEach(function (v) {\n        if (v.id === id) {\n          v.bestStartAt = bestStartAt.toISOString();\n          v.bestEndAt = bestEndAt.toISOString();\n          v.tutorType = tutorType && JSON.parse(tutorType);\n        }\n      });\n\n      _this.setState({\n        session: session\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setCourseProperty\", function (id, type, fieldsValue) {\n      var session = _this.state.session;\n      var bestStartAt = fieldsValue.bestStartAt,\n          bestEndAt = fieldsValue.bestEndAt,\n          tutorType = fieldsValue.tutorType;\n      session.sessionItems.forEach(function (v) {\n        if (v.id === id) {\n          if (type === 'setTime') {\n            v.bestStartAt = bestStartAt && bestStartAt.toISOString();\n            v.bestEndAt = bestEndAt && bestEndAt.toISOString();\n            return;\n          }\n\n          v.tutorType = tutorType && JSON.parse(tutorType);\n        }\n      });\n\n      _this.setState({\n        session: session\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onRefSorter\", function (ref) {\n      _this.sorter = ref;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickSortBtn\", function () {\n      _this.sorter.showPop();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getListItemsHelper\", function () {\n      var sessionItems = _this.state.session.sessionItems.map(function (sessionItem) {\n        var key = sessionItem.type.key;\n        return _objectSpread({}, sessionItem, {\n          name: key === 'SUBSCRIPTION_COURSE' ? sessionItem.subscriptionCourse.name : sessionItem.courseCategory.name\n        });\n      });\n\n      return _Promise.resolve(sessionItems);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setListItemsHelper\", function (sortItems) {\n      var session = _this.state.session;\n      var sessionItems = session.sessionItems;\n      session.sessionItems = sortItems.map(function (sortItem) {\n        var id = sortItem.id;\n        return sessionItems.filter(function (v) {\n          return v.id === id;\n        }).pop();\n      });\n\n      _this.setState({\n        session: session,\n        alertVisible: true\n      });\n\n      return _Promise.resolve(true);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"showSetTimeAlert\", function () {\n      _Modal.warning({\n        icon: React.createElement(_Icon, {\n          type: \"exclamation-circle\",\n          theme: \"filled\"\n        }),\n        title: '无法完成阶段更新',\n        content: React.createElement(\"p\", null, \"\\u8BF7\\u4E3A\\u6240\\u6709\\u8BFE\\u7A0B\\u914D\\u7F6E\\u6700\\u4F73\\u5B66\\u4E60\\u65F6\\u95F4\\u3002\"),\n        okText: '我知道了',\n        autoFocusButton: null\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickSave\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee3() {\n      var session, id, purpose, remarks, introduction, files, sessionItems, startAt, endAt, allCourseSetTime, variables, courses;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              session = _this.state.session;\n              id = session.id, purpose = session.purpose, remarks = session.remarks, introduction = session.introduction, files = session.files, sessionItems = session.sessionItems, startAt = session.startAt, endAt = session.endAt; // 检查是不是所有课程都设置了最佳时间\n\n              allCourseSetTime = true;\n              sessionItems.forEach(function (v) {\n                if (!v.bestStartAt || !v.bestEndAt) {\n                  allCourseSetTime = false;\n                }\n              });\n\n              if (allCourseSetTime) {\n                _context3.next = 7;\n                break;\n              }\n\n              _this.showSetTimeAlert();\n\n              return _context3.abrupt(\"return\");\n\n            case 7:\n              // 基本信息和文件链接\n              variables = {\n                id: id,\n                purpose: purpose,\n                remarks: remarks,\n                introduction: introduction,\n                fileLinkIds: files.map(function (fileLink) {\n                  return fileLink.id;\n                }),\n                startAt: startAt,\n                endAt: endAt\n              }; // 关联授课\n\n              courses = [];\n              sessionItems.forEach(function (v, i) {\n                var sessionItemId = v.id,\n                    key = v.type.key,\n                    courseCategory = v.courseCategory,\n                    suggestionCourse = v.suggestionCourse,\n                    subscriptionCourse = v.subscriptionCourse,\n                    bestStartAt = v.bestStartAt,\n                    bestEndAt = v.bestEndAt,\n                    tutorType = v.tutorType;\n                var type;\n\n                if (key === 'GROUP_COURSE') {\n                  type = 'GroupCourse';\n                }\n\n                if (key === 'PRIVATE_COURSE') {\n                  type = 'PrivateCourse';\n                }\n\n                if (key === 'SUBSCRIPTION_COURSE') {\n                  type = 'SubscriptionCourse';\n                }\n\n                courses.push({\n                  sessionItemId: sessionItemId.length === 8 ? undefined : sessionItemId,\n                  type: type,\n                  categoryId: courseCategory && courseCategory.id,\n                  suggestionCourse: suggestionCourse,\n                  subscriptionCourseId: subscriptionCourse && subscriptionCourse.id,\n                  bestStartAt: bestStartAt,\n                  bestEndAt: bestEndAt,\n                  tutorTypeKey: tutorType && tutorType.key,\n                  position: i\n                });\n              });\n\n              _Object$assign(variables, {\n                courses: courses\n              });\n\n              _this.setState({\n                saveLoading: true\n              });\n\n              _context3.next = 14;\n              return _this.props.updateSession(variables).then(function (_result) {\n                _message.success('已成功保存此阶段');\n\n                _this.props.refetch();\n              }).catch(function (error) {\n                if (parseErrorCode(error) === 'sessionsStartAtEndAtInvalid') {\n                  _this.showTimeConflictAlert();\n\n                  return;\n                }\n\n                if (handleConfirmOtherError(error)) {\n                  _message.error('操作失败');\n                }\n              });\n\n            case 14:\n              _this.setState({\n                saveLoading: false\n              });\n\n            case 15:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    })));\n\n    _defineProperty(_assertThisInitialized(_this), \"showTimeConflictAlert\", function () {\n      _Modal.warning({\n        icon: React.createElement(_Icon, {\n          type: \"exclamation-circle\"\n        }),\n        title: '设置失败',\n        content: '该时间段和其他阶段的时间重叠，请调整时间段。',\n        okText: '我知道了'\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"controlNonEditAlert\", function (visible) {\n      _this.setState({\n        nonEditVisible: visible\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"showNonEditAlert\", function () {\n      _this.controlNonEditAlert(true);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"withdrawSession\", function () {\n      _this.setState({\n        withdrawLoading: true\n      });\n\n      _this.props.changeSessionWithdrawStatus(true).then(function (_result) {\n        _message.success('撤回成功');\n\n        _this.setState({\n          withdrawLoading: false\n        });\n\n        _this.showAlert();\n\n        _this.props.refetch();\n      }).catch(function (error) {\n        errMessage(error);\n      });\n    });\n\n    _this.state = {\n      status: 0,\n      infoCollapse: true,\n      connectType: '',\n      popMode: 'connect',\n      modifyId: '',\n      session: null,\n      originalFileList: [],\n      alertVisible: false,\n      saveLoading: false,\n      disconnectedCourses: [],\n      withdrawLoading: false,\n      nonEditVisible: false\n    }; // 获取默认导师类型\n\n    var levelEnums = JSON.parse(localStorage.getItem('zhiwen_all_enum')).listZhiwenLevelEnum;\n    _this.defaultTutorType = levelEnums && levelEnums.filter(function (v) {\n      return v.key === 'NA';\n    })[0];\n    return _this;\n  }\n\n  _createClass(SessionDetail, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var session = this.props.session; // 如果是未发布状态, 显示提示\n\n      if (session.isWithdrew) {\n        this.showAlert();\n      } // 保存 session 信息\n\n\n      this.setState({\n        session: session,\n        originalFileList: session.files\n      });\n    } // 回到列表页\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var type = this.props.type;\n      var readOnly = type === 'read-only';\n      var _this$state2 = this.state,\n          infoCollapse = _this$state2.infoCollapse,\n          status = _this$state2.status,\n          session = _this$state2.session,\n          alertVisible = _this$state2.alertVisible,\n          connectType = _this$state2.connectType,\n          saveLoading = _this$state2.saveLoading,\n          popMode = _this$state2.popMode;\n\n      if (!session) {\n        return null;\n      }\n\n      var id = session.id,\n          introduction = session.introduction,\n          purpose = session.purpose,\n          remarks = session.remarks,\n          files = session.files,\n          sessionItems = session.sessionItems,\n          isWithdrew = session.isWithdrew,\n          startAt = session.startAt,\n          endAt = session.endAt;\n      var sessionItemNumber = sessionItems.length; // 没有指定导师类型的授课, 默认导师类型为 [未指定]\n\n      sessionItems.forEach(function (v) {\n        if (!v.tutorType) {\n          v.tutorType = _this2.defaultTutorType;\n        }\n      }); // 判断是否为可以编辑的状态\n\n      var canEdit = true;\n\n      if (session.pathway.status.key === 'COMPLETE' || !session.isWithdrew) {\n        canEdit = false;\n      } // 编辑阶段\n\n\n      if (status === 1) {\n        var fields = recordToSessionFields(session);\n        return React.createElement(React.Fragment, null, React.createElement(PageHeader, {\n          titleText: \"\\u7F16\\u8F91\\u5B66\\u4E60\\u8BA1\\u5212\\u9636\\u6BB5\"\n        }), React.createElement(Body, null, React.createElement(EditSession, {\n          fields: fields,\n          type: \"edit\",\n          onCancel: this.changeStatus.bind(this, 0),\n          saveInfo: this.saveInfo,\n          sessions: session.pathway.sessions\n        })));\n      }\n\n      if (!status) {\n        // 时间段\n        var durationText = '--';\n\n        if (startAt && endAt) {\n          var timeFormat = 'YYYY/MM/DD';\n          durationText = \"\".concat(format(startAt, timeFormat), \" ~ \").concat(format(endAt, timeFormat));\n        } // 撤回 modal title\n\n\n        var title = React.createElement(ModalTitle, {\n          iconColor: \"orange\",\n          iconType: \"exclamation-circle\",\n          txt: \"\\u8BE5\\u9636\\u6BB5\\u9700\\u8981\\u5148\\u64A4\\u56DE\\u540E\\u624D\\u80FD\\u7F16\\u8F91\"\n        }); // 关联课程按钮\n\n        var linkButton = function linkButton(key, txt) {\n          return React.createElement(ButtonWrapper, null, React.createElement(_Button, {\n            onClick: canEdit ? _this2.onClickConnect.bind(_this2, key) : _this2.showNonEditAlert\n          }, txt));\n        };\n\n        return React.createElement(React.Fragment, null, React.createElement(_Modal, {\n          title: title,\n          visible: this.state.nonEditVisible,\n          onOk: this.withdrawSession,\n          onCancel: this.controlNonEditAlert.bind(this, false),\n          okButtonProps: {\n            loading: this.state.withdrawLoading\n          },\n          maskClosable: false,\n          closable: false,\n          okText: \"\\u64A4\\u56DE\",\n          cancelText: \"\\u53D6\\u6D88\"\n        }, \"\\u64A4\\u56DE\\u540E\\u5B66\\u5458\\u5C06\\u65E0\\u6CD5\\u7EE7\\u7EED\\u5728 app \\u7AEF\\u67E5\\u770B\\u5230\\u8BE5\\u9636\\u6BB5\\uFF0C\\u5728\\u5B8C\\u6210\\u7F16\\u8F91\\u540E\\u4F60\\u9700\\u8981\\u91CD\\u65B0\\u53D1\\u5E03\\u5B66\\u4E60\\u8BA1\\u5212\\u3002\"), alertVisible && !readOnly && React.createElement(AlertWrapper, null, React.createElement(_Affix, {\n          offsetTop: 74\n        }, React.createElement(_Alert, {\n          message: \"App \\u7AEF\\u65E0\\u6CD5\\u67E5\\u770B\\u672A\\u53D1\\u5E03\\u7684\\u5B66\\u4E60\\u9636\\u6BB5\\u3002\\u5982\\u9700\\u5728 app \\u7AEF\\u5C55\\u793A\\u8BF7\\u5728\\u4FDD\\u5B58\\u540E\\u53D1\\u5E03\\u5B66\\u4E60\\u8BA1\\u5212\\u3002\",\n          type: \"info\",\n          showIcon: true,\n          closable: true,\n          afterClose: this.hideAlert\n        }))), React.createElement(Info, null, React.createElement(_Breadcrumb, null, !readOnly && React.createElement(_Breadcrumb.Item, null, React.createElement(Link, {\n          href: \"/pathway\"\n        }, React.createElement(\"a\", null, \"\\u5B66\\u4E60\\u8BA1\\u5212\\u7BA1\\u7406\"))), React.createElement(_Breadcrumb.Item, null, React.createElement(\"a\", {\n          onClick: readOnly ? this.props.toPathwayDetail : this.goBack\n        }, \"\\u5B66\\u4E60\\u8BA1\\u5212\\u8BE6\\u60C5\")), React.createElement(_Breadcrumb.Item, null, \"\\u9636\\u6BB5\\u8BE6\\u60C5\")), React.createElement(InfoHeader, null, React.createElement(NameWrapper, null, React.createElement(Name, null, purpose), !readOnly && React.createElement(BadgeWrapper, null, isWithdrew ? React.createElement(_Badge, {\n          color: \"yellow\",\n          text: \"\\u672A\\u53D1\\u5E03\"\n        }) : React.createElement(_Badge, {\n          color: \"green\",\n          text: \"\\u5DF2\\u53D1\\u5E03\"\n        }))), !readOnly && React.createElement(Buttons, null, React.createElement(DeleteSession, {\n          count: sessionItemNumber,\n          deleteSuccess: this.goBack,\n          id: id,\n          isButton: true,\n          disabled: sessionItemNumber > 0\n        }), React.createElement(_Button, {\n          onClick: canEdit ? this.changeStatus.bind(this, 1) : this.showNonEditAlert,\n          style: {\n            margin: '0 12px'\n          }\n        }, \"\\u7F16\\u8F91\"), session.isWithdrew && React.createElement(_Button, {\n          type: \"primary\",\n          onClick: this.onClickSave,\n          loading: saveLoading\n        }, \"\\u4FDD\\u5B58\"))), React.createElement(InfoBody, null, React.createElement(ItemsContainer, null, React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u65F6\\u95F4\\u6BB5\\uFF1A\"), React.createElement(ItemContent, null, durationText)), React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u76EE\\u6807\\u7B80\\u4ECB\\uFF1A\"), React.createElement(ItemContent, null, breakLine(introduction))), !infoCollapse && React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u5BF9\\u5185\\u5907\\u6CE8\\uFF1A\"), React.createElement(ItemContent, null, breakLine(remarks)))), React.createElement(CountsContainer, null, React.createElement(CourseCountIndicator, {\n          counts: countCourse(sessionItems)\n        }))), React.createElement(ToggleWrapper, null, React.createElement(\"a\", {\n          onClick: this.toggleInfo\n        }, infoCollapse ? '展开' : '收起', \"\\u66F4\\u591A\\u4FE1\\u606F\", React.createElement(_Icon, {\n          type: infoCollapse ? 'down' : 'up',\n          style: IconStyle\n        })))), React.createElement(FilesBody, {\n          style: {\n            margin: readOnly ? '24px 0 0 0' : '24px'\n          }\n        }, React.createElement(FilePicker, {\n          onRef: this.onRefFilePicker,\n          fileType: \"all\",\n          getSelected: this.getSelectFiles,\n          selectType: \"multiple\"\n        }), React.createElement(BlockHeader, null, React.createElement(Name, null, \"\\u9636\\u6BB5\\u9644\\u4EF6\\uFF08\".concat(files.length, \"\\uFF09\")), !readOnly && React.createElement(Buttons, null, React.createElement(_Button, {\n          onClick: canEdit ? this.onClickAddFile : this.showNonEditAlert\n        }, \"\\u6DFB\\u52A0\\u9644\\u4EF6\"))), React.createElement(FilesContent, null, files.map(function (fileLink) {\n          return React.createElement(FileItem, {\n            key: fileLink.id\n          }, React.createElement(\"span\", {\n            style: {\n              whiteSpace: 'normal'\n            }\n          }, fileLink.file.filename), !readOnly && React.createElement(DeleteFileButton, {\n            onClick: canEdit ? _this2.deleteSelected.bind(_this2, fileLink.id) : _this2.showNonEditAlert\n          }, \"\\u5220\\u9664\"));\n        }), !files.length && React.createElement(NoFileHint, null, \"\\u6682\\u65E0\\u9644\\u4EF6\\uFF0C\\u70B9\\u51FB\\u53F3\\u4E0A\\u89D2\\u6309\\u94AE\\u6DFB\\u52A0\\u9644\\u4EF6\"))), React.createElement(Body, {\n          style: {\n            margin: readOnly ? '24px 0 0 0' : '24px'\n          }\n        }, React.createElement(BlockHeader, null, React.createElement(Name, null, \"\\u6B64\\u9636\\u6BB5\\u5185\\u5173\\u8054\\u7684\\u6388\\u8BFE\\uFF08\".concat(sessionItemNumber, \"\\uFF09\")), !readOnly && React.createElement(Buttons, null, sessionItemNumber >= 2 && React.createElement(_Button, {\n          onClick: this.onClickSortBtn\n        }, \"\\u6392\\u5E8F\"), sessionItemNumber < 2 && React.createElement(_Popover, {\n          placement: \"bottom\",\n          content: React.createElement(React.Fragment, null, React.createElement(\"div\", null, \"\\u4F7F\\u7528\\u6392\\u5E8F\\u529F\\u80FD\\u9700\\u6EE1\\u8DB3\\u5982\\u4E0B\\u6761\\u4EF6\\uFF1A\"), React.createElement(\"div\", null, \"\\u6B64\\u9636\\u6BB5\\u81F3\\u5C11\\u9700\\u89812\\u95E8\\u6388\\u8BFE\\u3002\"))\n        }, React.createElement(_Button, {\n          disabled: true\n        }, \"\\u6392\\u5E8F\")), React.createElement(CuttingLine, null), linkButton('PRIVATE_COURSE', '新增1对1辅导'), linkButton('GROUP_COURSE', '新增小班课'), linkButton('SUBSCRIPTION_COURSE', '新增订阅课程'))), React.createElement(SortableModal, {\n          onRef: this.onRefSorter,\n          title: \"\\u6B64\\u9636\\u6BB5\\u5185\\u6388\\u8BFE\",\n          mode: \"drag-and-drop-and-dateSort\",\n          getListItemsHelper: this.getListItemsHelper,\n          setListItemsHelper: this.setListItemsHelper\n        }), React.createElement(ConnectPop, {\n          onRef: this.onRefConnectPop,\n          type: connectType,\n          mode: popMode,\n          onConfirm: this.onConfirmConnect,\n          courses: sessionItems,\n          clearModifyId: this.clearModifyId\n        }), React.createElement(CourseList, {\n          courses: sessionItems,\n          onClickDisconnect: this.onClickDisconnect,\n          onClickModify: this.onClickModify,\n          canEdit: canEdit,\n          showNonEditAlert: this.showNonEditAlert,\n          setCourseBestTime: this.setCourseBestTime,\n          setCourseProperty: this.setCourseProperty,\n          readOnly: readOnly\n        })));\n      }\n\n      return null;\n    }\n  }]);\n\n  return SessionDetail;\n}(React.Component);\n\n_defineProperty(SessionDetail, \"defaultProps\", {\n  type: 'normal'\n});\n\nexport default SessionDetail;","map":null,"metadata":{},"sourceType":"module"}
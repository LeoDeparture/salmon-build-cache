{"ast":null,"code":"import \"antd/lib/icon/style\";\nimport _Icon from \"antd/lib/icon\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport React from 'react';\nimport styled from 'styled-components'; // 导入各模块的展示与编辑组件\n\nimport EditBasicInfo from './BasicInfo/EditBasicInfo';\nimport ShowBasicInfo from './BasicInfo/ShowBasicInfo';\nimport EditJobIntention from './JobIntention/EditJobIntention';\nimport ShowJobIntention from './JobIntention/ShowJobIntention';\nimport EditEducationExperience from './EducationExperience/EditEducationExperience';\nimport ShowEducationExperience from './EducationExperience/ShowEducationExperience';\nimport EditWorkExperience from './WorkExperience/EditWorkExperience';\nimport ShowWorkExperience from './WorkExperience/ShowWorkExperience';\nimport EditProjectExperience from './ProjectExperience/EditProjectExperience';\nimport ShowProjectExperience from './ProjectExperience/ShowProjectExperience';\nimport EditSchoolExperience from './SchoolExperience/EditSchoolExperience';\nimport ShowSchoolExperience from './SchoolExperience/ShowSchoolExperience';\nimport EditLanguageSkill from './LanguageSkill/EditLanguageSkill';\nimport ShowLanguageSkill from './LanguageSkill/ShowLanguageSkill';\nimport EditJobSkill from './JobSkill/EditJobSkill';\nimport ShowJobSkill from './JobSkill/ShowJobSkill';\nimport EditCertificate from './Certificate/EditCertificate';\nimport ShowCertificate from './Certificate/ShowCertificate';\nimport EditAward from './Award/EditAward';\nimport ShowAward from './Award/ShowAward';\nimport EditSocialHomepage from './SocialHomepage/EditSocialHomepage';\nimport ShowSocialHomepage from './SocialHomepage/ShowSocialHomepage';\nimport EditHobby from './Hobby/EditHobby';\nimport ShowHobby from './Hobby/ShowHobby';\nimport EditAdvantage from './Advantage/EditAdvantage';\nimport ShowAdvantage from './Advantage/ShowAdvantage';\nimport Header from './../../userDetails/components/Header';\nimport UpdateMutations from '../containers/Mutations';\nimport DeleteButton from './DeleteButton'; // 主体 container\n\nvar Container = styled.div.withConfig({\n  displayName: \"UserResumeComponent__Container\",\n  componentId: \"sc-8dc9uh-0\"\n})([\"& .ant-card-body{padding:24px;background-color:#f0f2f5;}\"]);\nexport var MainContent = styled.div.withConfig({\n  displayName: \"UserResumeComponent__MainContent\",\n  componentId: \"sc-8dc9uh-1\"\n})([\"display:flex;flex:1;flex-direction:column;min-width:1136px;padding:24px;\"]); // 模块 container\n\nvar ModuleContainer = styled.div.withConfig({\n  displayName: \"UserResumeComponent__ModuleContainer\",\n  componentId: \"sc-8dc9uh-2\"\n})([\"padding:24px 32px 8px 32px;margin-bottom:24px;overflow:hidden;background-color:#fff;\"]); // 模块标题\n\nvar ModuleTitle = styled.div.withConfig({\n  displayName: \"UserResumeComponent__ModuleTitle\",\n  componentId: \"sc-8dc9uh-3\"\n})([\"display:flex;justify-content:space-between;color:#000;h4{margin-bottom:0;}a{font-size:16px;line-height:16px;}\"]); // 模块内容 container\n\nvar ModuleContentContainer = styled.div.withConfig({\n  displayName: \"UserResumeComponent__ModuleContentContainer\",\n  componentId: \"sc-8dc9uh-4\"\n})([\"margin-top:20px;background-color:#fff;\"]); // 添加子模块按钮\n\nvar AddMore = styled.div.withConfig({\n  displayName: \"UserResumeComponent__AddMore\",\n  componentId: \"sc-8dc9uh-5\"\n})([\"display:flex;align-items:center;flex:1;justify-content:center;height:60px;margin:16px 0;color:#6285ff;cursor:pointer;border:1px dashed #d9d9d9;span{margin-left:4px;}\"]); // public\n// textarea container 用于多行文本\n\nexport var LineBreakContainer = styled.div.withConfig({\n  displayName: \"UserResumeComponent__LineBreakContainer\",\n  componentId: \"sc-8dc9uh-6\"\n})([\"p{position:relative;top:-21px;left:44px;display:block;padding-right:44px;margin:0 !important;color:#505050;}\"]); // 子模块标题\n\nexport var BlockTitle = styled.div.withConfig({\n  displayName: \"UserResumeComponent__BlockTitle\",\n  componentId: \"sc-8dc9uh-7\"\n})([\"display:flex;justify-content:space-between;margin-bottom:10px;h4{color:#c3c3c3;}a{font-size:16px;line-height:16px;}\"]); // 子模块内容\n\nexport var BlockContent = styled.div.withConfig({\n  displayName: \"UserResumeComponent__BlockContent\",\n  componentId: \"sc-8dc9uh-8\"\n})([\"font-size:14px;color:#c3c3c3;p{margin-bottom:16px;word-break:break-all;}span{margin-left:5px;color:#505050;}\"]); // 输入上限规则\n\nexport var lengthLimit = {\n  max: 500,\n  message: '超过输入长度上限'\n}; // 输入框规则 + 输入上限\n\nexport var requireRule = [{\n  message: '此字段无法为空',\n  required: true,\n  whitespace: true\n}, lengthLimit]; // 文本域输入上限增加\n\nexport var textAreaRule = [{\n  max: 2000,\n  message: '超过输入长度上限'\n}]; // 非文字输入框规则, 如日期, 选择框\n\nexport var noTxtRequireRule = [{\n  message: '此字段无法为空',\n  required: true\n}]; // 文本域样式规则\n\nexport var textAreaAutoSize = {\n  minRows: 3,\n  maxRows: 10\n}; // placeholder\n\nexport var InputPlaceHolder = '请输入';\nexport var SelectPlaceHolder = '请选择';\nexport var DatePlaceHolder = '请选择日期'; // 表单样式\n\nexport var FormStyle = {\n  width: '100%',\n  backgroundColor: '#fff'\n};\n\nvar UserResumeComponent =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(UserResumeComponent, _React$Component);\n\n  function UserResumeComponent(_props) {\n    var _this;\n\n    _classCallCheck(this, UserResumeComponent);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(UserResumeComponent).call(this, _props));\n\n    _defineProperty(_assertThisInitialized(_this), \"componentDidUpdate\", function (prevProps) {\n      if (_this.props.cvData.getFirstCVByStudentAccountId !== prevProps.cvData.getFirstCVByStudentAccountId) {\n        _this.handleCVData();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"componentDidMount\", function () {\n      _this.handleCVData();\n\n      _this.props.onRef(_assertThisInitialized(_this));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCVData\", function () {\n      var cvData = _this.props.cvData.getFirstCVByStudentAccountId; // 处理基本信息\n\n      var birthday = cvData.birthday,\n          email = cvData.email,\n          name = cvData.name,\n          phoneNumber = cvData.phoneNumber,\n          phoneNumberCountry = cvData.phoneNumberCountry,\n          wechat = cvData.wechat,\n          country = cvData.country,\n          city = cvData.city,\n          province = cvData.province,\n          gender = cvData.gender;\n      var basicInfoData = [{\n        data: {\n          birthday: birthday,\n          city: city,\n          country: country,\n          email: email,\n          gender: gender,\n          name: name,\n          phoneNumber: phoneNumber,\n          phoneNumberCountry: phoneNumberCountry,\n          province: province,\n          wechat: wechat\n        },\n        editing: false\n      }]; // 处理兴趣爱好\n\n      var hobbyData = [{\n        data: cvData.hobbies,\n        editing: false\n      }]; // 处理我的优势\n\n      var advantageData = [{\n        data: cvData.advantages,\n        editing: false\n      }];\n\n      _this.setState({\n        advantageData: advantageData,\n        basicInfoData: basicInfoData,\n        hobbyData: hobbyData\n      }); // 处理求职意向\n\n\n      var jobIntentionData = [];\n      cvData.jobIntentions.forEach(function (v) {\n        var tempObj = {\n          data: v,\n          editing: false\n        };\n        jobIntentionData.push(tempObj);\n      });\n\n      _this.setState({\n        jobIntentionData: jobIntentionData\n      }); // 处理教育经历\n\n\n      var educationExperienceData = [];\n      cvData.educationExperiences.forEach(function (v) {\n        var tempObj = {\n          data: v,\n          editing: false\n        };\n        educationExperienceData.push(tempObj);\n      });\n\n      _this.setState({\n        educationExperienceData: educationExperienceData\n      }); // 处理工作经历\n\n\n      var workExperienceData = [];\n      cvData.workExperiences.forEach(function (v) {\n        var tempObj = {\n          data: v,\n          editing: false\n        };\n        workExperienceData.push(tempObj);\n      });\n\n      _this.setState({\n        workExperienceData: workExperienceData\n      }); // 处理项目经历数据\n\n\n      var projectExperienceData = [];\n      cvData.projectExperiences.forEach(function (v) {\n        var tempObj = {\n          data: v,\n          editing: false\n        };\n        projectExperienceData.push(tempObj);\n      });\n\n      _this.setState({\n        projectExperienceData: projectExperienceData\n      }); // 处理校园经历数据\n\n\n      var schoolExperienceData = [];\n      cvData.schoolExperiences.forEach(function (v) {\n        var tempObj = {\n          data: v,\n          editing: false\n        };\n        schoolExperienceData.push(tempObj);\n      });\n\n      _this.setState({\n        schoolExperienceData: schoolExperienceData\n      }); // 处理语言技能证数据\n\n\n      var languageSkillData = [];\n      cvData.languageSkills.forEach(function (v) {\n        var tempObj = {\n          data: v,\n          editing: false\n        };\n        languageSkillData.push(tempObj);\n      });\n\n      _this.setState({\n        languageSkillData: languageSkillData\n      }); // 处理工作技能证数据\n\n\n      var jobSkillData = [];\n      cvData.jobSkills.forEach(function (v) {\n        var tempObj = {\n          data: v,\n          editing: false\n        };\n        jobSkillData.push(tempObj);\n      });\n\n      _this.setState({\n        jobSkillData: jobSkillData\n      }); // 处理从业资格证数据\n\n\n      var certificateData = [];\n      cvData.certificates.forEach(function (v) {\n        var tempObj = {\n          data: v,\n          editing: false\n        };\n        certificateData.push(tempObj);\n      });\n\n      _this.setState({\n        certificateData: certificateData\n      }); // 处理荣誉奖励数据\n\n\n      var awardData = [];\n      cvData.awards.forEach(function (v) {\n        var tempObj = {\n          data: v,\n          editing: false\n        };\n        awardData.push(tempObj);\n      });\n\n      _this.setState({\n        awardData: awardData\n      }); // 处理社交主页数据\n\n\n      var socialHomepageData = [];\n      cvData.socialHomepages.forEach(function (v) {\n        var tempObj = {\n          data: v,\n          editing: false\n        };\n        socialHomepageData.push(tempObj);\n      });\n\n      _this.setState({\n        socialHomepageData: socialHomepageData\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"changeState\", function (moduleName, index, editing, isSave) {\n      var stateKey = moduleName + 'Data';\n\n      var tempState = _objectSpread({}, _this.state);\n\n      if (editing !== undefined && tempState[stateKey].length) {\n        tempState[stateKey][index].editing = editing;\n      } // 如果是保存成功后的操作, 显示添加按钮\n\n\n      if (isSave) {\n        // tempState.addingNew[moduleName] = false;\n        // \"Temperately Hack\"\n        tempState.addingNew = {\n          award: false,\n          certificate: false,\n          educationExperience: false,\n          jobIntention: false,\n          jobSkill: false,\n          languageSkill: false,\n          projectExperience: false,\n          schoolExperience: false,\n          socialHomepage: false,\n          workExperience: false\n        };\n      }\n\n      _this.setState(_objectSpread({}, tempState));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"Module\", function (props) {\n      var moduleTitle = props.moduleTitle,\n          moduleName = props.moduleName,\n          data = props.data,\n          EditModule = props.EditModule,\n          ShowModule = props.ShowModule; // 获取cvId\n\n      var cvId = _this.props.cvData.getFirstCVByStudentAccountId.id; // 是否是多条信息的模块\n\n      var isMultipleModule = Boolean(moduleName !== 'basicInfo' && moduleName !== 'hobby' && moduleName !== 'advantage'); // 首字母大写模块名\n\n      var CapModuleName = moduleName.charAt(0).toUpperCase() + moduleName.slice(1); // 遍历渲染 data 中的每一个元素\n\n      var ModuleContent = data.map(function (blockData, i) {\n        var noData = false;\n\n        if (blockData.length > 0 && blockData[i].data.length > 0) {\n          noData = true;\n        } // 是否是新建编辑模块\n\n\n        var isNewEdit = Boolean(_JSON$stringify(blockData.data) === '{}'); // 传给编辑模块的 mutation 语句\n\n        var mutation = isNewEdit ? UpdateMutations['MutationCreate' + CapModuleName] : UpdateMutations['MutationUpdate' + CapModuleName];\n        return React.createElement(ModuleContentContainer, {\n          key: 'moduleContent:' + moduleName + i\n        }, React.createElement(BlockTitle, {\n          hidden: !isMultipleModule\n        }, React.createElement(\"h4\", null, moduleTitle + (i + 1)), React.createElement(\"div\", {\n          hidden: blockData.editing\n        }, React.createElement(\"a\", {\n          onClick: _this.changeState.bind(_assertThisInitialized(_this), moduleName, i, true)\n        }, \"\\u7F16\\u8F91\"), React.createElement(DeleteButton, {\n          id: blockData.data.id,\n          moduleName: moduleName,\n          handleState: _this.changeState\n        }))), blockData.editing ? React.createElement(EditModule, {\n          key: 'editmodule:' + moduleName + i,\n          data: blockData.data,\n          blockIndex: i,\n          cvId: cvId,\n          updateData: _this.props.updateData.bind(_assertThisInitialized(_this), moduleName, blockData.addNew),\n          removeInfoBlock: _this.removeInfoBlock.bind(_assertThisInitialized(_this), i, moduleName),\n          closeEdit: _this.changeState.bind(_assertThisInitialized(_this), moduleName, i, false, true),\n          mutation: mutation,\n          updateMutation: UpdateMutations['MutationUpdate' + CapModuleName] // 根据是否是新建编辑模块, 决定点击取消按钮执行的动作\n          ,\n          cancel: isNewEdit ? _this.removeInfoBlock.bind(_assertThisInitialized(_this), i, moduleName) : _this.changeState.bind(_assertThisInitialized(_this), moduleName, i, false),\n          client: _this.props.client\n        }) : React.createElement(React.Fragment, null, !noData && React.createElement(ShowModule, {\n          data: blockData.data\n        }), isMultipleModule && React.createElement(Line, null)));\n      });\n      return React.createElement(ModuleContainer, null, React.createElement(ModuleTitle, null, React.createElement(\"h4\", null, moduleTitle), React.createElement(\"a\", {\n        hidden: isMultipleModule,\n        onClick: _this.changeState.bind(_assertThisInitialized(_this), moduleName, 0, true)\n      }, _this.state[moduleName + 'Data'].length > 0 && _this.state[moduleName + 'Data'][0].editing ? '' : '编辑')), ModuleContent, !isMultipleModule || _this.state.addingNew[moduleName] ? React.createElement(React.Fragment, null) : React.createElement(AddMore, {\n        onClick: _this.addInfoBlock.bind(_assertThisInitialized(_this), moduleName) // hidden={!isMultipleModule || this.state.addingNew[moduleName]}\n\n      }, React.createElement(_Icon, {\n        type: \"plus\"\n      }), React.createElement(\"span\", null, \"\\u6DFB\\u52A0\", moduleTitle)));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"addInfoBlock\", function (moduleName) {\n      var tempState = _objectSpread({}, _this.state);\n\n      tempState.addingNew[moduleName] = true;\n      var moduleData = tempState[moduleName + 'Data'];\n      var newObj = {\n        data: {},\n        editing: true,\n        addNew: true\n      };\n      moduleData.push(newObj);\n\n      _this.setState(_objectSpread({}, tempState));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"deleteInfoBlock\", function (moduleName, isAddNew) {\n      var tempState = _objectSpread({}, _this.state);\n\n      if (moduleName !== 'basicInfo' && moduleName !== 'hobby' && moduleName !== 'advantage' && isAddNew) {\n        tempState.addingNew[moduleName] = false;\n        var moduleData = tempState[moduleName + 'Data'];\n        moduleData.pop();\n\n        _this.setState(_objectSpread({}, tempState));\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"removeInfoBlock\", function (blockIndex, moduleName) {\n      var tempState = _objectSpread({}, _this.state);\n\n      tempState.addingNew[moduleName] = false;\n      tempState[moduleName + 'Data'].splice(blockIndex, 1);\n\n      _this.setState(_objectSpread({}, tempState));\n    });\n\n    _this.state = {\n      advantageData: [{\n        data: [],\n        editing: false\n      }],\n      awardData: [],\n      basicInfoData: [],\n      certificateData: [],\n      educationExperienceData: [],\n      hobbyData: [{\n        data: [],\n        editing: false\n      }],\n      jobIntentionData: [],\n      jobSkillData: [],\n      languageSkillData: [],\n      projectExperienceData: [],\n      schoolExperienceData: [],\n      socialHomepageData: [],\n      workExperienceData: [],\n      addingNew: {\n        award: false,\n        certificate: false,\n        educationExperience: false,\n        jobIntention: false,\n        jobSkill: false,\n        languageSkill: false,\n        projectExperience: false,\n        schoolExperience: false,\n        socialHomepage: false,\n        workExperience: false\n      }\n    };\n    return _this;\n  }\n\n  _createClass(UserResumeComponent, [{\n    key: \"render\",\n    value: function render() {\n      // 处理数据\n      var cvData = this.props.cvData && this.props.cvData.getFirstCVByStudentAccountId;\n\n      if (!cvData) {\n        return null;\n      }\n\n      var cvId = cvData.id;\n      var userInfo = {\n        account: {\n          person: {\n            avatar: cvData.avatar,\n            email: cvData.email,\n            gender: cvData.gender,\n            name: cvData.name,\n            phoneNumber: cvData.phoneNumberCountry ? '+' + cvData.phoneNumberCountry.countryTelCode + ' ' + cvData.phoneNumber : '- -',\n            studentNo: '',\n            nickname: ''\n          }\n        },\n        id: '',\n        studentNo: ''\n      };\n      return React.createElement(Container, null, React.createElement(Header, {\n        userInfo: userInfo,\n        resumePage: Boolean(true),\n        refetch: this.props.refetch,\n        cvId: cvId\n      }), React.createElement(MainContent, null, React.createElement(this.Module, {\n        moduleTitle: '基本信息',\n        moduleName: 'basicInfo',\n        data: this.state.basicInfoData,\n        EditModule: EditBasicInfo,\n        ShowModule: ShowBasicInfo\n      }), React.createElement(this.Module, {\n        moduleTitle: '求职意向',\n        moduleName: 'jobIntention',\n        data: this.state.jobIntentionData,\n        EditModule: EditJobIntention,\n        ShowModule: ShowJobIntention\n      }), React.createElement(this.Module, {\n        moduleTitle: '教育经历',\n        moduleName: 'educationExperience',\n        data: this.state.educationExperienceData,\n        EditModule: EditEducationExperience,\n        ShowModule: ShowEducationExperience\n      }), React.createElement(this.Module, {\n        moduleTitle: '工作经历',\n        moduleName: 'workExperience',\n        data: this.state.workExperienceData,\n        EditModule: EditWorkExperience,\n        ShowModule: ShowWorkExperience\n      }), React.createElement(this.Module, {\n        moduleTitle: '项目/研究经历',\n        moduleName: 'projectExperience',\n        data: this.state.projectExperienceData,\n        EditModule: EditProjectExperience,\n        ShowModule: ShowProjectExperience\n      }), React.createElement(this.Module, {\n        moduleTitle: '校园经历',\n        moduleName: 'schoolExperience',\n        data: this.state.schoolExperienceData,\n        EditModule: EditSchoolExperience,\n        ShowModule: ShowSchoolExperience\n      }), React.createElement(this.Module, {\n        moduleTitle: '语言技能',\n        moduleName: 'languageSkill',\n        data: this.state.languageSkillData,\n        EditModule: EditLanguageSkill,\n        ShowModule: ShowLanguageSkill\n      }), React.createElement(this.Module, {\n        moduleTitle: '工作技能',\n        moduleName: 'jobSkill',\n        data: this.state.jobSkillData,\n        EditModule: EditJobSkill,\n        ShowModule: ShowJobSkill\n      }), React.createElement(this.Module, {\n        moduleTitle: '从业资格证',\n        moduleName: 'certificate',\n        data: this.state.certificateData,\n        EditModule: EditCertificate,\n        ShowModule: ShowCertificate\n      }), React.createElement(this.Module, {\n        moduleTitle: '荣誉奖励',\n        moduleName: 'award',\n        data: this.state.awardData,\n        EditModule: EditAward,\n        ShowModule: ShowAward\n      }), React.createElement(this.Module, {\n        moduleTitle: '社交主页',\n        moduleName: 'socialHomepage',\n        data: this.state.socialHomepageData,\n        EditModule: EditSocialHomepage,\n        ShowModule: ShowSocialHomepage\n      }), React.createElement(this.Module, {\n        moduleTitle: '兴趣爱好',\n        moduleName: 'hobby',\n        data: this.state.hobbyData,\n        EditModule: EditHobby,\n        ShowModule: ShowHobby\n      }), React.createElement(this.Module, {\n        moduleTitle: '我的优势',\n        moduleName: 'advantage',\n        data: this.state.advantageData,\n        EditModule: EditAdvantage,\n        ShowModule: ShowAdvantage\n      })));\n    }\n  }]);\n\n  return UserResumeComponent;\n}(React.Component);\n\nexport default UserResumeComponent;\nexport var RadioGroupStyle = {\n  position: 'relative',\n  width: '100%'\n};\nexport var RadioLabelStyle = {\n  lineHeight: '30px',\n  marginRight: '8px'\n};\nexport var RadioInputWrapper = styled.div.withConfig({\n  displayName: \"UserResumeComponent__RadioInputWrapper\",\n  componentId: \"sc-8dc9uh-9\"\n})([\"display:flex;align-items:center;\"]);\nexport var RadioLabelWrapper = styled.div.withConfig({\n  displayName: \"UserResumeComponent__RadioLabelWrapper\",\n  componentId: \"sc-8dc9uh-10\"\n})([\"width:80px;\"]);\nexport var Line = styled.div.withConfig({\n  displayName: \"UserResumeComponent__Line\",\n  componentId: \"sc-8dc9uh-11\"\n})([\"height:1px;margin:24px 0;background:#d8d8d8;\"]);","map":null,"metadata":{},"sourceType":"module"}
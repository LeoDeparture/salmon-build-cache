{"ast":null,"code":"import \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/date-picker/style\";\nimport _DatePicker from \"antd/lib/date-picker\";\nimport \"antd/lib/cascader/style\";\nimport _Cascader from \"antd/lib/cascader\";\nimport \"antd/lib/col/style\";\nimport _Col from \"antd/lib/col\";\nimport \"antd/lib/row/style\";\nimport _Row from \"antd/lib/row\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nimport \"antd/lib/select/style\";\nimport _Select from \"antd/lib/select\";\nimport \"antd/lib/radio/style\";\nimport _Radio from \"antd/lib/radio\";\nimport \"antd/lib/form/style\";\nimport _Form from \"antd/lib/form\";\nimport moment from 'moment';\nimport React from 'react';\nimport styled from 'styled-components';\nimport AWS from '../../../components/AWS';\nimport { toCascadarOptions } from '../../../lib/commonJs';\nimport CONFIG from '../../../lib/config';\nimport { filterTelData } from '../../../lib/CountryCodeTel';\nimport { time2UTC } from '../../../lib/date';\nimport { filterData, renderOption } from '../containers/TutorDetailsContainers';\nimport { AvatarWrap } from './TutorBasicInfo';\nvar FormItem = _Form.Item;\nvar RadioGroup = _Radio.Group;\nvar Option = _Select.Option;\nvar TextArea = _Input.TextArea;\n\nvar RegistrationForm =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(RegistrationForm, _React$Component);\n\n  function RegistrationForm() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, RegistrationForm);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(RegistrationForm)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"setFieldsValue\", _this.props.form.setFieldsValue);\n\n    _defineProperty(_assertThisInitialized(_this), \"workCityInChina\", true);\n\n    _defineProperty(_assertThisInitialized(_this), \"companyInChina\", true);\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      disableWorkCity: 0,\n      disabled: false,\n      portrait: '',\n      loading: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"options\", {\n      accept: ['image/jpeg', 'image/jpg', 'image/png', 'image/bmp']\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getValue\", function (type, values) {\n      _this.setFieldsValue(_defineProperty({}, type, values));\n\n      _this.props.form.validateFieldsAndScroll();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"radioGroupChange\", function (disableName, e) {\n      var setFieldsValue = _this.props.form.setFieldsValue;\n      var value = e.target.value;\n\n      _this.setState( // @ts-ignore\n      _defineProperty({}, disableName, value), function () {\n        if (value === 0) {\n          setFieldsValue({\n            country: undefined\n          });\n        } else {\n          setFieldsValue({\n            location: undefined\n          });\n        }\n\n        _this.props.form.validateFields(['location'], {\n          force: true\n        }, function () {\n          return;\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"validator\", function (_rule, _value, callback) {\n      var disableWorkCity = _this.state.disableWorkCity;\n      var getFieldValue = _this.props.form.getFieldValue;\n      var location = getFieldValue('location');\n      var country = getFieldValue('country');\n\n      if (disableWorkCity === 0 && !location || disableWorkCity === 1 && !country) {\n        callback(\"\\u5E38\\u9A7B\\u5730\\u70B9\\u5B57\\u6BB5\\u4E0D\\u53EF\\u4E3A\\u7A7A\\uFF0C\\u8BF7\\u9009\\u586B\\u56FD\\u5185\\u6216\\u56FD\\u5916\\u5730\\u5740\");\n      }\n\n      callback();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"validateForeignCity\", function (_rule, _value, callback) {\n      var validateFields = _this.props.form.validateFields;\n      validateFields(['location'], {\n        force: true\n      }, function () {\n        return;\n      });\n      callback();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSuccess\", function (url) {\n      _this.setState({\n        portrait: url\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"deleteAvatar\", function () {\n      _Modal.confirm({\n        title: '确定删除？',\n        okText: '确认删除',\n        okType: 'danger',\n        cancelText: '取消',\n        onOk: function onOk() {\n          _this.setState({\n            portrait: ''\n          });\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"editAvatar\", function () {\n      var onError = _this.props.onError;\n      var portrait = _this.state.portrait;\n      return React.createElement(React.Fragment, null, React.createElement(AWS, {\n        onError: onError,\n        onSuccess: _this.onSuccess\n      }, React.createElement(ButForAvatar, null, \"\\u7F16\\u8F91\")), portrait && React.createElement(React.Fragment, null, \"|\", React.createElement(ButForAvatar, {\n        onClick: _this.deleteAvatar\n      }, \"\\u5220\\u9664\")));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSubmit\", function (e) {\n      _this.setState({\n        loading: true\n      });\n\n      e.preventDefault();\n\n      _this.props.form.validateFieldsAndScroll(function (err, fieldsValue) {\n        if (!err) {\n          if (!_this.state.disableWorkCity) {\n            fieldsValue.countryId = localStorage.getItem('zhiwen_china_id');\n            fieldsValue.cityId = fieldsValue.location[1];\n            fieldsValue.provinceId = fieldsValue.location[0];\n            delete fieldsValue.location;\n          } else {\n            fieldsValue.countryId = fieldsValue.country;\n            delete fieldsValue.location;\n          }\n\n          var values = _objectSpread({}, fieldsValue, {\n            workYear: Number(fieldsValue.workYear),\n            joinedTime: time2UTC(new Date(fieldsValue.joinedTime._d).setHours(8, 0, 0)),\n            portrait: _this.state.portrait,\n            phoneNumber: \"\".concat(fieldsValue.prefix, \"-\").concat(fieldsValue.phoneNumber.slice(fieldsValue.phoneNumber.indexOf('-') + 1))\n          });\n\n          delete values.workYear;\n          delete values.prefix;\n          delete values.country;\n\n          _this.props.mutationUpdateTutor(values).then(function (success) {\n            _this.setState({\n              loading: false\n            });\n\n            if (success) {\n              _this.props.changeState('editBasicInfo', false);\n            }\n          });\n        } else {\n          _this.setState({\n            loading: false\n          });\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"componentDidMount\", function () {\n      var portrait = _this.props.portrait;\n\n      _this.setState({\n        portrait: portrait\n      });\n\n      var _this$props$tutorData = _this.props.tutorData,\n          name = _this$props$tutorData.name,\n          tutorNo = _this$props$tutorData.tutorNo,\n          nickname = _this$props$tutorData.nickname,\n          phoneNumber = _this$props$tutorData.phoneNumber,\n          email = _this$props$tutorData.email,\n          wechat = _this$props$tutorData.wechat,\n          referrer = _this$props$tutorData.referrer,\n          gender = _this$props$tutorData.gender,\n          city = _this$props$tutorData.city,\n          province = _this$props$tutorData.province,\n          country = _this$props$tutorData.country,\n          joinedTime = _this$props$tutorData.joinedTime,\n          selfIntroduction = _this$props$tutorData.selfIntroduction,\n          minorProfessions = _this$props$tutorData.minorProfessions,\n          majorProfession = _this$props$tutorData.majorProfession;\n      var minorProfessionIds = filterData(minorProfessions, 'id');\n      var prefix = phoneNumber && phoneNumber.substring(phoneNumber.indexOf('-'), -phoneNumber.indexOf('-'));\n      var phoneNumbers = phoneNumber && phoneNumber.slice(phoneNumber.indexOf('-') + 1); // 获取 未知 性别 Enum\n\n      var genderUnknown = _this.props.gender.find(function (i) {\n        return i.key === 'UNKNOWN';\n      });\n\n      _this.props.form.setFieldsValue({\n        email: email,\n        genderId: gender ? gender.id : genderUnknown.id,\n        id: tutorNo,\n        joinedTime: joinedTime ? moment(joinedTime, 'YYYY-MM-DD') : joinedTime,\n        majorProfessionId: majorProfession ? majorProfession.id : null,\n        minorProfessionIds: minorProfessionIds,\n        name: name,\n        nickname: nickname,\n        country: country && !city ? country.id : undefined,\n        location: province && [province.id, city.id],\n        phoneNumber: phoneNumbers,\n        prefix: prefix,\n        referrer: referrer,\n        selfIntroduction: selfIntroduction,\n        wechat: wechat\n      }); // 当回填国外国数据时，更改disabled\n\n\n      if (country && country.id !== localStorage.getItem('zhiwen_china_id')) {\n        _this.setState({\n          disableWorkCity: 1\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"filterData\", function (input, option) {\n      return option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCancel\", function () {\n      _this.props.changeState('editBasicInfo', false);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderSelect\", function (arr) {\n      return arr.map(function (item) {\n        return React.createElement(_Radio, {\n          key: item.id,\n          value: item.id\n        }, item.name);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderTelOption\", function () {\n      var telData = filterTelData();\n\n      if (telData.length) {\n        return telData.map(function (item) {\n          return React.createElement(Option, {\n            key: item.label,\n            value: item.key\n          }, \"+\".concat(item.key, \" \").concat(item.label));\n        });\n      }\n\n      return [];\n    });\n\n    return _this;\n  }\n\n  _createClass(RegistrationForm, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          tutorData = _this$props.tutorData,\n          gender = _this$props.gender,\n          listZhiWenProfessionEnum = _this$props.listZhiWenProfessionEnum;\n      var country = tutorData.country,\n          workYear = tutorData.workYear;\n      var _this$state = this.state,\n          disableWorkCity = _this$state.disableWorkCity,\n          portrait = _this$state.portrait;\n      var getFieldDecorator = this.props.form.getFieldDecorator;\n      var prefixSelector = getFieldDecorator('prefix', {\n        initialValue: '86'\n      })(React.createElement(_Select, {\n        style: {\n          width: 140\n        }\n      }, this.renderTelOption()));\n      this.workCityInChina = !country || country.name === '中国';\n      return React.createElement(_Form, {\n        onSubmit: this.handleSubmit,\n        style: {\n          width: '100%',\n          backgroundColor: '#fff',\n          padding: 40\n        }\n      }, React.createElement(\"h3\", null, \"\\u57FA\\u672C\\u4FE1\\u606F\"), React.createElement(_Row, null, React.createElement(\"p\", null, \"\\u7CFB\\u7EDF\\u7167\\u7247\"), React.createElement(AvatarWrap, null, React.createElement(\"div\", {\n        style: _objectSpread({\n          backgroundImage: \"url(\".concat(portrait || CONFIG.default.portrait, \")\")\n        }, ImageStyle)\n      }), React.createElement(EditeDiv, null, this.editAvatar()))), React.createElement(_Row, null, React.createElement(_Col, {\n        span: 10\n      }, React.createElement(FormItem, {\n        label: \"\\u59D3\\u540D\",\n        colon: false\n      }, getFieldDecorator('name', {\n        rules: [{\n          message: '此字段无法为空',\n          required: true,\n          whitespace: true\n        }]\n      })(React.createElement(_Input, {\n        maxLength: 20\n      })))), React.createElement(_Col, {\n        span: 10,\n        offset: 4\n      }, React.createElement(FormItem, {\n        label: \"\\u6635\\u79F0\",\n        colon: false\n      }, getFieldDecorator('nickname', {\n        rules: [{\n          message: '此字段无法为空',\n          required: true,\n          whitespace: true\n        }]\n      })(React.createElement(_Input, {\n        maxLength: 30\n      }))))), React.createElement(_Row, null, React.createElement(_Col, {\n        span: 10\n      }, React.createElement(FormItem, {\n        label: \"\\u6027\\u522B\",\n        colon: false\n      }, getFieldDecorator('genderId', {\n        rules: [{\n          required: true,\n          message: '此字段无法为空'\n        }]\n      })(React.createElement(RadioGroup, null, this.renderSelect(gender))))), React.createElement(_Col, {\n        span: 10,\n        offset: 4\n      }, React.createElement(FormItem, {\n        label: \"ID\",\n        colon: false\n      }, getFieldDecorator('id', {\n        rules: [{\n          required: true,\n          message: '此字段无法为空'\n        }]\n      })(React.createElement(_Input, {\n        disabled: true\n      }))))), React.createElement(_Row, null, React.createElement(_Col, {\n        span: 10\n      }, React.createElement(FormItem, {\n        label: \"\\u624B\\u673A\\u53F7\",\n        colon: false\n      }, getFieldDecorator('phoneNumber', {\n        rules: [{\n          message: '此字段无法为空',\n          required: true,\n          whitespace: true\n        }, {\n          message: '请输入6-11位数字的手机号码',\n          pattern: /^[0-9]{6,11}$/\n        }]\n      })(React.createElement(_Input, {\n        placeholder: \"\\u8BF7\\u8F93\\u5165\\u6B63\\u786E\\u683C\\u5F0F\\u7684\\u624B\\u673A\\u53F7\\u7801\",\n        addonBefore: prefixSelector,\n        maxLength: 11,\n        minLength: 6\n      })))), React.createElement(_Col, {\n        span: 10,\n        offset: 4\n      }, React.createElement(FormItem, {\n        label: \"\\u90AE\\u7BB1\",\n        colon: false\n      }, getFieldDecorator('email', {\n        rules: [{\n          message: '邮箱格式不正确',\n          type: 'email'\n        }, {\n          message: '请输入您的邮箱!',\n          required: true\n        }]\n      })(React.createElement(_Input, {\n        placeholder: \"\\u8BF7\\u8F93\\u5165\\u6B63\\u786E\\u683C\\u5F0F\\u7684\\u90AE\\u7BB1\\u5730\\u5740\"\n      }))))), React.createElement(_Row, null, React.createElement(_Col, {\n        span: 10\n      }, React.createElement(FormItem, {\n        label: \"\\u5FAE\\u4FE1\\u53F7\",\n        colon: false\n      }, getFieldDecorator('wechat', {\n        rules: [{\n          message: '此字段无法为空',\n          required: true,\n          whitespace: true\n        }]\n      })(React.createElement(_Input, {\n        placeholder: \"\\u8BF7\\u8F93\\u5165\",\n        maxLength: 50\n      })))), React.createElement(_Col, {\n        span: 10,\n        offset: 4\n      }, React.createElement(_Row, null, React.createElement(FormItem, {\n        label: \"\\u5168\\u804C\\u5DE5\\u4F5C\\u65F6\\u95F4\",\n        colon: false\n      }, workYear !== null && React.createElement(\"p\", null, String(workYear), \" \\u5E74\"))))), React.createElement(_Row, null, React.createElement(_Col, {\n        span: 10\n      }, React.createElement(FormItem, {\n        label: \"\\u4E3B\\u6388\\u8BFE\\u884C\\u4E1A\",\n        colon: false\n      }, getFieldDecorator('majorProfessionId', {\n        rules: [{\n          message: '此字段无法为空',\n          required: true\n        }]\n      })(React.createElement(_Select, {\n        placeholder: \"\\u8BF7\\u9009\\u62E9\\uFF08\\u5355\\u9009\\uFF09\"\n      }, renderOption(listZhiWenProfessionEnum))))), React.createElement(_Col, {\n        span: 10,\n        offset: 4\n      }, React.createElement(FormItem, {\n        label: \"\\u8F85\\u6388\\u8BFE\\u884C\\u4E1A\",\n        colon: false\n      }, getFieldDecorator('minorProfessionIds', {\n        rules: [{\n          message: '此字段无法为空',\n          required: true\n        }]\n      })(React.createElement(_Select, {\n        mode: \"multiple\",\n        placeholder: \"\\u8BF7\\u9009\\u62E9\\uFF08\\u53EF\\u591A\\u9009\\uFF09\"\n      }, renderOption(listZhiWenProfessionEnum)))))), React.createElement(_Row, null, React.createElement(_Col, {\n        span: 24\n      }, React.createElement(RadioGroup, {\n        style: {\n          width: '100%'\n        },\n        defaultValue: this.workCityInChina ? 0 : 1,\n        onChange: this.radioGroupChange.bind(this, 'disableWorkCity')\n      }, React.createElement(_Col, {\n        span: 24\n      }, React.createElement(_Col, {\n        span: 10\n      }, React.createElement(Label, {\n        className: \"ant-form-item-required\"\n      }, \"\\u5E38\\u9A7B\\u5730\\u70B9\"), React.createElement(FormItem, null, React.createElement(\"div\", {\n        style: {\n          display: 'flex'\n        }\n      }, React.createElement(_Radio, {\n        value: 0\n      }), React.createElement(SelectTitle, null, \"\\u56FD\\u5185\"), getFieldDecorator('location', {\n        rules: [{\n          validator: this.validator\n        }]\n      })(React.createElement(_Cascader, {\n        disabled: Boolean(disableWorkCity),\n        showSearch: true,\n        style: {\n          flex: 1\n        },\n        options: toCascadarOptions(JSON.parse(localStorage.getItem('zhiwen_province_city')), 2),\n        allowClear: false,\n        placeholder: \"\\u8BF7\\u9009\\u62E9\",\n        notFoundContent: \"\\u65E0\\u7ED3\\u679C\"\n      }))))), React.createElement(_Col, {\n        span: 10,\n        offset: 4,\n        style: {\n          marginTop: 39\n        }\n      }, React.createElement(FormItem, {\n        label: \"\"\n      }, React.createElement(\"div\", {\n        style: {\n          display: 'flex'\n        }\n      }, React.createElement(_Radio, {\n        value: 1\n      }), React.createElement(SelectTitle, null, \"\\u56FD\\u5916\"), getFieldDecorator('country', {\n        rules: [{\n          validator: this.validateForeignCity\n        }]\n      })(React.createElement(_Select, {\n        showSearch: true,\n        placeholder: \"\\u4EC5\\u652F\\u6301\\u641C\\u7D22\\u56FD\\u5BB6\",\n        style: {\n          flex: 1\n        },\n        filterOption: this.filterData,\n        disabled: !disableWorkCity // onChange={this.onChange}\n\n      }, renderOption(JSON.parse(localStorage.getItem('zhiwen_foreign_country')))))))))))), React.createElement(_Row, null, React.createElement(_Col, {\n        span: 10\n      }, React.createElement(FormItem, {\n        label: \"\\u63A8\\u8350\\u4EBA\",\n        colon: false\n      }, getFieldDecorator('referrer')(React.createElement(_Input, {\n        maxLength: 40,\n        placeholder: \"\\u8BF7\\u8F93\\u5165\"\n      })))), React.createElement(_Col, {\n        span: 10,\n        offset: 4\n      }, React.createElement(FormItem, {\n        label: \"\\u52A0\\u5165\\u804C\\u95EE\\u65F6\\u95F4\",\n        colon: false\n      }, getFieldDecorator('joinedTime', {\n        rules: [{\n          message: '此字段无法为空',\n          required: true\n        }]\n      })(React.createElement(_DatePicker, {\n        placeholder: \"\\u8BF7\\u9009\\u62E9\",\n        style: {\n          width: '100%'\n        }\n      }))))), React.createElement(FormItem, {\n        label: \"\\u5BFC\\u5E08\\u81EA\\u6211\\u4ECB\\u7ECD\",\n        colon: false\n      }, getFieldDecorator('selfIntroduction', {\n        rules: [{\n          message: '此字段无法为空',\n          required: true,\n          whitespace: true\n        }]\n      })(React.createElement(TextArea, {\n        placeholder: \"\\u8BF7\\u8F93\\u5165\",\n        autoSize: {\n          minRows: 1,\n          maxRows: 3\n        }\n      }))), React.createElement(FormItem, {\n        labelCol: {\n          span: 12\n        }\n      }, React.createElement(_Button, {\n        onClick: this.handleCancel\n      }, \"\\u53D6\\u6D88\"), React.createElement(_Button, {\n        style: {\n          marginLeft: 20\n        },\n        type: \"primary\",\n        htmlType: \"submit\",\n        loading: this.state.loading\n      }, \"\\u4FDD\\u5B58\")));\n    }\n  }]);\n\n  return RegistrationForm;\n}(React.Component);\n\nvar WrappedRegistrationForm = _Form.create()(RegistrationForm);\n\nexport default WrappedRegistrationForm;\nvar CategoryName = styled.span.withConfig({\n  displayName: \"EditTutorBasicInfo__CategoryName\",\n  componentId: \"t302r8-0\"\n})([\"overflow:hidden;font-size:14px;text-overflow:ellipsis;word-break:break-all;\"]);\nvar EditeDiv = styled.div.withConfig({\n  displayName: \"EditTutorBasicInfo__EditeDiv\",\n  componentId: \"t302r8-1\"\n})([\"position:absolute;top:0;display:felx;align-items:center;justify-content:center;width:76px;height:98px;color:#fff;background-color:rgba(1,1,1,0.4);opacity:0;\"]);\nvar Label = styled.label.withConfig({\n  displayName: \"EditTutorBasicInfo__Label\",\n  componentId: \"t302r8-2\"\n})([\"display:block;height:40px;line-height:40px;color:rgba(0,0,0,0.85);\"]);\nvar SelectTitle = styled.span.withConfig({\n  displayName: \"EditTutorBasicInfo__SelectTitle\",\n  componentId: \"t302r8-3\"\n})([\"min-width:35px;line-height:30px;\"]);\nvar ButForAvatar = styled(CategoryName).withConfig({\n  displayName: \"EditTutorBasicInfo__ButForAvatar\",\n  componentId: \"t302r8-4\"\n})([\"color:#fff;cursor:pointer;\"]);\nvar ImageStyle = {\n  width: '76px',\n  height: '98px',\n  border: '1px solid #cbcbcb',\n  backgroundRepeat: 'no-repeat',\n  backgroundSize: 'cover',\n  backgroundPosition: 'center'\n};","map":null,"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import \"antd/lib/icon/style\";\nimport _Icon from \"antd/lib/icon\";\nimport \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport \"antd/lib/message/style\";\nimport _message from \"antd/lib/message\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport n2c from 'n2c';\nimport React, { Component } from 'react';\nimport styled from 'styled-components';\nimport SortableModal from '../../../../components/SortableModal';\nimport { parseErrorCode } from '../../../../lib/commonJs';\nimport { renderCategoryBadge } from '../components/common';\nimport CreateModal from '../components/CreateModal';\n\nvar CategoryList =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(CategoryList, _Component);\n\n  function CategoryList(props) {\n    var _this;\n\n    _classCallCheck(this, CategoryList);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(CategoryList).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"changeEditItemId\", function () {\n      _this.setState({\n        editItemId: undefined,\n        editItemData: undefined\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onRefCreateModal\", function (modal) {\n      _this.createModal = modal;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickCreate\", function () {\n      _this.createModal.showPop();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onRefSortable\", function (child) {\n      _this.sortModal = child;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickSort\", function () {\n      _this.sortModal.showPop();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderHeader\", function () {\n      var _this$props = _this.props,\n          index = _this$props.index,\n          categories = _this$props.categories,\n          createCategory = _this$props.createCategory,\n          parentId = _this$props.parentId,\n          ids = _this$props.ids,\n          onClickItem = _this$props.onClickItem,\n          updateCategory = _this$props.updateCategory,\n          handleFetchSortList = _this$props.handleFetchSortList,\n          checkNameDuplication = _this$props.checkNameDuplication,\n          handleSortConfirm = _this$props.handleSortConfirm;\n      var _this$state = _this.state,\n          editItemId = _this$state.editItemId,\n          editItemData = _this$state.editItemData;\n      var HeaderTitle = styled.span.withConfig({\n        displayName: \"CategoryList__HeaderTitle\",\n        componentId: \"sc-1tfca3-0\"\n      })([\"font-size:12px;color:#bfbfbf;\"]);\n      var levelText = \"\".concat(n2c(index + 1), \"\\u7EA7\\u5206\\u7C7B\");\n      var disabledSort = !(categories && categories.length > 1);\n      var disabledCreateBtn = false;\n\n      if (index > 0) {\n        disabledCreateBtn = ids[index - 1].itemData.childrenType;\n      }\n\n      return React.createElement(HeaderWrapper, null, React.createElement(HeaderTitle, null, React.createElement(\"span\", null, \"#\"), React.createElement(\"span\", {\n        style: {\n          margin: '0 12px'\n        }\n      }, levelText)), React.createElement(\"div\", null, React.createElement(_Button, {\n        disabled: disabledSort,\n        onClick: _this.onClickSort\n      }, \"\\u6392\\u5E8F\"), React.createElement(_Button, {\n        disabled: disabledCreateBtn,\n        style: {\n          marginLeft: 8\n        },\n        onClick: _this.onClickCreate\n      }, \"\\u521B\\u5EFA\".concat(levelText))), React.createElement(CreateModal, {\n        index: index,\n        createCategory: createCategory,\n        onRef: _this.onRefCreateModal,\n        onClickItem: onClickItem,\n        levelText: levelText,\n        parentId: parentId,\n        editItemId: editItemId,\n        editItemData: editItemData,\n        updateCategory: updateCategory,\n        checkNameDuplication: checkNameDuplication,\n        changeEditItemId: _this.changeEditItemId\n      }), React.createElement(SortableModal, {\n        onRef: _this.onRefSortable,\n        title: levelText,\n        getListItemsHelper: handleFetchSortList,\n        setListItemsHelper: handleSortConfirm\n      }));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickEdit\", function (id, category, e) {\n      e.stopPropagation();\n\n      _this.setState({\n        editItemId: id,\n        editItemData: category\n      }, function () {\n        _this.createModal.showPop();\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onOrOfflineAction\", function (status, id) {\n      var _this$props2 = _this.props,\n          onlineAction = _this$props2.onlineAction,\n          offlineAction = _this$props2.offlineAction;\n      var isOnline = status.key === 'ONLINE';\n\n      if (isOnline) {\n        offlineAction(id).then(function (_) {\n          _message.success('已成功下线此分类');\n        });\n      }\n\n      if (!isOnline) {\n        onlineAction(id).then(function (_) {\n          _message.success('已成功上线此分类');\n        }).catch(function (err) {\n          if (parseErrorCode(err) === 'NoCourse') {\n            _Modal.warning({\n              icon: React.createElement(_Icon, {\n                type: \"exclamation-circle\",\n                theme: \"filled\"\n              }),\n              title: React.createElement(ModalText, null, \"\\u65E0\\u6CD5\\u4E0A\\u7EBF\\u6B64\\u5206\\u7C7B\"),\n              content: React.createElement(ModalText, null, \"\\u5206\\u7C7B\\u4E2D\\u672A\\u627E\\u5230\\u53EF\\u4E0A\\u7EBF\\u7684\\u5173\\u8054\\u8BFE\\u7A0B\\uFF0C\\u8BF7\\u5148\\u5EFA\\u7ACB\\u8BFE\\u7A0B\\u3002\")\n            });\n          }\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"deleteItem\", function (id) {\n      _this.props.deleteAction(id).then(function (_) {\n        _message.success('已成功移除此分类');\n      }).catch(function (err) {\n        if (parseErrorCode(err) === 'HasOffspring') {\n          _Modal.warning({\n            icon: React.createElement(_Icon, {\n              type: \"exclamation-circle\",\n              theme: \"filled\"\n            }),\n            title: React.createElement(ModalText, null, \"\\u65E0\\u6CD5\\u79FB\\u9664\\u6B64\\u5206\\u7C7B\"),\n            content: React.createElement(ModalText, null, \"\\u8BF7\\u5148\\u79FB\\u9664\\u4E0B\\u7EA7\\u5206\\u7C7B\\u540E\\uFF0C\\u518D\\u5C1D\\u8BD5\\u79FB\\u9664\\u6B64\\u5206\\u7C7B\\u3002\"),\n            okText: '我知道了'\n          });\n        }\n\n        if (parseErrorCode(err) === 'HasCourse') {\n          _Modal.warning({\n            icon: React.createElement(_Icon, {\n              type: \"exclamation-circle\",\n              theme: \"filled\"\n            }),\n            title: React.createElement(ModalText, null, \"\\u65E0\\u6CD5\\u79FB\\u9664\\u6B64\\u5206\\u7C7B\"),\n            content: React.createElement(ModalText, null, \"\\u6B64\\u5206\\u7C7B\\u5DF2\\u5173\\u8054\\u8BFE\\u7A0B\\uFF0C\\u6682\\u65F6\\u65E0\\u6CD5\\u79FB\\u9664\\u6B64\\u5206\\u7C7B\\u3002\\u8BF7\\u524D\\u5F80\\u8BFE\\u7A0B\\u7BA1\\u7406\\u9875\\u9762\\uFF0C\\u79FB\\u9664\\u8BFE\\u7A0B\\u4E0E\\u6B64\\u5206\\u7C7B\\u7684\\u5173\\u8054\\u5173\\u7CFB\\u540E\\uFF0C\\u518D\\u5C1D\\u8BD5\\u79FB\\u9664\\u3002\")\n          });\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"deleteConfirm\", function (id, e) {\n      e.stopPropagation();\n      var content = React.createElement(\"div\", null, React.createElement(ModalText, null, \"\\u79FB\\u9664\\u540E\\uFF1A\"), React.createElement(ModalText, null, \"1\\u3001MIS \\u7528\\u6237\\u5C06\\u65E0\\u6CD5\\u67E5\\u770B\\u6B64\\u5206\\u7C7B\"), React.createElement(ModalText, null, \"2\\u3001APP\\u7AEF\\u7528\\u6237\\u65E0\\u6CD5\\u770B\\u5230\\u8BE5\\u5206\\u7C7B\\u5173\\u8054\\u7684\\u8BFE\\u7A0B\"));\n\n      _Modal.confirm({\n        title: React.createElement(ModalText, null, \"\\u786E\\u8BA4\\u79FB\\u9664\\u6B64\\u5206\\u7C7B\\u5417\\uFF1F\"),\n        icon: React.createElement(_Icon, {\n          type: \"question-circle\",\n          theme: \"filled\"\n        }),\n        okText: '确认移除',\n        onOk: _this.deleteItem.bind(_assertThisInitialized(_this), id),\n        content: content,\n        cancelText: '取消'\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onOrOfflineActionConfirm\", function (status, id, e) {\n      e.stopPropagation();\n      var isOnline = status.key === 'ONLINE';\n      var title;\n      var content;\n\n      if (isOnline) {\n        title = '确认下线此分类吗？';\n        content = React.createElement(\"div\", null, React.createElement(ModalText, null, \"\\u4E0B\\u7EBF\\u540E\\uFF1A\"), React.createElement(ModalText, null, \"1\\u3001MIS\\u7CFB\\u7EDF\\u53EF\\u67E5\\u770B\\u4F46\\u65E0\\u6CD5\\u88AB\\u5E94\\u7528\\u5230\\u4E1A\\u52A1\"), React.createElement(ModalText, null, \"2\\u3001App\\u7AEF\\u5DF2\\u52A0\\u5165\\u81F3\\u8BFE\\u7A0B\\u5173\\u8054\\u7528\\u6237\\u53EF\\u67E5\\u770B\"), React.createElement(ModalText, null, \"3\\u3001App\\u7AEF\\u672A\\u52A0\\u5165\\u81F3\\u8BFE\\u7A0B\\u5173\\u8054\\u7528\\u6237\\u65E0\\u6CD5\\u67E5\\u770B\"));\n      }\n\n      if (!isOnline) {\n        title = '确认上线此分类吗？';\n        content = React.createElement(\"div\", null, React.createElement(ModalText, null, \"\\u4E0A\\u7EBF\\u540E\\uFF1A\"), React.createElement(ModalText, null, \"MIS\\u7CFB\\u7EDF\\u548CApp\\u7AEF\\u5747\\u53EF\\u67E5\\u770B\\u548C\\u64CD\\u4F5C\\u3002\"));\n      }\n\n      _Modal.confirm({\n        title: React.createElement(ModalText, null, title),\n        icon: React.createElement(_Icon, {\n          type: \"question-circle\",\n          theme: \"filled\"\n        }),\n        okText: '确认下线',\n        content: content,\n        onOk: _this.onOrOfflineAction.bind(_assertThisInitialized(_this), status, id),\n        cancelText: '取消'\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderList\", function () {\n      var _this$props3 = _this.props,\n          categories = _this$props3.categories,\n          onClickItem = _this$props3.onClickItem,\n          ids = _this$props3.ids,\n          index = _this$props3.index;\n\n      if (categories && !!categories.length) {\n        return categories.map(function (category, i) {\n          var id = category.id,\n              name = category.name,\n              status = category.status;\n          var isOnline = category.status.key === 'ONLINE';\n          return React.createElement(ListItem, {\n            className: ids[index] && ids[index].id === id ? 'active' : '',\n            key: id,\n            onClick: onClickItem.bind(_assertThisInitialized(_this), {\n              id: id,\n              itemData: category\n            }, index)\n          }, React.createElement(\"span\", {\n            className: \"categoryName\"\n          }, React.createElement(\"span\", {\n            className: \"index\"\n          }, i + 1), renderCategoryBadge(status), name), React.createElement(ItemRightWrapper, null, React.createElement(ItemAction, {\n            className: \"actionBtn\"\n          }, React.createElement(\"span\", {\n            onClick: _this.onClickEdit.bind(_assertThisInitialized(_this), id, category)\n          }, \"\\u7F16\\u8F91\"), React.createElement(\"span\", {\n            onClick: _this.onOrOfflineActionConfirm.bind(_assertThisInitialized(_this), status, id)\n          }, isOnline ? '下线' : '上线'), React.createElement(\"span\", {\n            onClick: _this.deleteConfirm.bind(_assertThisInitialized(_this), id)\n          }, \"\\u79FB\\u9664\"), category.childrenType && React.createElement(\"span\", null)), index < ids.length - 1 && React.createElement(_Icon, {\n            type: !category.childrenType && 'right',\n            className: \"arrow\"\n          })));\n        });\n      }\n\n      var parentType = ids[index - 1].itemData.childrenType;\n      return React.createElement(EmptyText, null, !index ? '当前没有课程分类，请先创建～' : !parentType ? '' : '由于上级分类已设置为可关联课程，无法继续创建此级分类');\n    });\n\n    _this.state = {\n      editItemId: undefined,\n      editItemData: undefined\n    };\n    return _this;\n  }\n\n  _createClass(CategoryList, [{\n    key: \"render\",\n    value: function render() {\n      var footer = this.props.footer;\n      return React.createElement(React.Fragment, null, this.renderHeader(), this.renderList(), React.createElement(FooterWrapper, null, footer));\n    }\n  }]);\n\n  return CategoryList;\n}(Component);\n\nexport default CategoryList;\nvar ListItem = styled.div.withConfig({\n  displayName: \"CategoryList__ListItem\",\n  componentId: \"sc-1tfca3-1\"\n})([\"display:flex;align-items:center;justify-content:space-between;min-height:56px;padding:0 12px;font-size:14px;cursor:pointer;&:hover{background-color:rgba(23,43,77,0.05);& .actionBtn{display:flex;}}&.actionBtn{margin-right:1px;}&.active{background-color:rgba(23,43,77,0.1);}.categoryName{width:60%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}.index{margin-right:18px;font-family:'DIN',sans-serif;color:#172b4d;}\"]);\nvar FooterWrapper = styled.div.withConfig({\n  displayName: \"CategoryList__FooterWrapper\",\n  componentId: \"sc-1tfca3-2\"\n})([\"padding:12px 0;\"]);\nvar EmptyText = styled.p.withConfig({\n  displayName: \"CategoryList__EmptyText\",\n  componentId: \"sc-1tfca3-3\"\n})([\"margin-top:82px;font-size:14px;line-height:22px;color:#a2aab8;text-align:center;\"]);\nvar ItemRightWrapper = styled.div.withConfig({\n  displayName: \"CategoryList__ItemRightWrapper\",\n  componentId: \"sc-1tfca3-4\"\n})([\"display:flex;align-content:center;height:21px;& .arrow{height:17px;padding-top:3px;color:#42526e;}\"]);\nvar ItemAction = styled.div.withConfig({\n  displayName: \"CategoryList__ItemAction\",\n  componentId: \"sc-1tfca3-5\"\n})([\"display:none;align-content:center;width:145px;min-width:145px;& span{display:inline-block;margin-right:15px;color:#5674bf;}& span:nth-child(3){color:#ff5230;}\"]);\nvar HeaderWrapper = styled.div.withConfig({\n  displayName: \"CategoryList__HeaderWrapper\",\n  componentId: \"sc-1tfca3-6\"\n})([\"display:flex;align-items:center;justify-content:space-between;height:56px;padding:0 12px;background-color:#fafafa;\"]);\nvar ModalText = styled.div.withConfig({\n  displayName: \"CategoryList__ModalText\",\n  componentId: \"sc-1tfca3-7\"\n})([\"color:#42526e;\"]);","map":null,"metadata":{},"sourceType":"module"}
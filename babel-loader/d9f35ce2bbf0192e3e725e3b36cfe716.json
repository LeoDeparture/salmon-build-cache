{"ast":null,"code":"import \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport \"antd/lib/icon/style\";\nimport _Icon from \"antd/lib/icon\";\nimport \"antd/lib/badge/style\";\nimport _Badge from \"antd/lib/badge\";\nimport \"antd/lib/row/style\";\nimport _Row from \"antd/lib/row\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/col/style\";\nimport _Col from \"antd/lib/col\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport \"antd/lib/message/style\";\nimport _message from \"antd/lib/message\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport { addMinutes, format } from 'date-fns';\nimport React from 'react';\nimport styled from 'styled-components';\nimport { DetailCommonP, FlexDisplay } from '../../../lib/commonCss';\nimport { breakLine } from '../../../lib/commonJs';\nimport { cancelGroupCourseSlot } from '../containers/MutationChangeGroupCourseSlotTutor';\nexport var ScheduleType = {\n  NOT_ENOUGH_NO_TUTOR: {\n    badge: 'warning',\n    text: '未达到开课人数 - 未分配导师'\n  },\n  NOT_ENOUGH_AND_TUTOR: {\n    badge: 'warning',\n    text: '未达到开课人数 - 已分配导师'\n  },\n  ENOUGH_NO_TUTOR: {\n    badge: 'error',\n    text: '已达到开课人数 - 未分配导师'\n  },\n  ENOUGH_AND_TUTOR: {\n    badge: 'warning',\n    text: '已达到开课人数 - 已分配导师'\n  },\n  COMPLETED: {\n    badge: 'success',\n    text: '报名截止时间已到 - 正常开课'\n  }\n};\nvar dataType = 'YYYY/MM/DD HH:mm';\n\nvar TitleComponent =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(TitleComponent, _React$Component);\n\n  function TitleComponent() {\n    var _getPrototypeOf2,\n        _this2 = this;\n\n    var _this;\n\n    _classCallCheck(this, TitleComponent);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(TitleComponent)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      value: '',\n      loading: false,\n      visible: false // status: this.props.data.status.key,\n\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"hideModal\", function () {\n      _this.setState({\n        visible: !_this.state.visible\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"mutationAction\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var variables, filterFun;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this.setState({\n                loading: true\n              });\n\n              variables = {\n                input: {\n                  id: _this.props.data.id,\n                  cancelReason: _this.state.value\n                }\n              };\n\n              filterFun = function filterFun(data, result2) {\n                data.getGroupCourseSlotById = _objectSpread({}, data.getGroupCourseSlotById, result2.data.cancelGroupCourseSlot);\n                return data;\n              };\n\n              _context.next = 5;\n              return _this.props.mutations(cancelGroupCourseSlot, variables, filterFun).then(function () {\n                _this.setState({\n                  visible: false,\n                  loading: false\n                });\n\n                _message.success('已成功取消此排期');\n              }).catch(function () {\n                _this.setState({\n                  loading: false\n                });\n              });\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    })));\n\n    _defineProperty(_assertThisInitialized(_this), \"handleChange\", function (e) {\n      _this.setState({\n        value: e.target.value\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"modalContent\", function () {\n      var status = _this.props.data.status.key;\n\n      if (status !== 'CANCELED') {\n        return React.createElement(\"div\", null, React.createElement(\"div\", {\n          style: {\n            marginBottom: '25px'\n          }\n        }, React.createElement(ModalText, null, \"\\u53D6\\u6D88\\u6B64\\u6B21\\u6392\\u671F\\u540E\\uFF1A\"), React.createElement(ModalText, null, \"1\\u3001\\u65E0\\u6CD5\\u518D\\u6B21\\u4E0A\\u7EBF\\u6B64\\u6392\\u671F\\uFF1B\"), React.createElement(ModalText, null, \"2\\u3001\\u672A\\u62A5\\u540D\\u7684\\u5B66\\u5458\\u5C06\\u65E0\\u6CD5\\u770B\\u5230\\u6B64\\u6392\\u671F\\uFF1B\"), React.createElement(ModalText, null, \"3\\u3001\\u5DF2\\u62A5\\u540D\\u7684\\u5B66\\u5458\\u5C06\\u6536\\u5230\\u53D6\\u6D88\\u901A\\u77E5\\uFF08\\u5982\\u4E0B\\uFF09\\u3002\")), React.createElement(\"div\", null, React.createElement(HasStart, null, \"\\u53D6\\u6D88\\u7406\\u7531\"), React.createElement(ModalText, {\n          color: \"#AEAEAE\",\n          style: {\n            display: 'inline-block',\n            fontSize: 12\n          }\n        }, \"\\u53EF\\u624B\\u52A8\\u4FEE\\u6539\"), _this.state.value && React.createElement(_Input.TextArea, {\n          value: _this.state.value,\n          onChange: _this.handleChange,\n          rows: 3\n        })));\n      }\n\n      var cancelReason = _this.props.data.cancelReason;\n      return React.createElement(ReasonContent, null, breakLine(cancelReason));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"Description\", function (_ref2) {\n      var term = _ref2.term,\n          children = _ref2.children,\n          _ref2$span = _ref2.span,\n          span = _ref2$span === void 0 ? 7 : _ref2$span;\n      return React.createElement(_Col, {\n        span: span\n      }, React.createElement(FlexDisplay, null, React.createElement(DetailCommonP, null, term), React.createElement(\"div\", {\n        style: {\n          fontSize: 14\n        }\n      }, children)));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"footer\", function () {\n      var loading = _this.state.loading;\n      var status = _this.props.data.status.key;\n\n      if (status !== 'CANCELED') {\n        return React.createElement(React.Fragment, null, React.createElement(_Button, {\n          onClick: _this.hideModal\n        }, \"\\u53D6\\u6D88\"), React.createElement(_Button, {\n          onClick: _this.mutationAction,\n          loading: loading\n        }, \"\\u53D6\\u6D88\\u6B64\\u6392\\u671F\"));\n      }\n\n      return React.createElement(_Button, {\n        onClick: _this.hideModal,\n        type: \"primary\"\n      }, \"\\u6211\\u77E5\\u9053\\u4E86\");\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"content\", function () {\n      var data = _this.props.data;\n      var appointDeadLine = format(addMinutes(data.time, -data.appointDeadline), dataType);\n      var fullyRefundableTime = format(addMinutes(data.time, -data.fullyRefundableTime), dataType);\n      return React.createElement(_Row, null, React.createElement(_this2.Description, {\n        term: \"\\u4E0A\\u8BFE\\u65F6\\u95F4\\uFF1A\"\n      }, format(data.time, dataType)), React.createElement(_this2.Description, {\n        term: \"\\u65E0\\u635F\\u9000\\u8BFE\\u65F6\\u95F4\\uFF1A\"\n      }, fullyRefundableTime), React.createElement(_this2.Description, {\n        term: \"\\u62A5\\u540D\\u622A\\u6B62\\u65F6\\u95F4\\uFF1A\"\n      }, appointDeadLine), React.createElement(_this2.Description, {\n        term: \"\\u5DF2\\u62A5\\u540D\\u4EBA\\u6570\\uFF1A\"\n      }, data.studentAccounts.length), React.createElement(_this2.Description, {\n        term: \"\\u6700\\u4F4E\\u4EBA\\u6570\\uFF1A\"\n      }, data.min), React.createElement(_this2.Description, {\n        term: \"\\u6700\\u9AD8\\u4EBA\\u6570\\uFF1A\"\n      }, data.max));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderTitle\", function (type) {\n      var _this$props$data = _this.props.data,\n          status = _this$props$data.status,\n          cancelReason = _this$props$data.cancelReason,\n          groupCourse = _this$props$data.groupCourse;\n\n      var cutString = function cutString(str) {\n        if (str && str.length > 16) {\n          return \"\".concat(str.slice(0, 16), \"...\");\n        }\n\n        return str;\n      };\n\n      var cancelMsg = cutString(cancelReason);\n      var badgeText = cancelMsg ? {\n        badge: 'default',\n        text: \"\\u5DF2\\u53D6\\u6D88\\uFF08\".concat(cancelMsg, \"\\uFF09\")\n      } : ScheduleType[type.type];\n      return React.createElement(_Row, {\n        style: {\n          marginBottom: 16\n        }\n      }, React.createElement(_Col, {\n        span: 18\n      }, React.createElement(FlexDisplay, null, React.createElement(\"h3\", {\n        style: {\n          margin: '0 12px 0 0'\n        }\n      }, \"\\u5C0F\\u73ED\\u8BFE\\u540D\\u79F0\\uFF1A \", groupCourse.name), React.createElement(FlexDisplay, {\n        style: {\n          lineHeight: '29px'\n        }\n      }, React.createElement(_Badge, {\n        status: badgeText.badge\n      }), React.createElement(TitleText, null, badgeText.text), status.key === 'CANCELED' && React.createElement(ReasonBut, {\n        onClick: _this.hideModal\n      }, \"\\u67E5\\u770B\\u5B8C\\u6574\\u7406\\u7531\")))), status.key !== 'CANCELED' && React.createElement(_Button, {\n        style: {\n          float: 'right'\n        },\n        onClick: _this.hideModal\n      }, \"\\u53D6\\u6D88\\u6B64\\u6392\\u671F\"));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderModalTitle\", function () {\n      var status = _this.props.data.status.key;\n\n      if (status !== 'CANCELED') {\n        return React.createElement(FlexDisplay, null, React.createElement(_Icon, {\n          type: \"exclamation-circle\",\n          style: {\n            fontSize: '22px',\n            color: '#FCAD28'\n          }\n        }), React.createElement(\"div\", {\n          style: {\n            marginLeft: '15px'\n          }\n        }, \"\\u786E\\u8BA4\\u53D6\\u6D88\\u6B64\\u6392\\u671F\\u5417\\uFF1F\"));\n      }\n\n      return '取消理由';\n    });\n\n    return _this;\n  }\n\n  _createClass(TitleComponent, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var data = this.props.data;\n\n      if (data.groupCourse !== null) {\n        this.setState({\n          value: \"\\u539F\\u5B9A\\u4E8E \".concat(format(data.time, 'YYYY/MM/DD HH:mm'), \" \\u7684\\u5C0F\\u73ED\\u8BFE\\u8F85\\u5BFC\\uFF1A\").concat(data.groupCourse.name, \" \\u5DF2\\u53D6\\u6D88\")\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var status = this.props.data.status;\n      var statusName = status.key;\n      return React.createElement(FlexDisplay, {\n        style: {\n          flexDirection: 'column',\n          background: '#fff',\n          padding: '16px 32px'\n        }\n      }, React.createElement(this.renderTitle, {\n        type: statusName\n      }), React.createElement(this.content, null), React.createElement(_Modal, {\n        title: this.renderModalTitle(),\n        visible: this.state.visible,\n        footer: this.footer(),\n        closable: false\n      }, React.createElement(this.modalContent, null)));\n    }\n  }]);\n\n  return TitleComponent;\n}(React.Component);\n\nexport default TitleComponent;\nvar ModalText = styled.p.withConfig({\n  displayName: \"TitleComponent__ModalText\",\n  componentId: \"po1q7j-0\"\n})([\"margin-bottom:0;font-size:14px;color:\", \";&::before{font-size:14px;line-height:22px;color:red;content:\", \";}\"], function (props) {\n  return props.color || '#4a4a4a';\n}, function (props) {\n  return props.hasStart;\n});\nvar ReasonBut = styled.a.withConfig({\n  displayName: \"TitleComponent__ReasonBut\",\n  componentId: \"po1q7j-1\"\n})([\"margin-left:10px;font-size:14px;word-break:keep-all;\"]);\nvar HasStart = styled.p.withConfig({\n  displayName: \"TitleComponent__HasStart\",\n  componentId: \"po1q7j-2\"\n})([\"display:inline-block;margin-right:12px;margin-bottom:0;font-size:14px;color:#4a4a4a;&::before{font-size:14px;line-height:22px;color:red;content:'*';}\"]);\nvar TitleText = styled.span.withConfig({\n  displayName: \"TitleComponent__TitleText\",\n  componentId: \"po1q7j-3\"\n})([\"margin-left:8px;font-size:14px;white-space:nowrap;\"]);\nvar ReasonContent = styled.div.withConfig({\n  displayName: \"TitleComponent__ReasonContent\",\n  componentId: \"po1q7j-4\"\n})([\"height:210px;overflow-y:scroll;\"]);","map":null,"metadata":{},"sourceType":"module"}
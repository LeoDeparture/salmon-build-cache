{"ast":null,"code":"import \"antd/lib/config-provider/style\";\nimport _ConfigProvider from \"antd/lib/config-provider\";\nimport \"antd/lib/table/style\";\nimport _Table from \"antd/lib/table\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport \"antd/lib/badge/style\";\nimport _Badge from \"antd/lib/badge\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport { format } from 'date-fns';\nimport React from 'react';\nimport styled from 'styled-components';\nimport EmptyComponent from '../../../../components/Empty';\nimport InlineAccountInfo from '../../../../components/InlineAccountInfo';\nimport TableOperation from '../../../../components/Table/TableOperation';\n\nvar ServiceTicketsTable =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ServiceTicketsTable, _React$Component);\n\n  function ServiceTicketsTable(props) {\n    var _this;\n\n    _classCallCheck(this, ServiceTicketsTable);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ServiceTicketsTable).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"renderExpandedRow\", function (record) {\n      return React.createElement(ExpandedContainer, null, React.createElement(ExpandedItem, null, \"\\u5B66\\u5458ID\\uFF1A\", React.createElement(BlackItem, null, record.studentAccount.studentNo)), React.createElement(ExpandedItem, null, \"\\u670D\\u52A1\\u5355ID\\uFF1A\", React.createElement(BlackItem, null, record.serviceTicketNo)), React.createElement(ExpandedItem, null, \"\\u521B\\u5EFA\\u65E5\\u671F\\uFF1A\", React.createElement(BlackItem, null, format(record.createdAt, 'YYYY/MM/DD'))));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderReviewStatus\", function (data) {\n      switch (data.key) {\n        case 'WAITING':\n          return React.createElement(_Badge, {\n            color: \"#FF991F\",\n            text: data.name\n          });\n\n        case 'PASSED':\n          return React.createElement(_Badge, {\n            color: \"#36B37E\",\n            text: data.name\n          });\n\n        case 'FAILED':\n          return React.createElement(_Badge, {\n            color: \"#FF5230\",\n            text: data.name\n          });\n      }\n\n      return null;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"changeLoading\", function (loading) {\n      _this.setState({\n        loading: loading\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderPaymentStatus\", function (data) {\n      switch (data.key) {\n        case 'WAITING':\n          return React.createElement(_Badge, {\n            color: \"#FF991F\",\n            text: \"\\u5F85\\u4ED8\\u6B3E\"\n          });\n\n        case 'NOT_FINISHED':\n          return React.createElement(_Badge, {\n            color: \"#FF991F\",\n            text: \"\\u672A\\u5B8C\\u6210\\u4ED8\\u6B3E\"\n          });\n\n        case 'FINISHED':\n          return React.createElement(_Badge, {\n            color: \"#36B37E\",\n            text: \"\\u5DF2\\u5B8C\\u6210\\u4ED8\\u6B3E\"\n          });\n        // case 'PARTIAL_REFUNDED':\n        //   return <Badge color=\"#FF5230\" text=\"部分退款\" />;\n        // case 'ALL_REFUNDED':\n        //   return <Badge color=\"#FF5230\" text=\"全额退款\" />;\n      }\n\n      return null;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderAvatar\", function (data) {\n      if (!data) return null;\n      var id = data.id,\n          account = data.account;\n      return React.createElement(InlineAccountInfo, {\n        account: account,\n        url: \"/user-details/\".concat(id)\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderTableOperation\", function (id, record) {\n      var _this$props = _this.props,\n          type = _this$props.type,\n          toServiceTicketDetail = _this$props.toServiceTicketDetail,\n          agreeServiceTicket = _this$props.agreeServiceTicket,\n          disagreeServiceTicket = _this$props.disagreeServiceTicket;\n\n      if (type === 'create' || record.reviewStatus.key === 'FAILED' || record.reviewStatus.key === 'PASSED') {\n        var CreateOperations = [{\n          title: '查看详情',\n          onClick: toServiceTicketDetail.bind(_assertThisInitialized(_this), id)\n        }];\n        return React.createElement(TableOperation, {\n          operations: CreateOperations\n        });\n      }\n\n      var operations = [{\n        title: '查看详情',\n        onClick: toServiceTicketDetail.bind(_assertThisInitialized(_this), id)\n      }, {\n        title: '通过',\n        onClick: agreeServiceTicket.bind(_assertThisInitialized(_this), id)\n      }, {\n        title: '拒绝',\n        color: 'red',\n        onClick: disagreeServiceTicket.bind(_assertThisInitialized(_this), id)\n      }];\n      return React.createElement(TableOperation, {\n        operations: operations,\n        limit: 4\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"formatActualPrice\", function (v) {\n      var formatValue = v.actualPrice / 100;\n\n      if (\"\".concat(formatValue).includes('.')) {\n        return formatValue;\n      }\n\n      return formatValue + '.00';\n    });\n\n    _this.state = {\n      loading: false\n    };\n    return _this;\n  }\n\n  _createClass(ServiceTicketsTable, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props2 = this.props,\n          type = _this$props2.type,\n          ticketCounts = _this$props2.ticketCounts,\n          serviceListData = _this$props2.serviceListData,\n          footer = _this$props2.footer; // 生成表格 column\n\n      var columnsData = [{\n        title: '学员（姓名 | 昵称）',\n        key: 'studentAccount',\n        width: '19%',\n        render: this.renderAvatar\n      }, {\n        title: '咨询服务方案',\n        key: 'servicePlanSnapshot',\n        width: '19%',\n        render: function render(servicePlanSnapshot) {\n          return servicePlanSnapshot ? servicePlanSnapshot.name : '- -';\n        }\n      }, {\n        title: '应付总价（CNY）',\n        key: 'payInfo',\n        width: '15%',\n        render: function render(payInfo) {\n          return _this2.formatActualPrice(payInfo);\n        }\n      }, {\n        title: '审核状态',\n        key: 'reviewStatus',\n        width: '13%',\n        render: this.renderReviewStatus\n      }, {\n        title: '付款状态',\n        key: 'payStatus',\n        width: '15%',\n        render: this.renderPaymentStatus\n      }, {\n        title: '操作',\n        key: 'id',\n        width: '19%',\n        render: this.renderTableOperation\n      }];\n      var columns = columnsData.map(function (column) {\n        return _objectSpread({}, column, {\n          dataIndex: column.key,\n          ellipsis: true\n        });\n      });\n\n      var Empty = function Empty() {\n        return React.createElement(EmptyComponent, null);\n      };\n\n      return React.createElement(_ConfigProvider, {\n        renderEmpty: Empty\n      }, type === 'create' && React.createElement(TotalContainer, null, React.createElement(TotalItem, null, \"\\u603B\\u91D1\\u989D\\uFF08CNY\\uFF09\\uFF1A\", React.createElement(BlackItem, null, Number(ticketCounts.totalPayAmount) / 100)), React.createElement(TotalItem, null, \"\\u670D\\u52A1\\u5355\\u6570\\uFF1A\", React.createElement(BlackItem, null, ticketCounts.totalServiceTicket))), React.createElement(_Table, {\n        rowKey: \"id\",\n        style: {\n          flex: 1,\n          marginTop: '8px'\n        },\n        pagination: false,\n        dataSource: serviceListData,\n        columns: columns,\n        footer: footer,\n        expandedRowRender: this.renderExpandedRow,\n        loading: this.state.loading\n      }));\n    }\n  }]);\n\n  return ServiceTicketsTable;\n}(React.Component);\n\nexport { ServiceTicketsTable as default };\nvar ExpandedContainer = styled.div.withConfig({\n  displayName: \"ServiceTicketsTable__ExpandedContainer\",\n  componentId: \"sc-1w60za8-0\"\n})([\"display:flex;align-items:center;width:100%;height:22px;\"]);\nvar ExpandedItem = styled.div.withConfig({\n  displayName: \"ServiceTicketsTable__ExpandedItem\",\n  componentId: \"sc-1w60za8-1\"\n})([\"display:flex;flex:1;font-size:14px;line-height:22px;color:#a2aab8;\"]);\nvar BlackItem = styled.div.withConfig({\n  displayName: \"ServiceTicketsTable__BlackItem\",\n  componentId: \"sc-1w60za8-2\"\n})([\"color:#172b4d;\"]);\nvar TotalContainer = styled.div.withConfig({\n  displayName: \"ServiceTicketsTable__TotalContainer\",\n  componentId: \"sc-1w60za8-3\"\n})([\"display:flex;justify-content:flex-end;width:100%;margin-top:8px;color:#a2aab8;\"]);\nvar TotalItem = styled.div.withConfig({\n  displayName: \"ServiceTicketsTable__TotalItem\",\n  componentId: \"sc-1w60za8-4\"\n})([\"display:flex;margin-left:24px;font-size:12px;line-height:18px;\"]);","map":null,"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport \"antd/lib/row/style\";\nimport _Row from \"antd/lib/row\";\nimport \"antd/lib/switch/style\";\nimport _Switch from \"antd/lib/switch\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"antd/lib/form/style\";\nimport _Form from \"antd/lib/form\";\nimport React from 'react';\nimport styled from 'styled-components';\nimport { FlexContentCenterV, FlexDisplay } from '../../../lib/commonCss';\nvar FormItem = _Form.Item;\nvar ModalText = styled.p.withConfig({\n  displayName: \"modalForm__ModalText\",\n  componentId: \"sc-1lveg4r-0\"\n})([\"margin-bottom:0;font-size:14px;color:\", \";&::before{font-size:14px;line-height:22px;color:red;content:'*';}\"], function (props) {\n  return props.color || '#4a4a4a';\n});\nvar ModalTextNoStar = styled.p.withConfig({\n  displayName: \"modalForm__ModalTextNoStar\",\n  componentId: \"sc-1lveg4r-1\"\n})([\"margin-bottom:0;font-size:14px;\"]);\nvar DetailCommonP = styled.p.withConfig({\n  displayName: \"modalForm__DetailCommonP\",\n  componentId: \"sc-1lveg4r-2\"\n})([\"display:inline-block;margin:0 0 0 8px;font-size:12px;color:#abb2bf;\"]);\n\nvar RegistrationForm =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(RegistrationForm, _React$Component);\n\n  function RegistrationForm() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, RegistrationForm);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(RegistrationForm)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"setFieldsValue\", _this.props.form.setFieldsValue);\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      disable: true,\n      itemName: '',\n      loading: false,\n      switchData: false,\n      type: '',\n      visible: _this.props.visible\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onChange\", function (value) {\n      _this.setState({\n        switchData: value\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getValue\", function (resultDate) {\n      _this.setFieldsValue({\n        appointmentTimes: resultDate\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSubmit\",\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(e) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                e.preventDefault();\n\n                _this.props.setStateValue('mutationLoading', true);\n\n                _this.props.form.validateFieldsAndScroll(\n                /*#__PURE__*/\n                function () {\n                  var _ref2 = _asyncToGenerator(\n                  /*#__PURE__*/\n                  _regeneratorRuntime.mark(function _callee(err, values) {\n                    return _regeneratorRuntime.wrap(function _callee$(_context) {\n                      while (1) {\n                        switch (_context.prev = _context.next) {\n                          case 0:\n                            if (!err) {\n                              _this.props.getValue({\n                                childrenType: _this.state.switchData,\n                                name: values.name\n                              });\n                            } else {\n                              _this.props.setStateValue('mutationLoading', false);\n\n                              _this.setState({\n                                disable: true\n                              });\n                            }\n\n                          case 1:\n                          case \"end\":\n                            return _context.stop();\n                        }\n                      }\n                    }, _callee);\n                  }));\n\n                  return function (_x2, _x3) {\n                    return _ref2.apply(this, arguments);\n                  };\n                }());\n\n              case 3:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"hasSameName\",\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(_rule, _value, callback) {\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (!(_value.trim() !== '')) {\n                  _context3.next = 4;\n                  break;\n                }\n\n                _context3.next = 3;\n                return _this.props.hasSameName(_value.trim()).then(function (result) {\n                  var listCourseCategories = result.data.listCourseCategories;\n\n                  if (result.data && listCourseCategories.length && listCourseCategories[0].name !== _this.props.itemName) {\n                    _this.setState({\n                      loading: false\n                    });\n\n                    if (listCourseCategories.length) {\n                      _this.props.setStateValue('mutationLoading', false);\n\n                      callback('此分类名已被同一级别分类占用，请重新输入');\n                      return;\n                    }\n\n                    callback();\n                  }\n                }).catch(function () {\n                  callback();\n                });\n\n              case 3:\n                return _context3.abrupt(\"return\");\n\n              case 4:\n                callback();\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      return function (_x4, _x5, _x6) {\n        return _ref3.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"inputOnChange\", function (e) {\n      var theValue = e.target.value.trim();\n\n      if (theValue.length > 0) {\n        _this.setState({\n          disable: false\n        });\n      } else {\n        _this.setState({\n          disable: true\n        });\n\n        _this.props.setStateValue('mutationLoading', false);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onCancel\", function () {\n      _this.props.setStateValue('visible', false);\n\n      _this.props.setStateValue('itemChildrenType', null);\n\n      _this.props.setStateValue('mutationLoading', false);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"afterClose\", function () {\n      var _this$props = _this.props,\n          type = _this$props.type,\n          title = _this$props.title;\n\n      if (type === 'create' && title !== '三级分类') {\n        _this.setState({\n          switchData: false\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderFooter\", function () {\n      var _this$props2 = _this.props,\n          type = _this$props2.type,\n          parent = _this$props2.parent;\n      return React.createElement(FlexContentCenterV, {\n        style: {\n          justifyContent: 'space-between'\n        }\n      }, React.createElement(FlexDisplay, null, type === 'edit' ? React.createElement(DetailCommonP, null, \"\\u4E0A\\u7EA7\\u5206\\u7C7B\\uFF1A \", parent) : React.createElement(\"div\", null)), React.createElement(FlexDisplay, {\n        style: {\n          alignItems: 'center'\n        }\n      }, React.createElement(_Button, {\n        style: {\n          marginRight: 10,\n          fontSize: 15\n        },\n        onClick: _this.onCancel\n      }, \"\\u53D6 \\u6D88\"), React.createElement(_Button, {\n        type: \"primary\",\n        loading: _this.props.mutationLoading,\n        disabled: _this.state.disable,\n        onClick: _this.handleSubmit\n      }, type === 'edit' ? '保存' : '创建')));\n    });\n\n    return _this;\n  }\n\n  _createClass(RegistrationForm, [{\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      if (this.props.type === 'edit') {\n        this.setState({\n          visible: nextProps.visible,\n          switchData: nextProps.itemChildrenType\n        });\n        return;\n      }\n\n      if (nextProps.title === '三级分类') {\n        this.setState({\n          visible: nextProps.visible,\n          switchData: true\n        });\n        return;\n      }\n\n      this.setState({\n        visible: nextProps.visible\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var getFieldDecorator = this.props.form.getFieldDecorator;\n      var switchData = this.state.switchData;\n      var _this$props3 = this.props,\n          type = _this$props3.type,\n          title = _this$props3.title,\n          itemName = _this$props3.itemName,\n          itemChildrenType = _this$props3.itemChildrenType;\n      var titleText = type === 'edit' ? \"\\u7F16\\u8F91\".concat(title) : \"\\u521B\\u5EFA\".concat(title);\n      return React.createElement(_Form, {\n        onSubmit: this.handleSubmit,\n        style: {\n          width: '100%',\n          backgroundColor: '#fff'\n        }\n      }, React.createElement(_Modal, {\n        title: titleText,\n        destroyOnClose: true,\n        maskClosable: true,\n        afterClose: this.afterClose,\n        closable: false,\n        visible: this.state.visible,\n        okText: \"\\u521B\\u5EFA\".concat(title),\n        onOk: this.handleSubmit,\n        footer: this.renderFooter()\n      }, React.createElement(_Row, null, React.createElement(FormItem, {\n        style: {\n          width: 350\n        }\n      }, React.createElement(ModalText, null, \"\".concat(title, \"\\u540D\\u79F0\")), getFieldDecorator('name', {\n        initialValue: type === 'edit' ? itemName : null,\n        rules: [{\n          message: '字段不可为空',\n          required: true\n        }, {\n          validator: this.hasSameName\n        }]\n      })(React.createElement(_Input, {\n        placeholder: \"\\u8BF7\\u8F93\\u5165\".concat(title, \"\\u540D\\u79F0\\uFF0C\\u965010\\u5B57\\u4EE5\\u5185\"),\n        onChange: this.inputOnChange,\n        maxLength: 10\n      }))), React.createElement(FormItem, {\n        style: {\n          margin: '32px 0 70px'\n        }\n      }, type === 'edit' ? React.createElement(\"div\", null, React.createElement(ModalText, null, \"\\u662F\\u5426\\u53EF\\u5173\\u8054\\u8BFE\\u7A0B?\"), React.createElement(_Switch, {\n        disabled: true,\n        checked: itemChildrenType,\n        onChange: this.onChange\n      }), React.createElement(DetailCommonP, null, itemChildrenType ? '如设置此分类可关联课程，将无法继续创建此分类下的子分类' : '如设置此分类不可关联课程，可继续创建此分类下的子分类。')) : React.createElement(\"div\", null, React.createElement(ModalTextNoStar, null, \"\\u662F\\u5426\\u53EF\\u5173\\u8054\\u8BFE\\u7A0B?\"), React.createElement(_Switch, {\n        disabled: title === '三级分类',\n        checked: switchData,\n        onChange: this.onChange\n      }), React.createElement(DetailCommonP, null, switchData ? '如设置此分类可关联课程，将无法继续创建此分类下的子分类' : '如设置此分类不可关联课程，可继续创建此分类下的子分类。'))))));\n    }\n  }]);\n\n  return RegistrationForm;\n}(React.Component);\n\nexport default _Form.create()(RegistrationForm);","map":null,"metadata":{},"sourceType":"module"}
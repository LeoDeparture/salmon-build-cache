{"ast":null,"code":"import \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nimport \"antd/lib/row/style\";\nimport _Row from \"antd/lib/row\";\nimport \"antd/lib/date-picker/style\";\nimport _DatePicker from \"antd/lib/date-picker\";\nimport \"antd/lib/col/style\";\nimport _Col from \"antd/lib/col\";\nimport \"antd/lib/form/style\";\nimport _Form from \"antd/lib/form\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport \"antd/lib/message/style\";\nimport _message from \"antd/lib/message\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport moment from 'moment';\nimport React, { Component } from 'react';\nimport InlineAccountInfo from '../../../../components/InlineAccountInfo';\nimport NumberInput from '../../../../components/Input/NumberInput';\nimport ZhiWenSelect from '../../../../components/Select/ZhiWenSelect';\nimport { checkEmpty, dateText, formatPrice } from '../../../../lib/commonJs';\nimport { NoEmptyOtherRule, RequiredPositiveIntegerRule } from '../../../../lib/commonRule';\nimport { Item, ItemContent, ItemTitle } from '../../components/CSSComponents';\nimport { Header, HeaderTitle, Wrapper } from '../../reviewStudent/components/ReviewModule';\nimport { Line, LineWithAccount } from './Profile';\nimport { ReviewStatus } from './ReviewListItem';\n\nvar ReviewModule =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ReviewModule, _Component);\n\n  function ReviewModule(props) {\n    var _this;\n\n    _classCallCheck(this, ReviewModule);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ReviewModule).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickReview\", function () {\n      _this.setState({\n        isEditing: true\n      }, _this.fillData);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"fillData\", function () {\n      var config = _this.props.review.jobBusinessJobRecommendationServiceConfig;\n      if (!config) return;\n      var outputPossibility = config.outputPossibility,\n          deliverDate = config.deliverDate,\n          postIncome = config.postIncome,\n          innerRemarks = config.innerRemarks,\n          isReviewed = config.isReviewed;\n      if (!isReviewed) return;\n\n      _this.props.form.setFieldsValue({\n        outputPossibility: outputPossibility ? outputPossibility.id : '',\n        postIncome: postIncome / 100,\n        innerRemarks: innerRemarks,\n        deliverDate: moment(deliverDate)\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickCancel\", function () {\n      _this.setState({\n        isEditing: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickConfirm\", function () {\n      _this.props.form.validateFieldsAndScroll(function (err, values) {\n        if (!err) {\n          _this.setState({\n            loading: true\n          });\n\n          _this.props.reviewSTService(_objectSpread({}, values, {\n            deliverDate: values.deliverDate.toDate()\n          })).then(function (result) {\n            if (result) {\n              _message.success('已成功修改审核结果');\n\n              _this.setState({\n                isEditing: false\n              });\n\n              _this.props.onSelectItem(result.data.serviceTicket);\n            }\n          }).finally(function () {\n            _this.setState({\n              loading: false\n            });\n          });\n        }\n      });\n    });\n\n    _this.state = {\n      isEditing: false,\n      loading: false\n    };\n    return _this;\n  }\n\n  _createClass(ReviewModule, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      // 修改选择的服务单\n      if (_JSON$stringify(this.props.review) !== _JSON$stringify(prevProps.review)) {\n        // 初始化\n        this.setState({\n          isEditing: false,\n          loading: false\n        });\n      }\n    } // 点击立即审核\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var getFieldDecorator = this.props.form.getFieldDecorator;\n      var review = this.props.review;\n      var _this$state = this.state,\n          isEditing = _this$state.isEditing,\n          loading = _this$state.loading;\n      if (!review) return null;\n      var config = review.jobBusinessJobRecommendationServiceConfig;\n      var isReviewed = config.isReviewed,\n          innerRemarks = config.innerRemarks,\n          reviewer = config.reviewer,\n          postIncome = config.postIncome,\n          outputPossibility = config.outputPossibility,\n          deliverDate = config.deliverDate;\n      return React.createElement(Wrapper, null, React.createElement(Header, null, React.createElement(HeaderTitle, null, \"\\u670D\\u52A1\\u5BA1\\u6838\\u7ED3\\u679C\"), !isEditing && React.createElement(_Button, {\n        type: isReviewed ? 'ghost' : 'primary',\n        onClick: this.onClickReview\n      }, isReviewed ? '修改审核结果' : '立即审核')), isEditing && React.createElement(React.Fragment, null, React.createElement(_Row, {\n        gutter: 24\n      }, React.createElement(_Col, {\n        span: 12\n      }, React.createElement(_Form.Item, {\n        label: \"\\u8F93\\u51FA\\u51E0\\u7387\",\n        colon: false\n      }, getFieldDecorator('outputPossibility', {\n        rules: NoEmptyOtherRule\n      })(React.createElement(ZhiWenSelect, {\n        type: \"job-business-match-degree\",\n        style: {\n          width: '100%'\n        }\n      })))), React.createElement(_Col, {\n        span: 12\n      }, React.createElement(_Form.Item, {\n        label: \"\\u9884\\u4F30\\u5F00\\u59CB\\u6295\\u9012\\u65F6\\u95F4\",\n        colon: false\n      }, getFieldDecorator('deliverDate', {\n        rules: NoEmptyOtherRule\n      })(React.createElement(_DatePicker, {\n        style: {\n          width: '100%'\n        }\n      }))))), React.createElement(_Row, {\n        gutter: 24\n      }, React.createElement(_Col, {\n        span: 12\n      }, React.createElement(_Form.Item, {\n        label: \"\\u540E\\u7F6E\\u6536\\u5165\\uFF08CNY\\uFF09\",\n        required: true,\n        colon: false\n      }, getFieldDecorator('postIncome', {\n        rules: RequiredPositiveIntegerRule\n      })(React.createElement(NumberInput, {\n        min: 1,\n        max: 1000000,\n        placeholder: \"\\u6B63\\u6574\\u6570\",\n        style: {\n          width: '100%'\n        }\n      })))), React.createElement(_Col, {\n        span: 12\n      }, React.createElement(_Form.Item, {\n        label: \"\\u5BF9\\u5185\\u5907\\u6CE8\",\n        colon: false\n      }, getFieldDecorator('innerRemarks')(React.createElement(_Input.TextArea, {\n        style: {\n          flex: 1\n        },\n        placeholder: \"\\u8BF7\\u8F93\\u5165\"\n      }))))), React.createElement(_Button, {\n        onClick: this.onClickCancel,\n        style: {\n          marginRight: '8px'\n        }\n      }, \"\\u53D6\\u6D88\"), React.createElement(_Button, {\n        type: \"primary\",\n        onClick: this.onClickConfirm,\n        loading: loading\n      }, \"\\u786E\\u8BA4\\u4FEE\\u6539\")), !isEditing && React.createElement(React.Fragment, null, React.createElement(Line, null, React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u5BA1\\u6838\\u72B6\\u6001\\uFF1A\"), React.createElement(ItemContent, null, React.createElement(ReviewStatus, {\n        isReviewed: isReviewed\n      }))), React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u8F93\\u51FA\\u51E0\\u7387\\uFF1A\"), React.createElement(ItemContent, null, outputPossibility ? outputPossibility.name : '- -'))), React.createElement(Line, null, React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u9884\\u4F30\\u5F00\\u59CB\\u6295\\u9012\\u65E5\\u671F\\uFF1A\"), React.createElement(ItemContent, null, dateText(deliverDate))), React.createElement(Item, null, React.createElement(ItemTitle, {\n        style: {\n          whiteSpace: 'pre'\n        }\n      }, \"\\u540E\\u7F6E\\u6536\\u5165\\uFF08CNY\\uFF09\\uFF1A\"), React.createElement(ItemContent, null, postIncome ? formatPrice(postIncome) : '- -'))), React.createElement(LineWithAccount, null, React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u5BF9\\u5185\\u5907\\u6CE8\\uFF1A\"), React.createElement(ItemContent, null, checkEmpty(innerRemarks))), React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u5BA1\\u6838\\u4EBA\\uFF1A\"), React.createElement(ItemContent, null, reviewer ? React.createElement(InlineAccountInfo, {\n        account: reviewer.account\n      }) : '- -')))));\n    }\n  }]);\n\n  return ReviewModule;\n}(Component);\n\nexport default _Form.create()(ReviewModule);","map":null,"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import \"antd/lib/popover/style\";\nimport _Popover from \"antd/lib/popover\";\nimport \"antd/lib/icon/style\";\nimport _Icon from \"antd/lib/icon\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/form/style\";\nimport _Form from \"antd/lib/form\";\nimport \"antd/lib/message/style\";\nimport _message from \"antd/lib/message\";\nimport _parseInt from \"@babel/runtime-corejs2/core-js/parse-int\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport Router from 'next/router';\nimport React, { Component } from 'react';\nimport styled from 'styled-components';\nimport NumberInput from '../../../../../components/Input/NumberInput';\nimport { NoEmptyOtherRule, RequiredPositiveIntegerRule } from '../../../../../lib/commonRule';\nimport { noNegativeIntegerReg } from '../../../../../lib/regexp';\nimport { formStyle, iconStyle, LabelWrapper, PopoverWrapper } from '../../../components/CSSComponents';\nimport BlockHeader from '../BlockHeader';\n\nvar EditPriceInfo =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(EditPriceInfo, _Component);\n\n  function EditPriceInfo(props) {\n    var _this;\n\n    _classCallCheck(this, EditPriceInfo);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(EditPriceInfo).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickSave\", function (e) {\n      e.preventDefault();\n\n      _this.props.form.validateFields(function (err, values) {\n        if (!err) {\n          var _this$props = _this.props,\n              updatePlan = _this$props.updatePlan,\n              switchEdit = _this$props.switchEdit;\n\n          _this.setState({\n            loading: true\n          });\n\n          updatePlan(_objectSpread({}, values, {\n            basePrice: _parseInt((values.basePrice * 100).toFixed(0), 10),\n            id: Router.query.id\n          })).then(function () {\n            _message.success('已保存');\n\n            switchEdit();\n          }).finally(function () {\n            _this.setState({\n              loading: false\n            });\n          });\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"checkInteger\", function (_rule, value, callback) {\n      if (value !== '' && value !== null && !noNegativeIntegerReg.test(value)) {\n        callback('请输入正整数');\n      }\n\n      callback();\n    });\n\n    _this.state = {\n      loading: false\n    };\n    return _this;\n  }\n\n  _createClass(EditPriceInfo, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var servicePlan = this.props.servicePlan;\n      var basePrice = servicePlan.basePrice,\n          prepayPercent = servicePlan.prepayPercent,\n          maxDelayDays = servicePlan.maxDelayDays;\n      this.props.form.setFieldsValue({\n        basePrice: basePrice && basePrice / 100,\n        prepayPercent: prepayPercent,\n        maxDelayDays: maxDelayDays\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props$form = this.props.form,\n          getFieldDecorator = _this$props$form.getFieldDecorator,\n          getFieldValue = _this$props$form.getFieldValue;\n      var switchEdit = this.props.switchEdit;\n      var price = getFieldValue('basePrice');\n      var percent = getFieldValue('prepayPercent');\n      var showPriceResult = Boolean(price && price !== '' && percent && percent !== '');\n      return React.createElement(React.Fragment, null, React.createElement(BlockHeader, {\n        title: \"\\u4EF7\\u683C\\u4FE1\\u606F\",\n        showBtn: false\n      }), React.createElement(_Form, {\n        style: formStyle\n      }, React.createElement(_Form.Item, {\n        label: \"\\u57FA\\u7840\\u4EF7\\u683C\\uFF08CNY\\uFF09\",\n        colon: false\n      }, getFieldDecorator('basePrice', {\n        rules: NoEmptyOtherRule\n      })(React.createElement(NumberInput, {\n        max: 1000000,\n        min: 1,\n        precision: 2,\n        placeholder: \"\\u652F\\u6301\\u5C0F\\u6570\\uFF0C\\u6700\\u59271000000\",\n        style: {\n          width: '100%'\n        }\n      }))), React.createElement(_Form.Item, {\n        label: PopoverLabel('预付款百分比', prepayPercentText, showPriceResult, price, percent),\n        colon: false\n      }, getFieldDecorator('prepayPercent', {\n        rules: RequiredPositiveIntegerRule\n      })(React.createElement(NumberInput, {\n        max: 100,\n        min: 1,\n        formatter: formatterPercent,\n        parser: parserPercent,\n        style: {\n          width: '100%'\n        }\n      }))), React.createElement(_Form.Item, {\n        colon: false,\n        label: PopoverLabel('尾款最多几天内付清？', maxDelayDaysText)\n      }, getFieldDecorator('maxDelayDays', {\n        rules: RequiredPositiveIntegerRule\n      })(React.createElement(NumberInput, {\n        max: 30,\n        min: 1,\n        placeholder: \"\\u6B63\\u6574\\u6570\\uFF0C\\u6700\\u592730\",\n        style: {\n          width: '90%',\n          marginRight: '8px'\n        }\n      })), React.createElement(\"span\", null, \"\\u5929\")), React.createElement(\"div\", null, React.createElement(_Button, {\n        onClick: switchEdit,\n        style: {\n          marginRight: 12\n        }\n      }, \"\\u53D6\\u6D88\"), React.createElement(_Button, {\n        type: \"primary\",\n        onClick: this.onClickSave,\n        loading: this.state.loading\n      }, \"\\u4FDD\\u5B58\"))));\n    }\n  }]);\n\n  return EditPriceInfo;\n}(Component);\n\nvar PrePriceLabel = styled.span.withConfig({\n  displayName: \"EditPriceInfo__PrePriceLabel\",\n  componentId: \"b1wn2o-0\"\n})([\"margin-left:8px;font-size:12px;color:#a2aabb;\"]);\n\nvar formatterPercent = function formatterPercent(value) {\n  return \"\".concat(value, \"%\");\n};\n\nvar parserPercent = function parserPercent(value) {\n  return value.replace('%', '');\n};\n\nexport var PopoverLabel = function PopoverLabel(labelText, contentText) {\n  var isShow = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var price = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n  var percent = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 100;\n  return React.createElement(LabelWrapper, null, React.createElement(\"label\", null, labelText), React.createElement(_Popover, {\n    style: {\n      fontSize: 14\n    },\n    placement: \"topLeft\",\n    content: React.createElement(\"div\", {\n      style: {\n        fontSize: 14,\n        width: 200\n      }\n    }, contentText)\n  }, React.createElement(_Icon, {\n    style: iconStyle,\n    type: \"exclamation-circle\"\n  })), isShow && React.createElement(PrePriceLabel, null, \"\\u9884\\u4ED8\\u6B3E\\u91D1\\u989D\\uFF1A\", (price * (percent / 100)).toFixed(2), \"\\u5143\"));\n};\nexport var prepayPercentText = React.createElement(PopoverWrapper, null, \"\\u2022\\u54A8\\u8BE2\\u65B9\\u6848\\u9884\\u4ED8\\u6B3E\\u91D1\\u989D = \\u57FA\\u7840\\u4EF7\\u683C * \\u9884\\u4ED8\\u6B3E\\u767E\\u5206\\u6BD4\", React.createElement(\"br\", null), React.createElement(\"br\", null), \"\\u2022\\u670D\\u52A1\\u5355\\u7684\\u9884\\u4ED8\\u6B3E\\u5982\\u5927\\u4E8E\\u7B49\\u4E8E\\u54A8\\u8BE2\\u65B9\\u6848\\u7684\\u9884\\u4ED8\\u6B3E\\uFF0C\\u5219\\u5B66\\u5458\\u53EF\\u6B63\\u5E38\\u9884\\u7EA6\\u89C4\\u5212\\u5E08\\u53CA\\u540E\\u7EED\\u7684\\u5B66\\u4E60\\u8BA1\\u5212\\u89C4\\u5212\\u670D\\u52A1\", React.createElement(\"br\", null), React.createElement(\"br\", null), \"\\u2022\\u670D\\u52A1\\u5355\\u7684\\u9884\\u4ED8\\u6B3E\\u5982\\u5C0F\\u4E8E\\u54A8\\u8BE2\\u65B9\\u6848\\u7684\\u9884\\u4ED8\\u6B3E\\uFF0C\\u5219\\u5B66\\u5458\\u65E0\\u6CD5\\u9884\\u7EA6\\u89C4\\u5212\\u5E08\\u53CA\\u540E\\u7EED\\u7684\\u5B66\\u4E60\\u8BA1\\u5212\\u89C4\\u5212\\u670D\\u52A1;\");\nexport var maxDelayDaysText = React.createElement(PopoverWrapper, null, \"\\u5982\\u8BBE\\u7F6E18\\u5929\\uFF0C\\u5219\\u670D\\u52A1\\u5355\\u4ED8\\u6E05\\u5C3E\\u6B3E\\u6700\\u8FDF\\u5929\\u6570\\u4E0D\\u53EF\\u5927\\u4E8E18\\u5929\\u3002\");\n\nvar EditPriceInfoForm = _Form.create()(EditPriceInfo);\n\nexport default EditPriceInfoForm;","map":null,"metadata":{},"sourceType":"module"}
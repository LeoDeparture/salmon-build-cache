{"ast":null,"code":"import \"antd/lib/icon/style\";\nimport _Icon from \"antd/lib/icon\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/tag/style\";\nimport _Tag from \"antd/lib/tag\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport { format } from 'date-fns';\nimport React, { Component } from 'react';\nimport { ApolloConsumer } from 'react-apollo';\nimport styled from 'styled-components';\nimport InlineAccountInfo from '../../../../components/InlineAccountInfo';\nimport { checkEmpty, dateText, priceText } from '../../../../lib/commonJs';\nimport { Item, ItemContent, ItemTitle, LineWrapper } from '../../../service/components/CSSComponents';\nimport { orderKindText, orderTypeText, totalPaymentAmount } from '../functions';\nimport { Line, LineWithAccount, RecordBlock, RecordContent, VerificationStatus } from './common';\nimport HistoryRecord from './HistoryRecord';\nimport ApproveModal from './modals/ApproveModal';\nimport RejectModal from './modals/RejectModal';\nimport Payment from './Payment';\n\nvar Record =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Record, _Component);\n\n  function Record(props) {\n    var _this;\n\n    _classCallCheck(this, Record);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Record).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"onRefApproveModal\", function (ref) {\n      _this.approveModal = ref;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onRefRefuseModal\", function (ref) {\n      _this.rejectModal = ref;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickApproveButton\", function () {\n      _this.approveModal.showPop();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickRejectButton\", function () {\n      _this.rejectModal.switchPop();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickSwitch\", function () {\n      _this.setState({\n        isShowHistory: !_this.state.isShowHistory\n      });\n    });\n\n    _this.state = {\n      isShowHistory: false\n    };\n    return _this;\n  }\n\n  _createClass(Record, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var order = this.props.order;\n      var isShowHistory = this.state.isShowHistory;\n      var id = order.id,\n          kind = order.kind,\n          type = order.type,\n          orderNo = order.orderNo,\n          verificationStatus = order.verificationStatus,\n          amountTotal = order.amountTotal,\n          onlinePayments = order.onlinePayments,\n          offlinePayments = order.offlinePayments,\n          submittedAt = order.submittedAt,\n          offlinePaymentHistories = order.offlinePaymentHistories,\n          serviceTicketId = order.serviceTicket.id,\n          verificationOperator = order.verificationOperator,\n          innerRemarks = order.innerRemarks,\n          verifiedAt = order.verifiedAt,\n          rejectReason = order.rejectReason; // typeKey 线上线下\n\n      var typeKey = type ? type.key : ''; // 付款类型\n\n      var kindText = orderKindText(kind);\n      var typeText = orderTypeText(typeKey); // 线下订单, 且有历史记录, 显示历史开关\n\n      var isShowSwitch = typeKey === 'OFFLINE' && !!offlinePaymentHistories.length; // 线上或线下的 payments\n\n      var payments = typeKey === 'OFFLINE' ? offlinePayments : onlinePayments; // 线上\n\n      if (typeKey === 'ONLINE') {\n        return React.createElement(Wrapper, null, React.createElement(DetailHead, null, React.createElement(\"div\", {\n          className: \"head-title\"\n        }, React.createElement(\"span\", {\n          className: \"title\"\n        }, kindText), typeText && React.createElement(_Tag, {\n          color: \"#A2AAB8\"\n        }, typeText))), React.createElement(OnlineRecordWrapper, null, React.createElement(OnlineRecordHead, null, React.createElement(Line, null, React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u5E94\\u4ED8\\u603B\\u91D1\\u989D\\uFF08CNY)\\uFF1A\"), React.createElement(ItemContent, null, priceText(amountTotal))), orderNo && React.createElement(LineWrapper, null, React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u4E3B\\u5355\\u53F7\\uFF1A\"), React.createElement(ItemContent, null, orderNo))))), payments.map(function (payment, index) {\n          return React.createElement(OnlineRecordBlock, {\n            key: index\n          }, React.createElement(LineWrapper, null, React.createElement(BlockTitle, null, \"\\u652F\\u4ED8\\u8BB0\\u5F55\", payments.length - index)), React.createElement(Payment, {\n            payment: payment,\n            typeKey: typeKey\n          }));\n        })));\n      } // 线下\n\n\n      if (typeKey === 'OFFLINE') {\n        return React.createElement(Wrapper, null, React.createElement(DetailHead, null, React.createElement(\"div\", {\n          className: \"head-title\"\n        }, React.createElement(\"span\", {\n          className: \"title\"\n        }, kindText), typeText && React.createElement(_Tag, {\n          color: \"#A2AAB8\"\n        }, typeText))), orderNo && React.createElement(LineWrapper, null, React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u4E3B\\u5355\\u53F7\\uFF1A\"), React.createElement(ItemContent, null, orderNo))), React.createElement(RecordWrapper, null, React.createElement(RecordHead, null, verificationStatus && verificationStatus.key === 'CHECKING' && React.createElement(ButtonWrapper, null, React.createElement(_Button, {\n          type: \"primary\",\n          onClick: this.onClickApproveButton\n        }, \"\\u901A\\u8FC7\\u6838\\u67E5\"), React.createElement(_Button, {\n          onClick: this.onClickRejectButton,\n          style: {\n            marginLeft: '14px',\n            color: '#FF5230'\n          }\n        }, \"\\u62D2\\u7EDD\")), React.createElement(LineWithAccount, null, React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u63D0\\u4EA4\\u6838\\u67E5\\u65F6\\u95F4\\uFF1A\"), React.createElement(ItemContent, null, dateText(submittedAt, 'min'))), React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u6838\\u67E5\\u72B6\\u6001\\uFF1A\"), React.createElement(ItemContent, null, React.createElement(VerificationStatus, {\n          status: verificationStatus\n        })))), React.createElement(Line, null, React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u5E94\\u4ED8\\u603B\\u91D1\\u989D\\uFF08CNY)\\uFF1A\"), React.createElement(ItemContent, null, priceText(amountTotal))), React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u603B\\u4EA4\\u6613\\u91D1\\u989D\\uFF08CNY)\\uFF1A\"), React.createElement(ItemContent, null, totalPaymentAmount(payments)))), verificationStatus && verificationStatus.key === 'APPROVED' && React.createElement(LineWrapper, null, React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u5BF9\\u5185\\u5907\\u6CE8\\uFF1A\"), React.createElement(ItemContent, null, checkEmpty(innerRemarks)))), verificationStatus && verificationStatus.key === 'REJECTED' && React.createElement(LineWrapper, null, React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u62D2\\u7EDD\\u539F\\u56E0\\uFF1A\"), React.createElement(ItemContent, null, checkEmpty(rejectReason)))), verificationStatus && verificationStatus.key !== 'CHECKING' && React.createElement(React.Fragment, null, React.createElement(LineWithAccount, null, React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u6838\\u67E5\\u64CD\\u4F5C\\u4EBA\\uFF1A\"), React.createElement(ItemContent, null, React.createElement(InlineAccountInfo, {\n          account: verificationOperator && verificationOperator.account\n        })))), React.createElement(Line, null, React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u6838\\u67E5\\u65F6\\u95F4\\uFF1A\"), React.createElement(ItemContent, null, verifiedAt ? format(verifiedAt, 'YYYY/MM/DD HH:mm') : '- -'))))), React.createElement(RecordContent, null, payments.map(function (payment, index) {\n          return React.createElement(RecordBlock, {\n            key: index\n          }, React.createElement(LineWrapper, null, React.createElement(BlockTitle, null, \"\\u652F\\u4ED8\\u8BB0\\u5F55\", index + 1)), React.createElement(Payment, {\n            payment: payment,\n            typeKey: typeKey\n          }));\n        }))), isShowHistory && offlinePaymentHistories.map(function (history, index) {\n          return React.createElement(HistoryRecord, {\n            key: index,\n            history: history\n          });\n        }), isShowSwitch && React.createElement(Switch, null, React.createElement(\"a\", {\n          onClick: this.onClickSwitch\n        }, \"\".concat(isShowHistory ? '收起' : '展开', \"\\u63D0\\u4EA4\\u5386\\u53F2\"), React.createElement(_Icon, {\n          style: {\n            marginLeft: '4px',\n            fontSize: '12px'\n          },\n          type: isShowHistory ? 'up' : 'down'\n        }))), React.createElement(ApolloConsumer, null, function (client) {\n          return React.createElement(React.Fragment, null, React.createElement(ApproveModal, {\n            onRef: _this2.onRefApproveModal,\n            payments: payments,\n            amountTotal: amountTotal,\n            client: client,\n            orderId: id,\n            serviceTicketId: serviceTicketId\n          }), React.createElement(RejectModal, {\n            onRef: _this2.onRefRefuseModal,\n            client: client,\n            orderId: id,\n            serviceTicketId: serviceTicketId\n          }));\n        }));\n      }\n\n      return null;\n    }\n  }]);\n\n  return Record;\n}(Component);\n\nexport { Record as default };\nvar Wrapper = styled.div.withConfig({\n  displayName: \"Record__Wrapper\",\n  componentId: \"sc-1rg52lk-0\"\n})([\"margin-bottom:32px;&:last-child{margin-bottom:0;}\"]);\nvar Switch = styled.div.withConfig({\n  displayName: \"Record__Switch\",\n  componentId: \"sc-1rg52lk-1\"\n})([\"margin:16px 0;font-size:14px;line-height:22px;text-align:center;\"]);\nvar DetailHead = styled.div.withConfig({\n  displayName: \"Record__DetailHead\",\n  componentId: \"sc-1rg52lk-2\"\n})([\".head-title{margin-bottom:1em;font-size:16px;line-height:24px;color:#172b4d;.title{margin-right:8px;font-weight:bold;}}\"]);\nvar OnlineRecordWrapper = styled.div.withConfig({\n  displayName: \"Record__OnlineRecordWrapper\",\n  componentId: \"sc-1rg52lk-3\"\n})([\"margin-top:16px;\"]);\nvar OnlineRecordHead = styled.div.withConfig({\n  displayName: \"Record__OnlineRecordHead\",\n  componentId: \"sc-1rg52lk-4\"\n})([\"padding:0 0 24px 0;\"]);\nvar OnlineRecordBlock = styled.div.withConfig({\n  displayName: \"Record__OnlineRecordBlock\",\n  componentId: \"sc-1rg52lk-5\"\n})([\"padding:16px 0;border-top:1px solid #e1e1e8;\"]);\nexport var RecordWrapper = styled.div.withConfig({\n  displayName: \"Record__RecordWrapper\",\n  componentId: \"sc-1rg52lk-6\"\n})([\"margin-top:16px;border:1px solid #e1e1e8;border-radius:2px;\"]);\nexport var RecordHead = styled.div.withConfig({\n  displayName: \"Record__RecordHead\",\n  componentId: \"sc-1rg52lk-7\"\n})([\"position:relative;padding:16px 24px;background-color:#f7f8f9;border-radius:2px 2px 0 0;\"]);\nvar ButtonWrapper = styled.div.withConfig({\n  displayName: \"Record__ButtonWrapper\",\n  componentId: \"sc-1rg52lk-8\"\n})([\"position:absolute;top:16px;right:24px;z-index:1;\"]);\nexport var BlockTitle = styled.span.withConfig({\n  displayName: \"Record__BlockTitle\",\n  componentId: \"sc-1rg52lk-9\"\n})([\"font-size:16px;color:#172b4d;\"]);","map":null,"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport React from 'react';\nimport styled from 'styled-components';\nimport DifferenceItem from './DifferenceItem';\n\nvar Container =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Container, _React$Component);\n\n  function Container(props) {\n    var _this;\n\n    _classCallCheck(this, Container);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Container).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"itemNextRef\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"itemUpRef\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"bindNextRef\", function (ref) {\n      _this.itemNextRef = ref;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"bindUpRef\", function (ref) {\n      _this.itemUpRef = ref;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"componentDidMount\", function () {\n      var baseLevelId = '';\n      var baseData = _this.props.baseData;\n      baseData.forEach(function (item) {\n        if (item.price === 0) {\n          baseLevelId = item.companyLevel.id;\n        }\n      });\n\n      _this.setState({\n        newData: [{\n          companyLevelId: baseLevelId,\n          price: 0\n        }],\n        baseLevelId: baseLevelId\n      }, function () {\n        _this.props.onChangeValue(_this.state.newData);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"resetList\", function () {\n      _this.setState({\n        newData: [{\n          companyLevelId: _this.state.baseLevelId,\n          price: 0\n        }],\n        resetList: _this.state.resetList + 1\n      }, function () {\n        if (_this.itemNextRef) {\n          _this.itemNextRef.resetState();\n        }\n\n        if (_this.itemUpRef) {\n          _this.itemUpRef.resetState();\n        }\n\n        _this.props.onChangeValue(_this.state.newData);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"ItemChange\", function (data) {\n      var arr = _this.state.newData;\n      var hasOld = false;\n      arr.forEach(function (item) {\n        if (item.companyLevelId === data.companyLevelId) {\n          hasOld = true;\n          item.price = data.price;\n        }\n      });\n\n      if (hasOld) {\n        _this.setState({\n          newData: arr\n        }, function () {\n          _this.props.onChangeValue(_this.state.newData);\n        });\n      } else {\n        _this.setState({\n          newData: _this.state.newData.concat(data)\n        }, function () {\n          _this.props.onChangeValue(_this.state.newData);\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"useNewData\", function (arr, newData) {\n      var index = arr.findIndex(function (item) {\n        return item.companyLevelId === newData.companyLevelId;\n      });\n      return [].concat(_toConsumableArray(arr.slice(0, index)), [_objectSpread({}, arr[index], {\n        companyLevelId: newData.companyLevelId,\n        price: newData.price\n      })], _toConsumableArray(arr.slice(index + 1)));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"objFn\", function (obj) {\n      return obj.id === _this.state.baseLevelId;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"objFn2\", function (data) {\n      var result = false;\n\n      _this.state.newData.forEach(function (item) {\n        if (data.id === item.companyLevelId) {\n          result = true;\n        }\n      });\n\n      return result;\n    });\n\n    _this.state = {\n      newData: _this.props.data || [],\n      resetList: 0,\n      baseLevelId: ''\n    };\n    return _this;\n  }\n\n  _createClass(Container, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var initData = this.props.initData;\n      var _this$state = this.state,\n          newData = _this$state.newData,\n          baseLevelId = _this$state.baseLevelId,\n          resetList = _this$state.resetList;\n      return React.createElement(React.Fragment, null, newData.length > 1 ? React.createElement(ResetText, {\n        onClick: this.resetList\n      }, \"\\u91CD\\u7F6E\") : null, baseLevelId === '' ? React.createElement(DefaultText, null, \"\\u8BF7\\u5148\\u9009\\u62E9\\u76EE\\u6807\\u516C\\u53F8\\u7B49\\u7EA7\") : React.createElement(DifferenceContainer, null, React.createElement(DifferenceLine, null), React.createElement(ItemsContainer, null, initData.map(function (data, index) {\n        if (data.id === baseLevelId) {\n          return React.createElement(DifferenceItem, {\n            key: \"\".concat(data.id).concat(resetList),\n            id: data.id,\n            level: data.name,\n            isChoose: true,\n            onChangeValue: _this2.ItemChange\n          });\n        }\n\n        if (initData[index - 1] && _this2.objFn2(initData[index - 1]) && index > initData.findIndex(_this2.objFn)) {\n          return React.createElement(DifferenceItem, {\n            key: \"\".concat(data.id).concat(resetList),\n            onRef: _this2.bindUpRef,\n            id: data.id,\n            level: data.name,\n            isAdd: true,\n            initPrice: _this2.props.baseData.find(function (item) {\n              return item.companyLevel.id === data.id;\n            }).price,\n            onChangeValue: _this2.ItemChange\n          });\n        }\n\n        if (initData[index + 1] && _this2.objFn2(initData[index + 1])) {\n          return React.createElement(DifferenceItem, {\n            key: \"\".concat(data.id).concat(resetList),\n            id: data.id,\n            onRef: _this2.bindNextRef,\n            level: data.name,\n            isAdd: false,\n            initPrice: _this2.props.baseData.find(function (item) {\n              return item.companyLevel.id === data.id;\n            }).price,\n            onChangeValue: _this2.ItemChange\n          });\n        }\n\n        if (_this2.props.initData.findIndex(_this2.objFn) + 1 === index) {\n          return React.createElement(DifferenceItem, {\n            key: \"\".concat(data.id).concat(resetList),\n            id: data.id,\n            level: data.name,\n            isAdd: true,\n            onChangeValue: _this2.ItemChange\n          });\n        }\n\n        if (_this2.props.initData.findIndex(_this2.objFn) - 1 === index) {\n          return React.createElement(DifferenceItem, {\n            key: \"\".concat(data.id).concat(resetList),\n            id: data.id,\n            level: data.name,\n            isAdd: false,\n            onChangeValue: _this2.ItemChange\n          });\n        }\n\n        return React.createElement(DifferenceItem, {\n          key: \"\".concat(data.id).concat(resetList),\n          id: data.id,\n          level: data.name,\n          noOperation: true,\n          onChangeValue: _this2.ItemChange\n        });\n      }))));\n    }\n  }]);\n\n  return Container;\n}(React.Component);\n\nexport { Container as default };\nvar DefaultText = styled.p.withConfig({\n  displayName: \"Container__DefaultText\",\n  componentId: \"sc-1d2rqpv-0\"\n})([\"width:100%;font-size:12px;line-height:18px;color:#a2aab8;text-align:center;\"]);\nvar DifferenceContainer = styled.div.withConfig({\n  displayName: \"Container__DifferenceContainer\",\n  componentId: \"sc-1d2rqpv-1\"\n})([\"position:relative;z-index:2;width:100%;height:46px;\"]);\nvar DifferenceLine = styled.div.withConfig({\n  displayName: \"Container__DifferenceLine\",\n  componentId: \"sc-1d2rqpv-2\"\n})([\"position:absolute;bottom:11px;z-index:1;width:100%;height:2px;background:#e1e1e8;\"]);\nvar ItemsContainer = styled.div.withConfig({\n  displayName: \"Container__ItemsContainer\",\n  componentId: \"sc-1d2rqpv-3\"\n})([\"z-index:3;display:flex;flex-direction:row;justify-content:center;width:100%;height:100%;\"]);\nvar ResetText = styled.div.withConfig({\n  displayName: \"Container__ResetText\",\n  componentId: \"sc-1d2rqpv-4\"\n})([\"position:absolute;top:8px;right:12px;width:24px;height:18px;font-size:12px;line-height:18px;color:#5674bf;cursor:pointer;\"]);","map":null,"metadata":{},"sourceType":"module"}
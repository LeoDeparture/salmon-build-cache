{"ast":null,"code":"import \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport \"antd/lib/tag/style\";\nimport _Tag from \"antd/lib/tag\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport React, { Component } from 'react';\nimport InlineAccountInfo from '../../../../../components/InlineAccountInfo';\nimport { breakLine, checkEmpty, dateText, priceText } from '../../../../../lib/commonJs';\nimport { Item, ItemContent, ItemTitle } from '../../../../service/components/CSSComponents';\nimport { Line, LineWithAccount, RecordBlock } from '../common';\nimport File from '../File';\nimport { ModalContent, SubtitleText, TitleText } from './ApproveModal';\n\nvar HistoryModal =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(HistoryModal, _Component);\n\n  function HistoryModal(props) {\n    var _this;\n\n    _classCallCheck(this, HistoryModal);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(HistoryModal).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"switchPop\", function () {\n      _this.setState(function (state) {\n        return {\n          visible: !state.visible\n        };\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"refundTagText\", function (total, actualPrice) {\n      if (total > actualPrice) {\n        return '超额退款';\n      }\n\n      if (total === actualPrice) {\n        return '全额退款';\n      }\n\n      if (total < actualPrice) {\n        return '部分退款';\n      }\n\n      return '';\n    });\n\n    _this.state = {\n      visible: false\n    };\n    return _this;\n  }\n\n  _createClass(HistoryModal, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.props.onRef(this);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var visible = this.state.visible;\n      var _this$props = this.props,\n          refundInfo = _this$props.refundInfo,\n          serviceTicketLink = _this$props.serviceTicketLink,\n          actualPrice = _this$props.actualPrice; // 计算所有退款额度总和\n\n      var amounts = refundInfo.map(function (info) {\n        return info.amount || 0;\n      });\n      var totalAmount;\n\n      if (amounts && !!amounts.length) {\n        totalAmount = amounts.reduce(function (total, amount) {\n          return total + amount;\n        });\n      }\n\n      var title = React.createElement(React.Fragment, null, React.createElement(TitleText, null, \"\\u9000\\u6B3E\\u5386\\u53F2\", totalAmount && React.createElement(_Tag, {\n        color: \"#A2AAB8\",\n        style: tagStyle\n      }, this.refundTagText(totalAmount, actualPrice))), React.createElement(SubtitleText, null, \"\\u4EE5\\u4E0B\\u4E3A\\u670D\\u52A1\\u5355\", React.createElement(\"span\", null, \" \", serviceTicketLink, \" \"), \"\\u7684\\u6240\\u6709\\u9000\\u6B3E\\u5386\\u53F2\\u8BB0\\u5F55\\u3002\", React.createElement(\"span\", {\n        style: {\n          float: 'right'\n        }\n      }, \"\\u670D\\u52A1\\u5355\\u603B\\u4EF7\\uFF08CNY\\uFF09\\uFF1A\", React.createElement(\"span\", {\n        style: {\n          color: '#172B4D'\n        }\n      }, priceText(actualPrice)))));\n      return React.createElement(React.Fragment, null, React.createElement(\"style\", null, \"\\n            .ant-modal-body {\\n              padding: 0;\\n            }\\n            .ant-btn-primary,\\n            .ant-btn-primary:hover {\\n              background-color: #42526e;\\n              border-color: #42526e;\\n            }\\n          \"), React.createElement(_Modal, {\n        title: title,\n        visible: visible,\n        closable: false,\n        maskClosable: false,\n        width: 720,\n        onOk: this.switchPop,\n        onCancel: this.switchPop,\n        okText: \"\\u6211\\u77E5\\u9053\\u4E86\",\n        cancelButtonProps: {\n          style: {\n            display: 'none'\n          }\n        }\n      }, React.createElement(ModalContent, {\n        style: {\n          padding: '8px 24px'\n        }\n      }, refundInfo.map(function (info, index) {\n        var amount = info.amount,\n            reason = info.reason,\n            refundCredential = info.refundCredential,\n            refundDate = info.refundDate,\n            refundedOperator = info.refundedOperator;\n        return React.createElement(RecordBlock, {\n          key: index\n        }, React.createElement(Line, null, React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u9000\\u6B3E\\u91D1\\u989D\\uFF08CNY\\uFF09\\uFF1A\"), React.createElement(ItemContent, null, priceText(amount)))), React.createElement(Line, null, React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u9000\\u6B3E\\u7406\\u7531\\uFF1A\"), React.createElement(ItemContent, null, breakLine(checkEmpty(reason))))), React.createElement(Line, null, React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u9000\\u6B3E\\u51ED\\u8BC1\\uFF1A\"), React.createElement(ItemContent, null, refundCredential ? React.createElement(File, {\n          fileLink: refundCredential\n        }) : '- -'))), React.createElement(LineWithAccount, null, React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u9000\\u6B3E\\u64CD\\u4F5C\\u4EBA\\uFF1A\"), React.createElement(ItemContent, null, React.createElement(InlineAccountInfo, {\n          account: refundedOperator && refundedOperator.account\n        })))), React.createElement(Line, null, React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u9000\\u6B3E\\u65E5\\u671F\\uFF1A\"), React.createElement(ItemContent, null, dateText(refundDate)))));\n      }))));\n    }\n  }]);\n\n  return HistoryModal;\n}(Component);\n\nexport { HistoryModal as default };\nvar tagStyle = {\n  marginLeft: '12px',\n  fontWeight: 'normal'\n};","map":null,"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import \"antd/lib/config-provider/style\";\nimport _ConfigProvider from \"antd/lib/config-provider\";\nimport \"antd/lib/table/style\";\nimport _Table from \"antd/lib/table\";\nimport \"antd/lib/badge/style\";\nimport _Badge from \"antd/lib/badge\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport \"antd/lib/dropdown/style\";\nimport _Dropdown from \"antd/lib/dropdown\";\nimport \"antd/lib/icon/style\";\nimport _Icon from \"antd/lib/icon\";\nimport \"antd/lib/menu/style\";\nimport _Menu from \"antd/lib/menu\";\nimport \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport Link from 'next/link';\nimport React from 'react';\nimport styled from 'styled-components';\nimport EmptyComponents from '../../../../components/Empty';\n\nvar RoleTable =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(RoleTable, _React$Component);\n\n  function RoleTable() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, RoleTable);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(RoleTable)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"showSecondAlert\", function (action, numberOfAccountRole, onOk) {\n      _Modal.confirm({\n        cancelText: '取消',\n        centered: true,\n        content: React.createElement(\"p\", null, \"\\u76EE\\u524D\\u6709\", React.createElement(\"span\", {\n          style: {\n            color: '#f9a862'\n          }\n        }, \" \", numberOfAccountRole, \" \"), \"\\u4E2A\\u8D26\\u53F7\\u914D\\u5907\\u4E86\\u6B64\\u89D2\\u8272\\uFF0C\\u4E00\\u65E6\", action, \"\\u6B64\\u89D2\\u8272\\uFF0C\\u8FD9\\u4E9B\\u8D26\\u53F7\\u540C\\u65F6\\u5C06\\u4E00\\u5E76\", action, \"\\u3002\\u60A8\\u53EF\\u4EE5\\u5173\\u95ED\\u6B64\\u7A97\\u53E3\\uFF0C\\u524D\\u5F80\\u8D26\\u53F7\\u7BA1\\u7406\\u9875\\u9762\\uFF0C\\u67E5\\u770B\\u914D\\u5907\\u6B64\\u89D2\\u8272\\u7684\\u8D26\\u53F7\\u3002\"),\n        icon: 'exclamation-circle',\n        okText: \"\\u786E\\u8BA4\".concat(action),\n        okType: 'primary',\n        onOk: onOk,\n        title: \"\".concat(action, \"\\u6B64\\u89D2\\u8272\")\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"countAccountRole\", function (id) {\n      var roles = _this.props.roles;\n      var filteredRole = roles.filter(function (v) {\n        return v.id === id;\n      });\n\n      if (filteredRole.length) {\n        return filteredRole[0].accountRoles.length;\n      }\n\n      return 0;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderOperation\", function (_, record) {\n      var action = record.enabled ? '停用' : '启用';\n      var id = record.id;\n      var menu = React.createElement(_Menu, null, React.createElement(_Menu.Item, null, React.createElement(Link, {\n        href: \"/edit-role/\".concat(id)\n      }, React.createElement(\"span\", null, \"\\u7F16\\u8F91\\u6743\\u9650\"))), React.createElement(_Menu.Item, null, React.createElement(\"a\", {\n        style: {\n          color: 'red'\n        },\n        onClick: _this.showAlert.bind(_assertThisInitialized(_this), id, '删除')\n      }, \"\\u5220\\u9664\")));\n      return React.createElement(OperationWrapper, null, React.createElement(Link, {\n        href: \"/roles/\".concat(id)\n      }, React.createElement(\"a\", null, \"\\u67E5\\u770B\\u8BE6\\u60C5\")), React.createElement(\"a\", {\n        onClick: _this.showAlert.bind(_assertThisInitialized(_this), id, action)\n      }, action), React.createElement(_Dropdown, {\n        overlay: menu\n      }, React.createElement(\"a\", null, \"\\u9009\\u62E9\\u64CD\\u4F5C\", React.createElement(_Icon, {\n        style: {\n          marginLeft: '2px'\n        },\n        type: \"down\"\n      }))));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"formatData\", function (data) {\n      return data.map(function (item) {\n        return _objectSpread({}, item, {\n          key: item.id\n        });\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(RoleTable, [{\n    key: \"showAlert\",\n    // 显示确认弹窗\n    value: function showAlert(id, action) {\n      var updateRole = this.props.updateRole;\n      var onOk = updateRole.bind(this, id, action); // 如果角色绑定账号, 显示二次确认弹窗\n\n      var numberOfAccountRole = this.countAccountRole(id);\n\n      if (numberOfAccountRole > 0) {\n        onOk = this.showSecondAlert.bind(this, action, numberOfAccountRole, onOk);\n      }\n\n      _Modal.confirm({\n        title: \"\\u786E\\u5B9A\\u8981\".concat(action, \"\\u6B64\\u89D2\\u8272\\u5417\\uFF1F\"),\n        icon: 'exclamation-circle',\n        centered: true,\n        content: React.createElement(\"p\", null, action === '删除' ? '此操作无法撤回，请谨慎操作' : ''),\n        okType: action === '删除' ? 'danger' : 'primary',\n        okText: \"\\u786E\\u8BA4\".concat(action),\n        onOk: onOk,\n        cancelText: '取消'\n      });\n    } // 渲染[操作]列\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          roles = _this$props.roles,\n          footer = _this$props.footer;\n      var data = this.formatData(roles);\n      var columns = [{\n        dataIndex: 'name',\n        key: 'name',\n        title: '角色名称',\n        width: '57%'\n      }, {\n        dataIndex: 'enabled',\n        key: 'enabled',\n        title: '角色状态',\n        width: '16%',\n        render: function render(enabled) {\n          return React.createElement(_Badge, {\n            status: enabled ? 'success' : 'default',\n            text: enabled ? '正常' : '已停用'\n          });\n        }\n      }, {\n        dataIndex: 'operating',\n        key: 'operating',\n        render: this.renderOperation,\n        title: '操作',\n        width: '27%'\n      }];\n\n      var Empty = function Empty() {\n        return React.createElement(EmptyComponents, null);\n      };\n\n      return React.createElement(_ConfigProvider, {\n        renderEmpty: Empty\n      }, React.createElement(_Table, {\n        columns: columns,\n        style: {\n          flex: 1\n        },\n        dataSource: data,\n        pagination: false,\n        bordered: false,\n        footer: data.length ? footer : null\n      }));\n    }\n  }]);\n\n  return RoleTable;\n}(React.Component);\n\nexport default RoleTable;\nvar OperationWrapper = styled.div.withConfig({\n  displayName: \"RoleTable__OperationWrapper\",\n  componentId: \"vaocvj-0\"\n})([\"a{margin-right:16px;&:last-child{margin-right:0;}}\"]);","map":null,"metadata":{},"sourceType":"module"}
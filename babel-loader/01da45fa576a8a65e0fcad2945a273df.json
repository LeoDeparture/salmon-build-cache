{"ast":null,"code":"import \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/row/style\";\nimport _Row from \"antd/lib/row\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nimport \"antd/lib/col/style\";\nimport _Col from \"antd/lib/col\";\nimport \"antd/lib/radio/style\";\nimport _Radio from \"antd/lib/radio\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"antd/lib/form/style\";\nimport _Form from \"antd/lib/form\";\nimport RadioGroup from 'antd/lib/radio/group';\nimport React from 'react';\nimport styled from 'styled-components';\nimport ZhiWenCascader from '../../../../components/SelectComponents/ZhiWenCascader';\nimport { FlexDisplay, FlexDisplayCenterV } from '../../../../lib/commonCss';\nvar FormItem = _Form.Item;\nvar Warp = styled(FlexDisplay).withConfig({\n  displayName: \"EditCompetition__Warp\",\n  componentId: \"sc-1p4r92j-0\"\n})([\"width:100%;background:#fff;\"]);\n\nvar RegistrationForm =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(RegistrationForm, _React$Component);\n\n  function RegistrationForm() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, RegistrationForm);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(RegistrationForm)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"competitionProject\", true);\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      competition: 0,\n      isAwarded: 1,\n      loading: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"radioGroupChange\", function (disableName, e) {\n      var setFieldsValue = _this.props.form.setFieldsValue;\n\n      if (e.target.value === 0) {\n        setFieldsValue({\n          otherRace: undefined\n        });\n      } else {\n        setFieldsValue({\n          raceId: undefined\n        });\n      }\n\n      _this.setState(_defineProperty({}, disableName, e.target.value));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"changeRadio\", function (e) {\n      _this.setState({\n        isAwarded: e.target.value\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"validator\", function (_rule, _value, callback) {\n      var competition = _this.state.competition;\n      var getFieldValue = _this.props.form.getFieldValue;\n      var raceId = getFieldValue('raceId');\n      var otherRace = getFieldValue('otherRace');\n\n      if (competition === 0 && !otherRace && (!raceId || raceId === '')) {\n        callback(\"\\u6BD4\\u8D5B\\u9879\\u76EE\\u5B57\\u6BB5\\u4E0D\\u53EF\\u4E3A\\u7A7A\\uFF0C\\u8BF7\\u5728\\u6BD4\\u8D5B\\u9879\\u76EE\\u6216\\u5176\\u4ED6\\u4E2D\\u9009\\u586B\\u4E00\\u9879\");\n      }\n\n      if (competition === 1 && (!otherRace || otherRace === '') && !raceId) {\n        callback(\"\\u6BD4\\u8D5B\\u9879\\u76EE\\u4E0D\\u53EF\\u4E3A\\u7A7A\\uFF0C\\u8BF7\\u5728\\u6BD4\\u8D5B\\u9879\\u76EE\\u6216\\u5176\\u4ED6\\u4E2D\\u9009\\u586B\\u4E00\\u9879w\");\n      }\n\n      callback();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"otherRaceValidator\", function (_rule, _value, callback) {\n      var validateFields = _this.props.form.validateFields;\n      validateFields(['raceId'], {\n        force: true\n      }, function () {\n        return;\n      });\n      callback();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSubmit\", function (e) {\n      _this.setState({\n        loading: true\n      });\n\n      e.preventDefault();\n\n      _this.props.form.validateFieldsAndScroll(function (err, values) {\n        var _this$props = _this.props,\n            type = _this$props.type,\n            createCompetitionEx = _this$props.createCompetitionEx,\n            updateCompetitionEx = _this$props.updateCompetitionEx,\n            competitionExperiences = _this$props.competitionExperiences;\n\n        if (!err) {\n          var raceId = values.raceId,\n              isAwarded = values.isAwarded;\n          values.id = competitionExperiences && competitionExperiences.id;\n          values.raceId = raceId && raceId[raceId.length - 1];\n          values.isAwarded = !Boolean(isAwarded);\n\n          if (type === 'add') {\n            createCompetitionEx(values).then(function (success) {\n              if (success) {\n                _this.props.changeState('competition', false);\n              }\n\n              _this.setState({\n                loading: false\n              });\n            });\n          } else {\n            updateCompetitionEx(values).then(function (updateSuccess) {\n              if (updateSuccess) {\n                _this.props.changeState('edit', false);\n              }\n\n              _this.setState({\n                loading: false\n              });\n            });\n          }\n        } else {\n          _this.setState({\n            loading: false\n          });\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleCancel\", function () {\n      _this.props.type === 'add' ? _this.props.changeState('competition', false) : _this.props.changeState('edit', false);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"componentDidMount\", function () {\n      var setFieldsValue = _this.props.form.setFieldsValue;\n      var _this$props2 = _this.props,\n          type = _this$props2.type,\n          competitionExperiences = _this$props2.competitionExperiences;\n\n      if (type === 'edit') {\n        var content = competitionExperiences.content,\n            isAwarded = competitionExperiences.isAwarded,\n            otherRace = competitionExperiences.otherRace,\n            race = competitionExperiences.race;\n\n        _this.setState({\n          isAwarded: isAwarded ? 0 : 1,\n          competition: race && race.id ? 0 : 1\n        }, function () {\n          setFieldsValue({\n            content: content,\n            otherRace: otherRace,\n            isAwarded: isAwarded ? 0 : 1,\n            raceId: race && [race.parent.id, race.id]\n          });\n        });\n\n        return;\n      }\n\n      setFieldsValue({\n        isAwarded: 1\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getValue\", function (type, values) {\n      _this.props.form.setFieldsValue(_defineProperty({}, type, values));\n    });\n\n    return _this;\n  }\n\n  _createClass(RegistrationForm, [{\n    key: \"render\",\n    value: function render() {\n      var getFieldDecorator = this.props.form.getFieldDecorator;\n      var _this$props3 = this.props,\n          type = _this$props3.type,\n          competitionExperiences = _this$props3.competitionExperiences;\n\n      if (type === 'edit') {\n        this.competitionProject = !!competitionExperiences.race;\n      }\n\n      var index = this.props.index;\n      return React.createElement(Warp, null, React.createElement(_Form, {\n        onSubmit: this.handleSubmit,\n        style: {\n          width: '100%'\n        }\n      }, React.createElement(\"h4\", {\n        style: {\n          color: '#BFBFBF'\n        }\n      }, \"\\u53C2\\u8D5B\\u7ECF\\u5386\".concat(index || '')), React.createElement(_Row, null, React.createElement(_Col, {\n        span: 24\n      }, React.createElement(RadioGroup, {\n        style: {\n          width: '100%'\n        },\n        defaultValue: this.competitionProject ? 0 : 1,\n        onChange: this.radioGroupChange.bind(this, 'competition')\n      }, React.createElement(_Col, {\n        span: 24\n      }, React.createElement(_Col, {\n        span: 10\n      }, React.createElement(Label, {\n        className: \"ant-form-item-required\",\n        title: \"\\u6BD4\\u8D5B\\u9879\\u76EE\"\n      }, \"\\u6BD4\\u8D5B\\u9879\\u76EE\"), React.createElement(FormItem, {\n        colon: false\n      }, React.createElement(FlexDisplayCenterV, null, React.createElement(_Radio, {\n        value: 0\n      }), React.createElement(SelectTitle, null, \"\\u6BD4\\u8D5B\\u9879\\u76EE\"), getFieldDecorator('raceId', {\n        validateFirst: true,\n        rules: [{\n          validator: this.validator\n        }]\n      })(React.createElement(ZhiWenCascader, {\n        disabled: Boolean(this.state.competition),\n        type: \"competition\",\n        getValue: this.getValue.bind(this, 'raceId')\n      }))))), React.createElement(_Col, {\n        span: 10,\n        offset: 4,\n        style: {\n          marginTop: 39\n        }\n      }, React.createElement(FormItem, {\n        colon: false\n      }, React.createElement(FlexDisplay, null, React.createElement(_Radio, {\n        value: 1\n      }), React.createElement(SelectTitle, null, \"\\u5176\\u4ED6\"), getFieldDecorator('otherRace', {\n        validateFirst: true,\n        rules: [{\n          validator: this.otherRaceValidator\n        }]\n      })(React.createElement(_Input, {\n        disabled: !Boolean(this.state.competition),\n        placeholder: \"\\u8BF7\\u8F93\\u5165\"\n      }))))))))), React.createElement(_Row, null, React.createElement(_Col, {\n        span: 10\n      }, React.createElement(FormItem, {\n        label: \"\\u662F\\u5426\\u83B7\\u5956\",\n        colon: false\n      }, getFieldDecorator('isAwarded', {\n        rules: [{\n          required: true,\n          message: '此字段无法为空'\n        }]\n      })(React.createElement(RadioGroup, {\n        onChange: this.changeRadio\n      }, React.createElement(_Radio, {\n        value: 0\n      }, \"\\u662F\"), React.createElement(_Radio, {\n        value: 1\n      }, \"\\u5426\"))))), React.createElement(_Col, {\n        span: 10,\n        offset: 4\n      }, !this.state.isAwarded && React.createElement(FormItem, {\n        label: \"\\u6240\\u83B7\\u5956\\u9879\",\n        colon: false\n      }, getFieldDecorator('content', {\n        rules: [{\n          required: true,\n          message: '此字段无法为空'\n        }]\n      })(React.createElement(_Input, {\n        placeholder: \"\\u8BF7\\u8F93\\u5165\"\n      }))))), React.createElement(FormItem, {\n        labelCol: {\n          span: 12\n        },\n        colon: false\n      }, React.createElement(_Button, {\n        onClick: this.handleCancel\n      }, \"\\u53D6\\u6D88\"), React.createElement(_Button, {\n        style: {\n          marginLeft: 20\n        },\n        type: \"primary\",\n        htmlType: \"submit\",\n        loading: this.state.loading\n      }, \"\\u4FDD\\u5B58\"))));\n    }\n  }]);\n\n  return RegistrationForm;\n}(React.Component);\n\nvar EditCompetition = _Form.create()(RegistrationForm);\n\nexport default EditCompetition;\nvar Label = styled.label.withConfig({\n  displayName: \"EditCompetition__Label\",\n  componentId: \"sc-1p4r92j-1\"\n})([\"display:block;height:40px;line-height:40px;color:rgba(0,0,0,0.85);\"]);\nvar SelectTitle = styled.span.withConfig({\n  displayName: \"EditCompetition__SelectTitle\",\n  componentId: \"sc-1p4r92j-2\"\n})([\"width:100px;line-height:30px;word-break:keep-all;\"]);","map":null,"metadata":{},"sourceType":"module"}
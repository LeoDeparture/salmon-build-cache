{"ast":null,"code":"import \"antd/lib/affix/style\";\nimport _Affix from \"antd/lib/affix\";\nimport \"antd/lib/dropdown/style\";\nimport _Dropdown from \"antd/lib/dropdown\";\nimport \"antd/lib/icon/style\";\nimport _Icon from \"antd/lib/icon\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"antd/lib/menu/style\";\nimport _Menu from \"antd/lib/menu\";\nimport \"antd/lib/layout/style\";\nimport _Layout from \"antd/lib/layout\";\nimport getConfig from 'next/config';\nimport Router from 'next/router';\nimport React from 'react';\nimport styled from 'styled-components';\nimport { handlePermissions } from '../../../lib/commonJs';\nimport AccountUpdate from '../../../routes/accountUpdate/components/Dashboard';\nimport { renderMenuItems } from './MenuRenderer';\n\nvar _getConfig = getConfig(),\n    publicRuntimeConfig = _getConfig.publicRuntimeConfig;\n\nvar Header = _Layout.Header,\n    Sider = _Layout.Sider;\nvar SubMenu = _Menu.SubMenu;\n\nvar LayoutComponent =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(LayoutComponent, _React$Component);\n\n  function LayoutComponent() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, LayoutComponent);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(LayoutComponent)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      collapsed: false,\n      configPage: 0\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"componentDidMount\", function () {\n      if (_this.props.misViewer.person.nimInfo === null) {\n        _this.props.postNIM();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"logOut\", function () {\n      Router.push('/login');\n      localStorage.clear();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"toggle\", function () {\n      _this.setState({\n        collapsed: !_this.state.collapsed\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"goChat\", function () {\n      var _this$props = _this.props,\n          misViewer = _this$props.misViewer,\n          setCookie = _this$props.setCookie,\n          clearCookie = _this$props.clearCookie,\n          getNIM = _this$props.getNIM;\n      clearCookie('uid');\n      clearCookie('sdktoken');\n\n      if (misViewer.person.nimInfo) {\n        setCookie('uid', misViewer.person.nimInfo.accid);\n        setCookie('sdktoken', misViewer.person.nimInfo.token);\n        window.open(\"\".concat(publicRuntimeConfig.clientUrl, \"/im/main.html\"), 'newWindow', 'channelmode=yes');\n      } else {\n        getNIM();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"goCallUser\", function () {\n      window.open(\"\".concat(publicRuntimeConfig.clientUrl, \"/call-user\"), 'newWindow', 'channelmode=yes');\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"editAccount\", function () {\n      _this.setState({\n        configPage: 1\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"goBack\", function () {\n      _this.setState({\n        configPage: 0\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"sortMenu\", function (data) {\n      var sortArray = ['系统管理', '学习计划', '1对1辅导', '小班辅导', '订阅课程', '文件中心', '用户管理', '导师管理', '求职服务', '服务协议', '咨询服务', '财务管理', '题库', '技能课程'];\n      return data.sort(function (left, right) {\n        return sortArray.indexOf(left.name) - sortArray.indexOf(right.name);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderMenuItem\", function () {\n      var misViewer = _this.props.misViewer;\n\n      var permissions = _this.sortMenu(handlePermissions(misViewer.permissions));\n\n      return permissions.map(function (permission) {\n        var children = permission.children;\n        var name = permission.name; // 有二级菜单的选项\n\n        if (children.length > 0) {\n          if (name === '小班辅导') {\n            name = '小班课';\n          }\n\n          var items = renderMenuItems(children); // 如果所有子选项未配置 url, 不显示父级选项\n\n          if (items.filter(function (v) {\n            return v;\n          }).length === 0) {\n            return null;\n          }\n\n          return React.createElement(SubMenu, {\n            key: name,\n            title: name\n          }, items);\n        } // 只有一级菜单\n\n\n        return renderMenuItems([{\n          name: name\n        }]);\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(LayoutComponent, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          menuName = _this$props2.menuName,\n          subMenuName = _this$props2.subMenuName,\n          misViewer = _this$props2.misViewer,\n          version = _this$props2.version;\n      var menu = React.createElement(_Menu, null, React.createElement(_Menu.Item, null, React.createElement(\"a\", {\n        onClick: this.editAccount\n      }, \"\\u8D26\\u6237\\u8BBE\\u7F6E\")), React.createElement(_Menu.Item, null, React.createElement(\"a\", {\n        onClick: this.logOut\n      }, \"\\u6CE8\\u9500\")));\n      return React.createElement(_Layout, {\n        style: {\n          minHeight: '100vh'\n        }\n      }, React.createElement(StyledSider, {\n        theme: \"dark\",\n        collapsible: false,\n        width: \"256\"\n      }, React.createElement(Logo, null, React.createElement(LogoText, null, misViewer.department.name)), React.createElement(_Menu, {\n        theme: \"dark\",\n        mode: \"inline\",\n        defaultOpenKeys: [menuName],\n        defaultSelectedKeys: [subMenuName]\n      }, this.renderMenuItem()), React.createElement(Version, null, \"MIS \", version)), React.createElement(_Layout, {\n        style: {\n          marginLeft: 256,\n          minWidth: '1184px'\n        }\n      }, React.createElement(_Affix, {\n        style: AffixStyle\n      }, React.createElement(Header, {\n        style: HeaderStyle\n      }, React.createElement(HeaderRight, null, React.createElement(_Dropdown, {\n        overlay: menu\n      }, React.createElement(\"a\", {\n        style: EmailLinkStyle\n      }, misViewer.person.email, React.createElement(_Icon, {\n        type: \"down\",\n        style: ArrowDownStyle\n      })))), React.createElement(StyledIcon, {\n        type: \"message\",\n        theme: \"filled\",\n        onClick: this.goChat\n      }), React.createElement(StyledIcon, {\n        type: \"phone\",\n        theme: \"filled\",\n        onClick: this.goCallUser\n      }))), this.state.configPage === 0 ? this.props.children : React.createElement(AccountUpdate, {\n        goBack: this.goBack\n      })));\n    }\n  }]);\n\n  return LayoutComponent;\n}(React.Component);\n\nexport default LayoutComponent;\nvar AffixStyle = {\n  marginBottom: '-4px'\n};\nvar Version = styled.div.withConfig({\n  displayName: \"LayoutComponent__Version\",\n  componentId: \"sc-1xzq4ug-0\"\n})([\"width:100%;padding:24px 0;font-size:12px;color:rgba(255,255,255,0.65);text-align:center;background-color:#001529;\"]);\nvar HeaderStyle = {\n  background: '#fff',\n  boxShadow: '0 0.5px 4px 0 rgba(0, 0, 0, 0.1)',\n  padding: 0\n};\nvar HeaderRight = styled.div.withConfig({\n  displayName: \"LayoutComponent__HeaderRight\",\n  componentId: \"sc-1xzq4ug-1\"\n})([\"float:right;margin-right:18px;\"]);\nvar ArrowDownStyle = {\n  marginLeft: '10px'\n};\nvar EmailLinkStyle = {\n  color: '#000',\n  marginLeft: '10px'\n};\nvar Logo = styled.div.withConfig({\n  displayName: \"LayoutComponent__Logo\",\n  componentId: \"sc-1xzq4ug-2\"\n})([\"display:flex;align-items:center;height:2rem;margin:1rem;margin-left:1.8rem;overflow:hidden;\"]);\nvar LogoText = styled.div.withConfig({\n  displayName: \"LayoutComponent__LogoText\",\n  componentId: \"sc-1xzq4ug-3\"\n})([\"display:inline-block;font-size:1.25rem;font-weight:200;color:#fff;white-space:nowrap;vertical-align:text-bottom;\"]);\nvar StyledIcon = styled(_Icon).withConfig({\n  displayName: \"LayoutComponent__StyledIcon\",\n  componentId: \"sc-1xzq4ug-4\"\n})([\"float:right;padding:0 0.8rem;font-size:1.125rem;line-height:4.5rem;cursor:pointer;transition:color 0.3s;&:hover{color:#1890ff;}\"]);\nvar StyledSider = styled(Sider).withConfig({\n  displayName: \"LayoutComponent__StyledSider\",\n  componentId: \"sc-1xzq4ug-5\"\n})([\"position:fixed;left:0;z-index:100;height:100vh;.ant-layout-sider-children{display:flex;flex-direction:column;height:100vh;}.ant-menu-root{flex:1;overflow:auto;::-webkit-scrollbar{width:0;}}\"]);","map":null,"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import \"antd/lib/popover/style\";\nimport _Popover from \"antd/lib/popover\";\nimport \"antd/lib/breadcrumb/style\";\nimport _Breadcrumb from \"antd/lib/breadcrumb\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport \"antd/lib/tag/style\";\nimport _Tag from \"antd/lib/tag\";\nimport \"antd/lib/icon/style\";\nimport _Icon from \"antd/lib/icon\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport \"antd/lib/message/style\";\nimport _message from \"antd/lib/message\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport dynamic from 'next/dynamic';\nimport Link from 'next/link';\nimport * as React from 'react';\nimport { Mutation } from 'react-apollo';\nimport styled from 'styled-components';\nimport CONFIG from '../../../lib/config';\nimport { mutation } from '../containers/UpdateAvatar';\nvar ReactFilestack = dynamic(function () {\n  return import('filestack-react');\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('filestack-react')];\n    },\n    modules: ['filestack-react']\n  }\n});\nvar resumeInfo = {\n  marginLeft: '4px',\n  fontSize: '14px',\n  color: '#A2AAB8'\n};\n\nvar GenderIcon = function GenderIcon(props) {\n  var srcUrl;\n\n  if (props.genderKey === 'FEMALE') {\n    srcUrl = '../../../static/gender/female.png';\n  }\n\n  if (props.genderKey === 'MALE') {\n    srcUrl = '../../../static/gender/male.png';\n  }\n\n  if (props.genderKey === 'UNKNOWN') {\n    srcUrl = '../../../static/gender/confidentiality.png';\n  }\n\n  return React.createElement(GenderImage, {\n    src: srcUrl\n  });\n};\n\nvar GenderBlock = function GenderBlock(props) {\n  var gender = props.gender;\n\n  if (gender && gender.key && gender.name) {\n    return React.createElement(\"div\", null, React.createElement(GenderIcon, {\n      genderKey: gender.key\n    }), React.createElement(\"span\", null, gender.key === 'UNKNOWN' ? '不便透露' : gender.name));\n  } else {\n    return React.createElement(\"div\", null, React.createElement(GenderImage, {\n      src: \"../../../static/gender/noSet.png\"\n    }), React.createElement(\"span\", null, \"\\u6682\\u672A\\u8BBE\\u7F6E\"));\n  }\n};\n\nvar basicOptions = {\n  maxFiles: 1,\n  maxSize: 1024 * 1024\n};\n\nvar Header =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Header, _React$Component);\n\n  function Header() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Header);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Header)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      useDefaultImg: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleImgError\", function (e) {\n      e.target.onerror = null;\n      e.target.src = CONFIG.default.avatar;\n\n      _this.setState({\n        useDefaultImg: true\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderEditLink\", function (_ref) {\n      var onPick = _ref.onPick;\n      return React.createElement(EditMaskLink, {\n        onClick: onPick\n      }, \"\\u7F16\\u8F91\");\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSuccess\",\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(result) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _message.loading('上传中...', 0); // 执行 mutation\n\n\n                _context.next = 3;\n                return _this.updateAvatar({\n                  variables: {\n                    input: {\n                      avatar: result.filesUploaded[0].url,\n                      id: _this.props.cvId\n                    }\n                  }\n                });\n\n              case 3:\n                _message.destroy();\n\n                _message.success('上传头像成功');\n\n                _this.props.refetch();\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"onError\", function (error) {\n      _message.error(CONFIG.filestack.message.fail); // tslint:disable-next-line:no-console\n\n\n      console.error('FilestackError:', error);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"deleteAvatar\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _message.loading('删除中...', 0);\n\n              _context2.next = 3;\n              return _this.updateAvatar({\n                variables: {\n                  input: {\n                    avatar: '',\n                    id: _this.props.cvId\n                  }\n                }\n              });\n\n            case 3:\n              _message.destroy();\n\n              _message.success('删除成功');\n\n              _this.props.refetch();\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    })));\n\n    _defineProperty(_assertThisInitialized(_this), \"componentDidMount\", function () {\n      var avatar = _this.props.userInfo.account.person.avatar;\n\n      if (!avatar) {\n        _this.setState({\n          useDefaultImg: true\n        });\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(Header, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var userInfo = this.props.userInfo;\n      var id = userInfo.id;\n      var _this$props$userInfo$ = this.props.userInfo.account.person,\n          avatar = _this$props$userInfo$.avatar,\n          email = _this$props$userInfo$.email,\n          gender = _this$props$userInfo$.gender,\n          name = _this$props$userInfo$.name,\n          nickname = _this$props$userInfo$.nickname,\n          phoneNumber = _this$props$userInfo$.phoneNumber,\n          emailVerified = _this$props$userInfo$.emailVerified;\n      var cvFinished = this.props.userInfo.cvs && this.props.userInfo.cvs.length && this.props.userInfo.cvs[0].phoneNumber && this.props.userInfo.cvs[0].jobIntentions && this.props.userInfo.cvs[0].educationExperiences;\n      var avatarComponent = React.createElement(Mutation, {\n        mutation: mutation\n      }, function (action) {\n        _this2.updateAvatar = action;\n        return _this2.props.resumePage ? React.createElement(Portrait, null, React.createElement(\"img\", {\n          alt: \"\\u5934\\u50CF\",\n          src: avatar || CONFIG.default.portrait,\n          onError: _this2.handleImgError\n        }), React.createElement(EditMask, null, React.createElement(\"p\", null, React.createElement(ReactFilestack, {\n          apikey: CONFIG.filestack.apikey,\n          options: basicOptions,\n          onSuccess: _this2.onSuccess,\n          onError: _this2.onError,\n          render: _this2.renderEditLink\n        }), React.createElement(\"span\", {\n          hidden: _this2.state.useDefaultImg\n        }, \" | \"), React.createElement(EditMaskLink, {\n          onClick: _this2.deleteAvatar,\n          hidden: _this2.state.useDefaultImg\n        }, \"\\u5220\\u9664\")))) : React.createElement(Avatar, null, React.createElement(\"img\", {\n          alt: \"\\u5934\\u50CF\",\n          src: avatar || CONFIG.default.avatar,\n          onError: _this2.handleImgError\n        }));\n      });\n      /*\n        show phone\\email when either exists\n        show split character when both exist\n      */\n\n      var phoneBlock = React.createElement(\"div\", null, React.createElement(_Icon, {\n        type: \"phone\",\n        theme: \"filled\",\n        style: {\n          color: '#4a9ee2',\n          marginRight: 10\n        }\n      }), React.createElement(\"span\", null, phoneNumber));\n      var emailBlock = React.createElement(\"div\", null, React.createElement(_Icon, {\n        type: \"mail\",\n        theme: \"filled\",\n        style: {\n          color: '#ffc043',\n          marginRight: 10\n        }\n      }), React.createElement(\"span\", null, email), React.createElement(_Tag, {\n        hidden: this.props.resumePage,\n        style: {\n          marginLeft: 4,\n          cursor: 'default'\n        },\n        color: emailVerified ? 'green' : 'red'\n      }, emailVerified ? '已验证' : '未验证'));\n      var splitBlock = React.createElement(Split, null, \"|\");\n      return React.createElement(_Breadcrumb, {\n        style: _objectSpread({}, BreadcrumbStyle, {\n          marginBottom: this.props.resumePage ? 24 : 0\n        }),\n        separator: \"\"\n      }, React.createElement(_Breadcrumb.Item, {\n        separator: \"\"\n      }, React.createElement(UserInfo, null, avatarComponent, React.createElement(Info, null, React.createElement(Item, null, React.createElement(Name, null, this.props.resumePage ? React.createElement(\"span\", null, name + ' - ', \"\\u4E2A\\u4EBA\\u7B80\\u5386\") : name ? React.createElement(\"span\", null, nickname, React.createElement(Split, null, \"|\"), name) : nickname ? nickname : email && email.substring(0, email.indexOf('@'))), React.createElement(GenderBlock, {\n        gender: gender\n      })), React.createElement(Item, null, phoneNumber && phoneBlock, phoneNumber && email && splitBlock, email && emailBlock)))), React.createElement(_Breadcrumb.Item, null, !this.props.resumePage ? !!cvFinished ? React.createElement(Link, {\n        href: \"/user-resume/\".concat(id)\n      }, React.createElement(ResumeLink, {\n        style: {\n          marginRight: 40,\n          cursor: 'pointer'\n        }\n      }, React.createElement(ResumeIcon, {\n        src: \"../../../static/resume/resume.png\"\n      }), React.createElement(\"p\", null, \"\\u67E5\\u770B\\u7B80\\u5386\"))) : React.createElement(_Popover, {\n        style: {\n          fontSize: 12\n        },\n        placement: \"topLeft\",\n        content: \"\\u5728\\u5B66\\u5458\\u7AEF\\u586B\\u5199\\u7B80\\u5386\\u540E\\u67E5\\u770B\\u3002\"\n      }, React.createElement(ResumeLink, {\n        style: {\n          marginRight: 40,\n          cursor: 'not-allowed'\n        }\n      }, React.createElement(ResumeIcon, {\n        src: \"../../../static/resume/disable-icon.png\"\n      }), React.createElement(\"p\", {\n        style: {\n          color: '#A2AAB8'\n        }\n      }, React.createElement(\"span\", null, \"\\u672A\\u586B\\u5199\\u7B80\\u5386\"), React.createElement(_Icon, {\n        type: \"exclamation-circle\",\n        style: resumeInfo\n      })))) : React.createElement(\"div\", null)));\n    }\n  }]);\n\n  return Header;\n}(React.Component);\n\nexport default Header;\nvar Split = styled.span.withConfig({\n  displayName: \"Header__Split\",\n  componentId: \"rp41mt-0\"\n})([\"margin-right:10px;margin-left:10px;font-size:20px;\"]);\nvar Name = styled.div.withConfig({\n  displayName: \"Header__Name\",\n  componentId: \"rp41mt-1\"\n})([\"max-width:700px;margin-bottom:0;overflow:hidden;font-size:20px;font-weight:bold;color:#4a4a4a;text-overflow:ellipsis;white-space:nowrap;\"]);\nvar Avatar = styled.div.withConfig({\n  displayName: \"Header__Avatar\",\n  componentId: \"rp41mt-2\"\n})([\"position:relative;width:100px;height:100px;margin-right:30px;overflow:hidden;background-color:#ddd;border-radius:50%;img{width:100%;height:100%;}\"]);\nvar Portrait = styled.div.withConfig({\n  displayName: \"Header__Portrait\",\n  componentId: \"rp41mt-3\"\n})([\"position:relative;width:76px;height:98px;margin-right:30px;overflow:hidden;background-color:#ddd;img{width:auto;height:100%;}\"]);\nvar EditMask = styled.div.withConfig({\n  displayName: \"Header__EditMask\",\n  componentId: \"rp41mt-4\"\n})([\"position:absolute;top:0;left:0;display:flex;align-items:center;justify-content:center;width:100%;height:100%;color:#fff;cursor:pointer;background-color:rgba(0,0,0,0.5);opacity:0;p{margin:0;}span{font-size:14px;}&:hover{opacity:1;}\"]);\nvar EditMaskLink = styled.span.withConfig({\n  displayName: \"Header__EditMaskLink\",\n  componentId: \"rp41mt-5\"\n})([\"&:hover{color:rgba(230,230,230,1);}\"]);\nvar ResumeLink = styled.div.withConfig({\n  displayName: \"Header__ResumeLink\",\n  componentId: \"rp41mt-6\"\n})([\"display:flex;align-items:center;flex-direction:column;p{margin-top:10px;margin-bottom:'1px';font-size:12px;color:#000;}\"]);\nvar BreadcrumbStyle = {\n  alignItems: 'center',\n  backgroundColor: '#fff',\n  display: 'flex',\n  justifyContent: 'space-between',\n  padding: '20px 24px 0px'\n};\nvar UserInfo = styled.div.withConfig({\n  displayName: \"Header__UserInfo\",\n  componentId: \"rp41mt-7\"\n})([\"display:flex;\"]);\nvar Info = styled.div.withConfig({\n  displayName: \"Header__Info\",\n  componentId: \"rp41mt-8\"\n})([\"padding-top:30px;\"]);\nvar Item = styled.div.withConfig({\n  displayName: \"Header__Item\",\n  componentId: \"rp41mt-9\"\n})([\"display:flex;align-items:center;\"]);\nvar GenderImage = styled.img.withConfig({\n  displayName: \"Header__GenderImage\",\n  componentId: \"rp41mt-10\"\n})([\"width:16px;height:16px;margin-right:5px;margin-left:12px;vertical-align:text-bottom;\"]);\nvar ResumeIcon = styled.img.withConfig({\n  displayName: \"Header__ResumeIcon\",\n  componentId: \"rp41mt-11\"\n})([\"width:24px;height:27px;\"]);","map":null,"metadata":{},"sourceType":"module"}
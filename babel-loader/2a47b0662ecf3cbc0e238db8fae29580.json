{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport \"antd/lib/badge/style\";\nimport _Badge from \"antd/lib/badge\";\nimport { format } from 'date-fns';\nimport * as React from 'react';\nimport { arrayMove, SortableContainer, SortableElement, SortableHandle } from 'react-sortable-hoc';\nimport styled from 'styled-components';\nimport { TextContent } from '../../../lib/commonCss';\nvar HandleDiv = styled.div.withConfig({\n  displayName: \"SortableComponent__HandleDiv\",\n  componentId: \"apmvu6-0\"\n})([\"display:block;width:15px;height:15px;cursor:row-resize;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"50\\\" height=\\\"50\\\" viewBox=\\\"0 0 50 50\\\"><path d=\\\"M 0 7.5 L 0 12.5 L 50 12.5 L 50 7.5 L 0 7.5 z M 0 22.5 L 0 27.5 L 50 27.5 L 50 22.5 L 0 22.5 z M 0 37.5 L 0 42.5 L 50 42.5 L 50 37.5 L 0 37.5 z\\\" color=\\\"#000\\\"/></svg>');background-repeat:no-repeat;background-size:contain;opacity:0.75;\"]);\nvar ListDiv = styled.div.withConfig({\n  displayName: \"SortableComponent__ListDiv\",\n  componentId: \"apmvu6-1\"\n})([\"position:relative;height:500px;padding-right:10px;margin-right:-10px;overflow-y:scroll;outline:none;\"]);\nvar NonSelectableDiv = styled.div.withConfig({\n  displayName: \"SortableComponent__NonSelectableDiv\",\n  componentId: \"apmvu6-2\"\n})([\"user-select:none;\"]);\nvar IndexSpan = styled.span.withConfig({\n  displayName: \"SortableComponent__IndexSpan\",\n  componentId: \"apmvu6-3\"\n})([\"font-size:15px;font-weight:400;\"]);\nvar StatusSpan = styled.span.withConfig({\n  displayName: \"SortableComponent__StatusSpan\",\n  componentId: \"apmvu6-4\"\n})([\"width:5px;height:22px;\"]);\nvar NameSpan = styled.span.withConfig({\n  displayName: \"SortableComponent__NameSpan\",\n  componentId: \"apmvu6-5\"\n})([\"width:75%;overflow:hidden;font-weight:400;text-overflow:ellipsis;\"]);\nvar ItemDiv = styled.div.withConfig({\n  displayName: \"SortableComponent__ItemDiv\",\n  componentId: \"apmvu6-6\"\n})([\"z-index:1001;display:flex;align-items:center;justify-content:space-between;width:100%;height:50px;padding:0 20px;margin-bottom:8px;font-weight:400;color:#333;white-space:nowrap;background-color:#fff;border:1px solid #efefef;border-radius:3px;box-sizing:border-box;&.dragging-helper-class{box-shadow:0 0 10px 0 rgba(0,0,0,0.5);}\"]);\nvar ItemWrap = styled.div.withConfig({\n  displayName: \"SortableComponent__ItemWrap\",\n  componentId: \"apmvu6-7\"\n})([\"z-index:1001;display:flex;align-items:center;width:100%;padding:16px 20px;margin-bottom:8px;font-weight:400;color:#333;white-space:nowrap;background-color:#fff;border:1px solid #efefef;border-radius:3px;box-sizing:border-box;&.dragging-helper-class{box-shadow:0 0 10px 0 rgba(0,0,0,0.5);}\"]);\nvar Desc = styled.div.withConfig({\n  displayName: \"SortableComponent__Desc\",\n  componentId: \"apmvu6-8\"\n})([\"display:flex;flex-direction:column;width:100%;margin-left:20px;\"]);\nvar Handle = SortableHandle(function () {\n  return React.createElement(HandleDiv, null);\n});\n\nvar getStatusBadge = function getStatusBadge(name) {\n  var badgeStatus = name === '已上线' ? 'success' : name === '未上线' ? 'warning' : 'default';\n  return React.createElement(_Badge, {\n    status: badgeStatus,\n    style: {\n      width: '12px',\n      height: '12px'\n    }\n  });\n};\n\nvar SortableItem = SortableElement(function (_ref) {\n  var value = _ref.value,\n      mode = _ref.mode;\n\n  if (mode === 'drag-and-drop-and-dateSort') {\n    return React.createElement(ItemWrap, null, React.createElement(IndexSpan, null, value.index + 1), React.createElement(Desc, null, React.createElement(NameSpan, null, value.name), value.bestStartAt && React.createElement(TextContent, {\n      fontSize: \"12px\"\n    }, format(new Date(value.bestStartAt), 'YYYY/MM/DD'), \" -\", format(new Date(value.bestEndAt), 'YYYY/MM/DD'))), React.createElement(Handle, null));\n  }\n\n  return React.createElement(ItemDiv, null, React.createElement(IndexSpan, null, value.index + 1), value.status && React.createElement(StatusSpan, null, getStatusBadge(value.status.name)), React.createElement(NameSpan, null, value.name), React.createElement(Handle, null));\n});\nvar SortableList = SortableContainer(function (_ref2) {\n  var items = _ref2.items,\n      mode = _ref2.mode;\n  return React.createElement(NonSelectableDiv, null, React.createElement(ListDiv, {\n    id: 'container'\n  }, items.map(function (value, index) {\n    return React.createElement(SortableItem, {\n      key: \"item-\".concat(index),\n      mode: mode,\n      index: index,\n      value: _objectSpread({\n        index: index\n      }, value)\n    });\n  })));\n});\n\nvar SortableComponent =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(SortableComponent, _React$Component);\n\n  function SortableComponent(props) {\n    var _this;\n\n    _classCallCheck(this, SortableComponent);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SortableComponent).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"getSortableContainer\", function () {\n      return document.getElementById('container');\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSortEnd\", function (_ref3) {\n      var oldIndex = _ref3.oldIndex,\n          newIndex = _ref3.newIndex;\n\n      _this.setState({\n        items: arrayMove(_this.state.items, oldIndex, newIndex)\n      }, function () {\n        _this.props.getValue(_this.state.items);\n      });\n    });\n\n    _this.state = {\n      items: []\n    };\n    return _this;\n  }\n\n  _createClass(SortableComponent, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.setState({\n                  items: this.props.setValue\n                });\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      var result = true;\n      var thisList = this.props.setValue;\n\n      for (var i = 0; i < thisList.length; i += 1) {\n        if (thisList[i].id !== nextProps.setValue[i].id) {\n          result = false;\n          break;\n        }\n      }\n\n      if (!result) {\n        this.setState({\n          items: nextProps.setValue\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var mode = this.props.mode;\n      return React.createElement(SortableList, {\n        mode: mode,\n        getContainer: this.getSortableContainer,\n        items: this.state.items,\n        onSortEnd: this.onSortEnd,\n        helperClass: 'dragging-helper-class'\n      });\n    }\n  }]);\n\n  return SortableComponent;\n}(React.Component);\n\n_defineProperty(SortableComponent, \"defaultProps\", {\n  name: 'drag-and-drop'\n});\n\nexport default SortableComponent;","map":null,"metadata":{},"sourceType":"module"}
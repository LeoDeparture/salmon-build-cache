{"ast":null,"code":"import \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/radio/style\";\nimport _Radio from \"antd/lib/radio\";\nimport \"antd/lib/form/style\";\nimport _Form from \"antd/lib/form\";\nimport _parseInt from \"@babel/runtime-corejs2/core-js/parse-int\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport React, { Component } from 'react';\nimport styled from 'styled-components';\nimport NumberInput from '../../../../components/Input/NumberInput';\nimport ShadowedTitle from '../../../../components/ShadowedTitle';\nimport { FooterWrapper, HiddenWrapper } from '../CSSComponent';\nimport { getMoneyType } from '../JSComponent';\nimport { BasicInfoWrapper } from './BasicInfo';\nvar InLineStyle = {\n  Select: {\n    width: '500px',\n    lineHeight: '56px'\n  },\n  LeftButton: {\n    marginRight: '12px'\n  }\n};\nvar Line = styled.div.withConfig({\n  displayName: \"PayInfo__Line\",\n  componentId: \"sc-11qinvx-0\"\n})([\"width:768px;height:1px;margin-top:20px;background:#e1e1e8;\"]);\nvar TabsWrapper = styled.div.withConfig({\n  displayName: \"PayInfo__TabsWrapper\",\n  componentId: \"sc-11qinvx-1\"\n})([\"margin-bottom:40px;\"]);\nvar Tips = styled.div.withConfig({\n  displayName: \"PayInfo__Tips\",\n  componentId: \"sc-11qinvx-2\"\n})([\"width:340px;font-size:14px;line-height:22px;color:#ff991f;\"]);\nexport var PayInfo =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(PayInfo, _Component);\n\n  function PayInfo(props) {\n    var _this;\n\n    _classCallCheck(this, PayInfo);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(PayInfo).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"RadioChange\", function (e) {\n      _this.setState({\n        tabsValue: e.target.value\n      }, function () {\n        if (e.target.value === 1) {\n          var prePrice = _this.state.prePrice;\n\n          _this.props.form.setFieldsValue({\n            prepayPrice: prePrice\n          });\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"checkDiscountPrice\", function (_rule, value, callback) {\n      var getFieldValue = _this.props.form.getFieldValue;\n      var basePrice = getFieldValue('basePrice');\n\n      if (value >= basePrice) {\n        callback('正整数，不可大于等于基础价格');\n      }\n\n      callback();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"validatorPrepayPrice\", function (_rule, value, callback) {\n      var getFieldValue = _this.props.form.getFieldValue;\n      var basePrice = getFieldValue('basePrice');\n      var discountPrice = getFieldValue('discountPrice');\n      var diffPrice = discountPrice ? basePrice - discountPrice : basePrice;\n\n      if (value >= diffPrice) {\n        _this.setState({\n          isShowPrePriceText: false\n        });\n\n        callback('不可大于等于应付价格');\n        return;\n      }\n\n      _this.setState({\n        isShowPrePriceText: true\n      });\n\n      callback();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"validateOtherField\", function (_rule, _value, callback) {\n      var validateFieldsAndScroll = _this.props.form.validateFieldsAndScroll;\n      validateFieldsAndScroll(['discountPrice', 'prepayPrice'], {\n        force: true\n      }, function () {\n        return;\n      });\n      callback();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"checkMaxDay\", function (_rule, value, callback) {\n      if (value > 30) {\n        callback('正整数，不可大于30');\n      } else if (!value) {\n        callback('此字段无法为空');\n      }\n\n      callback();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"storePrePrice\", function (v) {\n      _this.setState({\n        prePrice: v\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"lastPrice\", function () {\n      var getFieldValue = _this.props.form.getFieldValue;\n      return getFieldValue('discountPrice') ? getMoneyType(getFieldValue('basePrice') - getFieldValue('discountPrice') - getFieldValue('prepayPrice')) : getMoneyType(getFieldValue('basePrice') - getFieldValue('prepayPrice'));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickBtn\", function () {\n      _this.props.form.validateFields(function (err, fieldsValue) {\n        if (!err) {\n          var basePrice = fieldsValue.basePrice,\n              discountPrice = fieldsValue.discountPrice,\n              prepayPrice = fieldsValue.prepayPrice,\n              maxDelayDays = fieldsValue.maxDelayDays;\n\n          _this.props.changeCreateData({\n            payInfo: {\n              basePrice: _parseInt((basePrice * 100).toFixed(0), 10),\n              discountPrice: _parseInt((discountPrice * 100).toFixed(0), 10),\n              payWay: _this.state.tabsValue === 0 ? 'FULL' : 'PREPAY',\n              prepayPrice: _parseInt((prepayPrice * 100).toFixed(0), 10),\n              maxDelayDays: maxDelayDays,\n              isSupportStaged: false\n            }\n          }, _this.props.createTicket);\n        }\n      });\n    });\n\n    _this.state = {\n      tabsValue: 0,\n      prePrice: undefined,\n      isShowPrePriceText: true\n    };\n    return _this;\n  }\n\n  _createClass(PayInfo, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props$form = this.props.form,\n          getFieldDecorator = _this$props$form.getFieldDecorator,\n          getFieldValue = _this$props$form.getFieldValue;\n      var data = this.props.data;\n      var isShowPrePriceText = this.state.isShowPrePriceText;\n      return React.createElement(HiddenWrapper, {\n        style: !this.props.show ? {\n          display: 'none'\n        } : {}\n      }, React.createElement(_Form, null, React.createElement(BasicInfoWrapper, null, React.createElement(ShadowedTitle, {\n        text: \"\\u4EF7\\u683C\\u4FE1\\u606F\",\n        style: {\n          margin: '44px 0',\n          width: 80\n        }\n      }), React.createElement(_Form.Item, {\n        label: \"\\u57FA\\u7840\\u4EF7\\u683C\\uFF08CNY\\uFF09\",\n        colon: false\n      }, getFieldDecorator('basePrice', {\n        initialValue: data.basePrice / 100,\n        rules: [{\n          required: true,\n          message: '此字段无法为空'\n        }, {\n          validator: this.validateOtherField\n        }]\n      })(React.createElement(NumberInput, {\n        style: {\n          width: 340\n        },\n        precision: 2,\n        placeholder: \"\\u6B63\\u6574\\u6570\"\n      }))), React.createElement(_Form.Item, {\n        label: \"\\u4F18\\u60E0\\u91D1\\u989D\\uFF08CNY\\uFF09\",\n        colon: false\n      }, getFieldDecorator('discountPrice', {\n        rules: [{\n          validator: this.checkDiscountPrice\n        }]\n      })(React.createElement(NumberInput, {\n        style: {\n          width: 340\n        },\n        min: 1,\n        precision: 0,\n        placeholder: \"\\u6B63\\u6574\\u6570\\uFF0C\\u4E0D\\u53EF\\u5927\\u4E8E\\u57FA\\u7840\\u4EF7\\u683C\"\n      }))), React.createElement(_Form.Item, {\n        label: \"\\u5E94\\u4ED8\\u603B\\u4EF7\\uFF08CNY\\uFF09\",\n        colon: false,\n        style: {\n          width: 340\n        }\n      }, getFieldValue('discountPrice') ? getMoneyType(getFieldValue('basePrice') - getFieldValue('discountPrice')) : getMoneyType(getFieldValue('basePrice'))), React.createElement(Line, null), React.createElement(ShadowedTitle, {\n        text: \"\\u652F\\u4ED8\\u65B9\\u5F0F\",\n        style: {\n          margin: '44px 0 ',\n          width: 80\n        }\n      }), React.createElement(TabsWrapper, null, React.createElement(_Radio.Group, {\n        onChange: this.RadioChange,\n        defaultValue: this.state.tabsValue\n      }, React.createElement(_Radio.Button, {\n        style: {\n          fontSize: 14\n        },\n        value: 0\n      }, \"\\u4E00\\u6B21\\u6027\\u5168\\u6B3E\"), React.createElement(_Radio.Button, {\n        style: {\n          fontSize: 14\n        },\n        value: 1\n      }, \"\\u9884\\u4ED8\\u6B3E+\\u5C3E\\u6B3E\"))), this.state.tabsValue === 1 ? React.createElement(React.Fragment, null, React.createElement(_Form.Item, {\n        label: \"\\u65B9\\u6848\\u9884\\u4ED8\\u6B3E\\u767E\\u5206\\u6BD4\",\n        colon: false,\n        style: {\n          width: 340\n        }\n      }, \"\".concat(data.prepayPercent, \"%\")), React.createElement(_Form.Item, {\n        label: \"\\u65B9\\u6848\\u9884\\u4ED8\\u6B3E\\u91D1\\u989D\\uFF08CNY\\uFF09\",\n        colon: false,\n        style: {\n          width: 340\n        }\n      }, getMoneyType(data.basePrice * data.prepayPercent / 100 / 100)), React.createElement(_Form.Item, {\n        label: \"\\u670D\\u52A1\\u5355\\u9884\\u4ED8\\u6B3E\\u91D1\\u989D\\uFF08CNY\\uFF09\",\n        colon: false\n      }, getFieldDecorator('prepayPrice', {\n        rules: [{\n          required: true,\n          message: '此字段无法为空'\n        }, {\n          validator: this.validatorPrepayPrice\n        }]\n      })(React.createElement(NumberInput, {\n        style: {\n          width: 340\n        },\n        min: 1,\n        precision: 2,\n        placeholder: \"\\u6B63\\u6574\\u6570\",\n        onChange: this.storePrePrice\n      })), getFieldValue('prepayPrice') && isShowPrePriceText ? getFieldValue('prepayPrice') < data.basePrice * data.prepayPercent / 100 / 100 ? React.createElement(Tips, null, \"\\u5F53\\u524D\\u670D\\u52A1\\u5355\\u9884\\u4ED8\\u6B3E\\u91D1\\u989D\\u5C0F\\u4E8E\\u9884\\u4ED8\\u6B3E\\u91D1\\u989D\\uFF08\".concat((data.basePrice * data.prepayPercent / 100 / 100).toFixed(2), \"\\u5143\\uFF09\\uFF0C\\u5B66\\u5458\\u65E0\\u6CD5\\u9884\\u7EA6AM\\u53CA\\u540E\\u7EED\\u7684\\u5B66\\u4E60\\u8BA1\\u5212\\u89C4\\u5212\\u670D\\u52A1\\u3002\")) : React.createElement(Tips, {\n        style: {\n          color: '#36B37E'\n        }\n      }, \"\\u5F53\\u524D\\u670D\\u52A1\\u5355\\u9884\\u4ED8\\u6B3E\\u91D1\\u989D\\u5927\\u4E8E\\u7B49\\u4E8E\\u9884\\u4ED8\\u6B3E\\u91D1\\u989D\\uFF08\".concat((data.basePrice * data.prepayPercent / 100 / 100).toFixed(2), \"\\u5143\\uFF09\\uFF0C\\u5B66\\u5458\\u53EF\\u6B63\\u5E38\\u9884\\u7EA6AM\\u53CA\\u540E\\u7EED\\u7684\\u5B66\\u4E60\\u8BA1\\u5212\\u89C4\\u5212\\u670D\\u52A1\\u3002\\u6CE8\\u610F\\uFF1A\\u5B66\\u5458\\u9700\\u8981\\u518D\\u652F\\u4ED8\\u9884\\u4ED8\\u6B3E\\u540E\\u89C4\\u5B9A\\u671F\\u95F4\\u5185\\u5B8C\\u6210\\u5C3E\\u6B3E\\u652F\\u4ED8\\uFF0C\\u5426\\u5219\\u4F1A\\u5F71\\u54CD\\u6B63\\u5E38\\u4F7F\\u7528\\u3002\")) : null), React.createElement(_Form.Item, {\n        label: \"\\u5C3E\\u6B3E\\u91D1\\u989D\\uFF08CNY\\uFF09\",\n        colon: false,\n        style: {\n          width: 340\n        }\n      }, this.lastPrice()), React.createElement(_Form.Item, {\n        label: \"\\u51E0\\u5929\\u5185\\u4ED8\\u6E05\\u5C3E\\u6B3E\",\n        colon: false\n      }, getFieldDecorator('maxDelayDays', {\n        initialValue: data.maxDelayDays,\n        rules: [{\n          required: true,\n          validator: this.checkMaxDay\n        }]\n      })(React.createElement(NumberInput, {\n        style: {\n          width: 340,\n          marginRight: 8\n        },\n        min: 1,\n        precision: 0,\n        placeholder: \"\\u6B63\\u6574\\u6570\\uFF0C\\u4E0D\\u53EF\\u5927\\u4E8E30\"\n      })), React.createElement(\"span\", null, \"\\u5929\"))) : React.createElement(\"div\", null, \"\\u4F60\\u5DF2\\u9009\\u62E9\\u4E00\\u6B21\\u6027\\u5168\\u6B3E\\u652F\\u4ED8\\u65B9\\u5F0F\"), React.createElement(FooterWrapper, null, React.createElement(_Button, {\n        onClick: this.props.goLastStep,\n        style: InLineStyle.LeftButton\n      }, \"\\u4E0A\\u4E00\\u6B65\"), React.createElement(_Button, {\n        type: \"primary\",\n        onClick: this.onClickBtn\n      }, \"\\u521B\\u5EFA\\u670D\\u52A1\\u5355\")))));\n    }\n  }]);\n\n  return PayInfo;\n}(Component);\nexport default _Form.create()(PayInfo);","map":null,"metadata":{},"sourceType":"module"}
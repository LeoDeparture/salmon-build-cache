{"ast":null,"code":"import \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/icon/style\";\nimport _Icon from \"antd/lib/icon\";\nimport \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport \"antd/lib/message/style\";\nimport _message from \"antd/lib/message\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport React, { Component } from 'react';\nimport { ApolloConsumer } from 'react-apollo';\nimport styled from 'styled-components';\nimport { parseErrorCode } from '../../../lib/commonJs';\nimport { QueryGetChapterById } from '../chapter/createOrEdit/containers/QueryGetChapterById';\nimport { MutationOnlineChapter } from '../chapter/root/containers/Mutation';\nimport { QueryListChaptersWithPagination } from '../chapter/root/containers/QueryListChapters';\nimport { QueryGetSkillCourseById } from '../courses/createOrEdit/containers/QueryGetSkillCourseById';\nimport { MutationOnlineSkillCourse } from '../courses/root/containers/Mutations';\nimport { QueryListSkillCourses } from '../courses/root/containers/QueryListSkillCourses';\nimport { TextBtnWrapper } from '../CSSComponents';\nimport { MutationOnlineSection } from '../section/root/containers/Mutations';\nimport { QueryGetSkillChapterById } from '../section/root/containers/QueryGetSkillChapterById';\nimport { QueryListSection } from '../section/root/containers/QueryListSection';\nimport { QueryGetSeriesById } from '../series/createOrEdit/containers/QueryGetSeriesById';\nimport { MutationOnlineSeries } from '../series/root/containers/Mutation';\nimport { QueryListSeriesWithPagination } from '../series/root/containers/QueryListSeries';\n\nvar OnlineAction =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(OnlineAction, _Component);\n\n  function OnlineAction() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, OnlineAction);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(OnlineAction)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"onlineSkillCourse\", function () {\n      var _this$props = _this.props,\n          type = _this$props.type,\n          variables = _this$props.variables,\n          id = _this$props.id,\n          sectionInChapterTable = _this$props.sectionInChapterTable;\n      var mutation;\n      var query;\n      var mesText;\n\n      if (type === 'course') {\n        var getDataById = _this.props.getDataById;\n        mutation = MutationOnlineSkillCourse;\n        query = getDataById ? QueryGetSkillCourseById : QueryListSkillCourses;\n        mesText = '已成功上线此分类';\n      }\n\n      if (type === 'series') {\n        var _getDataById = _this.props.getDataById;\n        mutation = MutationOnlineSeries;\n        query = _getDataById ? QueryGetSeriesById : QueryListSeriesWithPagination;\n        mesText = '已成功上线此周期';\n      }\n\n      if (type === 'chapter') {\n        var _getDataById2 = _this.props.getDataById;\n        mutation = MutationOnlineChapter;\n        query = _getDataById2 ? QueryGetChapterById : QueryListChaptersWithPagination;\n        mesText = '已成功上线此章节';\n      }\n\n      if (type === 'section') {\n        var _getDataById3 = _this.props.getDataById;\n        mutation = MutationOnlineSection;\n        query = sectionInChapterTable ? QueryListChaptersWithPagination : _getDataById3 ? QueryGetSkillChapterById : QueryListSection;\n        mesText = '已成功上线此小节';\n      }\n\n      return _this.client.mutate({\n        mutation: mutation,\n        variables: {\n          input: {\n            id: id\n          }\n        },\n        refetchQueries: [{\n          query: query,\n          variables: variables\n        }]\n      }).then(function (_) {\n        _message.destroy();\n\n        _message.success(mesText, 1.5);\n      }).catch(function (err) {\n        var text;\n        var contentText;\n        var errCode = parseErrorCode(err);\n\n        if (errCode === 'NoOnlineSeries') {\n          text = '无法上线此课程';\n          contentText = '课程中未找到可上线的课程周期，请先建立课程周期。';\n        }\n\n        if (errCode === 'NoCourse') {\n          text = '无法上线此周期';\n          contentText = '至少有一个章节才能上线此周期。';\n        }\n\n        if (errCode === 'NoSection') {\n          text = '无法上线此章节';\n          contentText = '至少有一个小节才能上线该章节。';\n        }\n\n        _Modal.warning({\n          icon: React.createElement(_Icon, {\n            type: \"exclamation-circle\",\n            theme: \"filled\"\n          }),\n          title: React.createElement(\"div\", {\n            style: {\n              color: '#42526E'\n            }\n          }, text),\n          content: React.createElement(\"div\", {\n            style: {\n              color: '#42526E'\n            }\n          }, contentText),\n          okText: '我知道了'\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderButtonEle\", function () {\n      var type = _this.props.type;\n      var title;\n      var content;\n\n      if (type === 'course') {\n        title = '确认上线此课程吗？';\n        content = React.createElement(\"div\", null, React.createElement(ModalText, null, \"\\u4E0A\\u7EBF\\u540E\\uFF1A\"), React.createElement(ModalText, null, \"1\\u3001MIS\\u7CFB\\u7EDF\\u5185\\u53EF\\u4EE5\\u67E5\\u770B\\u6B64\\u8BFE\\u7A0B\\uFF1B\"), React.createElement(ModalText, null, \"2\\u3001\\u7528\\u6237\\u53EF\\u5728APP\\u7AEF\\u770B\\u5230\\u8BE5\\u8BFE\\u7A0B\\u3002\"));\n      }\n\n      if (type === 'series') {\n        title = '确认上线此周期吗？';\n        content = React.createElement(\"div\", null, React.createElement(ModalText, null, \"\\u4E0A\\u7EBF\\u540E\\uFF1A\"), React.createElement(ModalText, null, \"1\\u3001MIS\\u7CFB\\u7EDF\\u5185\\u53EF\\u4EE5\\u67E5\\u770B\\u6B64\\u5468\\u671F\\uFF1B\"), React.createElement(ModalText, null, \"2\\u3001\\u7528\\u6237\\u53EF\\u4EE5\\u5728APP\\u770B\\u5230\\u8BE5\\u5468\\u671F\\u5173\\u8054\\uFF1B\"), React.createElement(ModalText, null, \"3\\u3001\\u8BE5\\u5468\\u671F\\u5360\\u7528\\u7684\\u65F6\\u95F4\\u6BB5\\u5C06\\u4E0D\\u80FD\\u521B\\u5EFA\\u65B0\\u5468\\u671F\\u3002\"));\n      }\n\n      if (type === 'chapter') {\n        title = '确认移上线此章节吗？';\n        content = React.createElement(\"div\", null, React.createElement(ModalText, null, \"\\u4E0A\\u7EBF\\u540E\\uFF1A\"), React.createElement(ModalText, null, \"1\\u3001MIS \\u7CFB\\u7EDF\\u5185\\u53EF\\u4EE5\\u67E5\\u770B\\u5230\\u8BE5\\u7AE0\\u8282\\uFF1B\"), React.createElement(ModalText, null, \"2\\u3001\\u7528\\u6237\\u53EF\\u4EE5\\u5728APP\\u770B\\u5230\\u8BE5\\u7AE0\\u8282\\u3002\"));\n      }\n\n      if (type === 'section') {\n        title = '确认移上线此小节吗？';\n        content = React.createElement(\"div\", null, React.createElement(ModalText, null, \"\\u4E0A\\u7EBF\\u540E\\uFF1A\"), React.createElement(ModalText, null, \"1\\u3001MIS \\u7CFB\\u7EDF\\u5185\\u53EF\\u4EE5\\u67E5\\u770B\\u5230\\u8BE5\\u5C0F\\u8282\\uFF1B\"), React.createElement(ModalText, null, \"2\\u3001\\u7528\\u6237\\u53EF\\u4EE5\\u5728APP\\u770B\\u5230\\u8BE5\\u5C0F\\u8282\\u3002\"));\n      }\n\n      _Modal.confirm({\n        title: React.createElement(ModalText, null, title),\n        icon: React.createElement(_Icon, {\n          type: \"question-circle\",\n          theme: \"filled\"\n        }),\n        okText: '确认上线',\n        onOk: _this.onlineSkillCourse,\n        content: content,\n        cancelText: '取消'\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(OnlineAction, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props2 = this.props,\n          btnType = _this$props2.btnType,\n          styles = _this$props2.styles;\n      return React.createElement(ApolloConsumer, null, function (client) {\n        _this2.client = client;\n        return btnType === 'button' ? React.createElement(_Button, {\n          onClick: _this2.renderButtonEle,\n          style: styles\n        }, \"\\u4E0A\\u7EBF\") : React.createElement(TextBtnWrapper, {\n          onClick: _this2.renderButtonEle,\n          style: styles\n        }, \"\\u4E0A\\u7EBF\");\n      });\n    }\n  }]);\n\n  return OnlineAction;\n}(Component);\n\n_defineProperty(OnlineAction, \"defaultProps\", {\n  getDataById: false,\n  btnType: 'button',\n  sectionInChapterTable: false\n});\n\nexport { OnlineAction as default };\nvar ModalText = styled.p.withConfig({\n  displayName: \"OnlineAction__ModalText\",\n  componentId: \"dm8u2w-0\"\n})([\"margin:0;color:#42526e;\"]);","map":null,"metadata":{},"sourceType":"module"}
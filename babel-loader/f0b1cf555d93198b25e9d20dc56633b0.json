{"ast":null,"code":"import \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/row/style\";\nimport _Row from \"antd/lib/row\";\nimport \"antd/lib/input/style\";\nimport _Input from \"antd/lib/input\";\nimport _Object$keys from \"@babel/runtime-corejs2/core-js/object/keys\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"antd/lib/form/style\";\nimport _Form from \"antd/lib/form\";\nimport Router from 'next/router';\nimport React from 'react';\nimport styled from 'styled-components';\nvar FormItem = _Form.Item;\nvar ContentDiv = styled.div.withConfig({\n  displayName: \"CreatingAccountNormalEmailContent__ContentDiv\",\n  componentId: \"sc-71a1ox-0\"\n})([\"display:flex;align-items:center;flex-direction:column;justify-content:center;width:50%;height:100vh;margin:0 auto;\"]);\n\nvar RegistrationForm =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(RegistrationForm, _React$Component);\n\n  function RegistrationForm() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, RegistrationForm);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(RegistrationForm)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      disabled: true,\n      email: '',\n      timeOut: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"componentDidMount\", function () {\n      _this.setState({\n        email: Router.router.query.email\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleSubmit\", function (e) {\n      e.preventDefault();\n\n      _this.props.form.validateFieldsAndScroll(\n      /*#__PURE__*/\n      function () {\n        var _ref = _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee(err, fieldsValue) {\n          var userData, result;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  if (!err) {\n                    _context.next = 4;\n                    break;\n                  }\n\n                  _this.setState({\n                    disabled: true\n                  });\n\n                  _context.next = 19;\n                  break;\n\n                case 4:\n                  _this.setState({\n                    disabled: false\n                  });\n\n                  userData = Router.router.query;\n                  fieldsValue.personId = userData.personId;\n                  _context.prev = 7;\n                  _context.next = 10;\n                  return _this.props.signupMutationFun(fieldsValue);\n\n                case 10:\n                  result = _context.sent;\n\n                  if (result.data) {\n                    Router.push('/login');\n                  }\n\n                  _context.next = 19;\n                  break;\n\n                case 14:\n                  _context.prev = 14;\n                  _context.t0 = _context[\"catch\"](7);\n\n                  _this.setState({\n                    disabled: true\n                  });\n\n                  if (_context.t0.graphQLErrors[0].message === 'The user already exists.') {\n                    _Modal.error({\n                      title: '该账号已经被注册'\n                    });\n                  }\n\n                  if (_context.t0.message === 'an error has occured: invite code may have expired') {\n                    _Modal.error({\n                      title: '该账号已经被注册'\n                    });\n                  }\n\n                case 19:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, null, [[7, 14]]);\n        }));\n\n        return function (_x, _x2) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleChange\", function () {\n      window.setTimeout(function () {\n        var values = _this.props.form.getFieldsValue();\n\n        var filled = true;\n\n        _Object$keys(values).forEach(function (key) {\n          filled = filled && values[key];\n        });\n\n        _this.setState({\n          disabled: !filled\n        });\n      }, 100);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderFun\", function () {\n      if (_this.state.timeOut) {\n        return React.createElement(ContentDiv, null, React.createElement(\"p\", null, \"\\u6B64\\u94FE\\u63A5\\u5DF2\\u8FC7\\u671F\"));\n      }\n\n      var getFieldDecorator = _this.props.form.getFieldDecorator;\n      return React.createElement(_Form, {\n        onSubmit: _this.handleSubmit,\n        style: {\n          width: '100%',\n          backgroundColor: '#fff'\n        }\n      }, React.createElement(ContentDiv, null, React.createElement(_Row, null, React.createElement(\"h3\", {\n        style: {\n          textAlign: 'center',\n          marginBottom: 30\n        }\n      }, \"\\u8BF7\\u8BBE\\u7F6E\\u4F60\\u7684\\u5E10\\u53F7\\u4FE1\\u606F\"), React.createElement(FormItem, {\n        style: {\n          width: 350\n        },\n        label: \"\\u59D3\\u540D\"\n      }, getFieldDecorator('name', {\n        rules: [{\n          message: '请输入姓名!',\n          required: true\n        }]\n      })(React.createElement(_Input, {\n        placeholder: \"\\u63A8\\u8350\\u4F7F\\u7528\\u771F\\u5B9E\\u4E2D\\u6587\\u59D3\\u540D\",\n        onChange: _this.handleChange\n      }))), React.createElement(FormItem, {\n        style: {\n          width: 350\n        },\n        label: \"\\u6635\\u79F0\"\n      }, getFieldDecorator('nickname', {\n        rules: [{\n          message: '请输入昵称!',\n          required: true\n        }]\n      })(React.createElement(_Input, {\n        placeholder: \"\\u8BF7\\u8F93\\u5165\\u6635\\u79F0\",\n        onChange: _this.handleChange\n      }))), React.createElement(FormItem, {\n        style: {\n          width: 350\n        },\n        label: \"\\u8D26\\u53F7\"\n      }, React.createElement(_Input, {\n        disabled: true,\n        placeholder: _this.state.email,\n        onChange: _this.handleChange\n      })), React.createElement(FormItem, {\n        style: {\n          width: 350\n        },\n        label: \"\\u5BC6\\u7801\"\n      }, getFieldDecorator('password', {\n        rules: [{\n          message: '此字段无法为空',\n          required: true,\n          whitespace: true\n        }, {\n          message: '请输入不少于8位字符的密码',\n          pattern: /^.{8,}$/\n        }]\n      })(React.createElement(_Input, {\n        type: \"password\",\n        placeholder: \"\\u8BF7\\u8F93\\u5165\\u4E0D\\u5C11\\u4E8E8\\u4F4D\\u5B57\\u7B26\\u7684\\u5BC6\\u7801\",\n        onChange: _this.handleChange\n      })))), React.createElement(FormItem, {\n        labelCol: {\n          span: 12\n        }\n      }, React.createElement(_Button, {\n        style: {\n          marginTop: 10,\n          width: 350\n        },\n        type: \"primary\",\n        htmlType: \"submit\",\n        disabled: _this.state.disabled\n      }, \"\\u7ACB\\u5373\\u524D\\u5F80\\u804C\\u95EE MIS \\u7CFB\\u7EDF\"))));\n    });\n\n    return _this;\n  }\n\n  _createClass(RegistrationForm, [{\n    key: \"render\",\n    value: function render() {\n      return this.renderFun();\n    }\n  }]);\n\n  return RegistrationForm;\n}(React.Component);\n\nvar WrappedRegistrationForm = _Form.create()(RegistrationForm);\n\nexport default WrappedRegistrationForm;","map":null,"metadata":{},"sourceType":"module"}
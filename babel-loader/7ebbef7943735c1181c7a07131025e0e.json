{"ast":null,"code":"import \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/radio/style\";\nimport _Radio from \"antd/lib/radio\";\nimport _toConsumableArray from \"@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"antd/lib/form/style\";\nimport _Form from \"antd/lib/form\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport _Object$assign from \"@babel/runtime-corejs2/core-js/object/assign\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"antd/lib/date-picker/style\";\nimport _DatePicker from \"antd/lib/date-picker\";\nimport React from 'react';\nimport styled from 'styled-components';\nimport { buttonStyle, ButtonWrapperStyle, ChildTitle, FormItemBodyWrapper, FormItemSubtitle, FormItemTitle, FormStyle, HiddenStyle, noTxtRequireRule, RequiredFormItemTitle } from '../RootComponent';\nvar RangePicker = _DatePicker.RangePicker;\n\nvar ModuleForm =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ModuleForm, _React$Component);\n\n  function ModuleForm() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ModuleForm);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ModuleForm)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      tabIndex: 0,\n      freezeDayCount: '--'\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickLastStep\", function () {\n      _this.props.toLastStep();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickNextStep\", function () {\n      _this.props.form.validateFieldsAndScroll({\n        force: true\n      }, function (err, fieldsValue) {\n        if (!err) {\n          var servicePeriod = fieldsValue.servicePeriod,\n              freezePeriod = fieldsValue.freezePeriod;\n          var variables = {}; // 服务期限\n\n          if (servicePeriod && servicePeriod.length > 0) {\n            _Object$assign(variables, {\n              servicePeriodStartAt: servicePeriod[0].toISOString(),\n              servicePeriodEndAt: servicePeriod[1].toISOString()\n            });\n          } // 冻结期限\n\n\n          if (freezePeriod && freezePeriod.length > 0) {\n            _Object$assign(variables, {\n              freezePeriodStartAt: freezePeriod[0].toISOString(),\n              freezePeriodEndAt: freezePeriod[1].toISOString()\n            });\n          } // 添加服务期id\n\n\n          var servicePeriodTypeIds = _this.props.servicePeriodTypes.map(function (v) {\n            return v.id;\n          });\n\n          _Object$assign(variables, {\n            servicePeriodTypeId: servicePeriodTypeIds[_this.state.tabIndex]\n          });\n\n          _this.props.assignVariables(variables);\n\n          _this.props.toNextStep();\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onChangeTab\", function (e) {\n      var resetFields = _this.props.form.resetFields;\n      resetFields(['servicePeriod', 'freezePeriod']);\n\n      _this.setState({\n        tabIndex: e.target.value,\n        freezeDayCount: '--'\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onChangeFreezeDate\", function (dates) {\n      var _dates = _slicedToArray(dates, 2),\n          start = _dates[0],\n          end = _dates[1];\n\n      if (!start || !end) {\n        _this.setState({\n          freezeDayCount: '--'\n        });\n\n        return;\n      }\n\n      var freezeDayCount = end.diff(start, 'days') + 1;\n\n      _this.setState({\n        freezeDayCount: freezeDayCount.toString()\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"checkFreezePeriod\", function (_rule, _value, callback) {\n      var getFieldValue = _this.props.form.getFieldValue;\n      var servicePeriod = getFieldValue('servicePeriod');\n      var freezePeriod = getFieldValue('freezePeriod');\n\n      if (!servicePeriod || !freezePeriod) {\n        return;\n      }\n\n      var servicePeriodStartAt = servicePeriod[0];\n      var servicePeriodEndAt = servicePeriod[1];\n      var freezePeriodStartAt = freezePeriod[0];\n      var freezePeriodEndAt = freezePeriod[1];\n\n      if (Math.round(freezePeriodStartAt.diff(servicePeriodStartAt, 'days', true)) < 0 || Math.round(freezePeriodEndAt.diff(servicePeriodEndAt, 'days', true)) > 0) {\n        callback('冻结期间必须在服务期间内');\n      }\n\n      callback();\n    });\n\n    return _this;\n  }\n\n  _createClass(ModuleForm, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var getFieldDecorator = this.props.form.getFieldDecorator;\n      var servicePeriodTypes = this.props.servicePeriodTypes;\n      var tabIndex = this.state.tabIndex; // 提示信息\n\n      var Hint = function Hint() {\n        return React.createElement(\"p\", null, \"\\u9664\\u975E\\u7279\\u522B\\u7EA6\\u5B9A\\uFF0C\\u4E59\\u65B9\\u5C06\\u5728\\u670D\\u52A1\\u671F\\u5185\\u4E3A\\u7532\\u65B9\\u63D0\\u4F9B\\u670D\\u52A1\\u3002\\u4E3A\\u907F\\u514D\\u6B67\\u4E49\\uFF0C\\u201C\\u670D\\u52A1\\u671F\\u201D\\u7CFB\\u6307\\u7532\\u65B9\\u6240\\u9009\\u62E9\\u7684\\u4EA7\\u54C1\\u5728\\u201C\\u9644\\u5F55\\u4E00\\u201D\\u4E2D\\u6240\\u5BF9\\u5E94\\u7684\\u4EA7\\u54C1\\u670D\\u52A1\\u671F\\uFF0C\\u4EE5\\u534F\\u8BAE\\u7B7E\\u7F72\\u65E5\\u4E3A\\u8D77\\u59CB\\u65E5\\u3002\");\n      }; // 服务期间输入框\n\n\n      var ServiceTimeInput = function ServiceTimeInput() {\n        return React.createElement(_Form.Item, {\n          label: \"\\u670D\\u52A1\\u671F\\u95F4\"\n        }, getFieldDecorator('servicePeriod', {\n          rules: noTxtRequireRule,\n          validateFirst: true\n        })(React.createElement(RangePicker, {\n          placeholder: ['开始时间', '结束时间'],\n          style: {\n            width: '100%'\n          }\n        })));\n      }; // 冻结期间输入框\n\n\n      var FreezeTimeInput = function FreezeTimeInput() {\n        var freezeDayCount = _this2.state.freezeDayCount;\n        return React.createElement(_Form.Item, null, React.createElement(RequiredFormItemTitle, null, \"\\u51BB\\u7ED3\\u671F\\u95F4\"), React.createElement(FormItemSubtitle, null, \"\\u51BB\\u7ED3\\u671F\\u95F4\\u5FC5\\u987B\\u5728\\u670D\\u52A1\\u671F\\u95F4\\u5185\\uFF08\\u4E24\\u8005\\u53EF\\u4E00\\u81F4\\uFF09\"), React.createElement(FormItemBodyWrapper, null, getFieldDecorator('freezePeriod', {\n          rules: [].concat(_toConsumableArray(noTxtRequireRule), [{\n            validator: _this2.checkFreezePeriod\n          }]),\n          validateFirst: true\n        })(React.createElement(RangePicker, {\n          onChange: _this2.onChangeFreezeDate,\n          placeholder: ['开始时间', '结束时间'],\n          style: {\n            width: '100%'\n          }\n        }))), React.createElement(FormItemTitle, null, \"\\u5171\\u51BB\\u7ED3 \", freezeDayCount, \" \\u5929\"));\n      };\n\n      var tabContent;\n\n      if (tabIndex === 0) {\n        tabContent = React.createElement(Hint, null);\n      }\n\n      if (tabIndex === 1) {\n        tabContent = React.createElement(ServiceTimeInput, null);\n      }\n\n      if (tabIndex === 2) {\n        tabContent = React.createElement(React.Fragment, null, React.createElement(ServiceTimeInput, null), React.createElement(FreezeTimeInput, null));\n      }\n\n      return React.createElement(_Form, {\n        style: this.props.hidden ? HiddenStyle : FormStyle\n      }, React.createElement(ChildTitle, null, \"\\u8BF7\\u8BBE\\u7F6E\\u670D\\u52A1\\u671F\\u7C7B\\u522B\"), React.createElement(TabsWrapper, null, React.createElement(_Radio.Group, {\n        defaultValue: tabIndex,\n        onChange: this.onChangeTab\n      }, servicePeriodTypes.map(function (v, i) {\n        var id = v.id,\n            name = v.name;\n        return React.createElement(_Radio.Button, {\n          key: id,\n          value: i\n        }, \"\\u670D\\u52A1\\u671F\".concat(name));\n      }))), React.createElement(ContentWrapper, null, tabContent), React.createElement(_Form.Item, {\n        style: ButtonWrapperStyle\n      }, React.createElement(_Button, {\n        style: buttonStyle,\n        onClick: this.onClickLastStep\n      }, \"\\u4E0A\\u4E00\\u6B65\"), React.createElement(_Button, {\n        style: buttonStyle,\n        onClick: this.onClickNextStep,\n        type: \"primary\"\n      }, \"\\u4E0B\\u4E00\\u6B65\")));\n    }\n  }]);\n\n  return ModuleForm;\n}(React.Component);\n\nvar ServiceTime = _Form.create()(ModuleForm);\n\nexport default ServiceTime;\nvar TabsWrapper = styled.div.withConfig({\n  displayName: \"ServiceTime__TabsWrapper\",\n  componentId: \"lwhkwg-0\"\n})([\"display:flex;justify-content:center;margin-bottom:40px;\"]);\nvar ContentWrapper = styled.div.withConfig({\n  displayName: \"ServiceTime__ContentWrapper\",\n  componentId: \"lwhkwg-1\"\n})([\"position:relative;margin-bottom:40px;\"]);","map":null,"metadata":{},"sourceType":"module"}
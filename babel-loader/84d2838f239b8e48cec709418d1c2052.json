{"ast":null,"code":"import \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/spin/style\";\nimport _Spin from \"antd/lib/spin\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport Router from 'next/router';\nimport React from 'react';\nimport styled from 'styled-components';\nimport QueryGetAgreementByNo, { query } from '../../agreementDetails/containers/QueryGetAgreementByNo';\nimport { signAgreementMutation } from '../../agreementManagement/containers/AgreementMutations';\nimport AgreementAlphaContents from '../../agreementDetails/components/AgreementAlphaContents';\nimport AgreementEliteContents from '../../agreementDetails/components/AgreementEliteContents';\nimport ContentSignToView from '../components/ContentSignToView';\nimport ContentToView from '../components/ContentToView';\nvar AgreementFlex = styled.div.withConfig({\n  displayName: \"AgreementViewContainer__AgreementFlex\",\n  componentId: \"sc-1dhauvw-0\"\n})([\"display:flex;align-items:center;flex-direction:column;justify-content:center;\"]);\nvar AgreementView = styled.div.withConfig({\n  displayName: \"AgreementViewContainer__AgreementView\",\n  componentId: \"sc-1dhauvw-1\"\n})([\"display:flex;flex-direction:column;margin:0 15%;@media (max-width:768px){margin:0 0;> div div{width:90%;}> div h3{margin:30px 0;}}\"]);\nvar AgreementViewBottom = styled.div.withConfig({\n  displayName: \"AgreementViewContainer__AgreementViewBottom\",\n  componentId: \"sc-1dhauvw-2\"\n})([\"position:fixed;bottom:0;display:flex;align-items:center;justify-content:center;width:100%;height:140px;text-align:center;background:white;@media (max-width:768px){width:90%;height:40px;}\"]);\nvar ContextCenter = styled.div.withConfig({\n  displayName: \"AgreementViewContainer__ContextCenter\",\n  componentId: \"sc-1dhauvw-3\"\n})([\"margin-top:30%;text-align:center;\"]);\n\nvar AgreementViewContainer =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(AgreementViewContainer, _React$Component);\n\n  function AgreementViewContainer() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, AgreementViewContainer);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(AgreementViewContainer)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      showTip: true,\n      alertSigned: false,\n      showSignTip: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"signAgreement\",\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(agreementNo) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return _this.client.mutate({\n                  mutation: signAgreementMutation,\n                  variables: {\n                    input: {\n                      agreementNo: agreementNo\n                    }\n                  },\n                  update: function update(store, _ref2) {\n                    var signAgreement = _ref2.data.signAgreement;\n                    store.writeQuery({\n                      query: query,\n                      variables: {\n                        input: {\n                          agreementNo: agreementNo\n                        }\n                      },\n                      data: {\n                        GetAgreementByNo: {\n                          status: signAgreement.status\n                        }\n                      }\n                    });\n                  }\n                }).then(function () {\n                  _this.setState({\n                    showSignTip: false\n                  });\n                }).catch(function () {\n                  _this.setState({\n                    alertSigned: true\n                  });\n                });\n\n              case 2:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"viewContent\", function () {\n      _this.setState({\n        showTip: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"viewContentSign\", function () {\n      _this.setState({\n        showSignTip: true\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(AgreementViewContainer, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var routerQuery = Router.router && Router.router.query;\n\n      if (this.state.alertSigned) {\n        return React.createElement(ContextCenter, null, \" \\u4F60\\u5DF2\\u7ECF\\u7B7E\\u7F72\\u8FC7\\u4E86 \");\n      }\n\n      return routerQuery && React.createElement(QueryGetAgreementByNo, {\n        ssr: false,\n        query: query,\n        variables: {\n          input: {\n            agreementNo: routerQuery.agreementNo\n          }\n        }\n      }, function (_ref3) {\n        var data = _ref3.data,\n            loading = _ref3.loading,\n            error = _ref3.error,\n            client = _ref3.client;\n\n        if (loading) {\n          return React.createElement(LoadingWrapper, null, React.createElement(_Spin, {\n            tip: \"Loading...\",\n            size: \"large\"\n          }));\n        }\n\n        if (error) {\n          return null;\n        }\n\n        _this2.client = client;\n\n        if (!data || !data.getAgreementByNo) {\n          return null;\n        }\n\n        var status = data.getAgreementByNo.status.key;\n        var type = 'default';\n        var disabled = true;\n\n        if (_this2.state.showTip) {\n          return React.createElement(ContentToView, {\n            data: data.getAgreementByNo,\n            viewContent: _this2.viewContent\n          });\n        }\n\n        if (status === 'PENDINGSIGN') {\n          if (_this2.state.showSignTip) {\n            return React.createElement(ContentSignToView, {\n              data: data.getAgreementByNo,\n              signAgreement: _this2.signAgreement.bind(_this2, data.getAgreementByNo.agreementNo)\n            });\n          }\n\n          type = 'primary';\n          disabled = false;\n        }\n\n        return React.createElement(AgreementFlex, null, React.createElement(AgreementView, null, data.getAgreementByNo.name.includes('Alpha') ? React.createElement(AgreementAlphaContents, {\n          data: data.getAgreementByNo\n        }) : React.createElement(AgreementEliteContents, {\n          data: data.getAgreementByNo\n        })), React.createElement(AgreementViewBottom, null, React.createElement(_Button, {\n          style: {\n            width: '335px',\n            height: '40px',\n            marginBottom: '40px'\n          },\n          type: type,\n          disabled: disabled,\n          onClick: _this2.viewContentSign\n        }, data.getAgreementByNo.status.key === 'PENDINGSIGN' ? '签署协议' : data.getAgreementByNo.status.name)));\n      });\n    }\n  }]);\n\n  return AgreementViewContainer;\n}(React.Component);\n\nexport default AgreementViewContainer;\nvar LoadingWrapper = styled.div.withConfig({\n  displayName: \"AgreementViewContainer__LoadingWrapper\",\n  componentId: \"sc-1dhauvw-4\"\n})([\"display:flex;align-items:center;justify-content:center;height:100vh;\"]);","map":null,"metadata":{},"sourceType":"module"}
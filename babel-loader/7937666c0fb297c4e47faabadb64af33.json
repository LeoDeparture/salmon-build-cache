{"ast":null,"code":"import \"antd/lib/popover/style\";\nimport _Popover from \"antd/lib/popover\";\nimport \"antd/lib/icon/style\";\nimport _Icon from \"antd/lib/icon\";\nimport \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport \"antd/lib/breadcrumb/style\";\nimport _Breadcrumb from \"antd/lib/breadcrumb\";\nimport _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _objectSpread from \"@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport Link from 'next/link';\nimport Router from 'next/router';\nimport React from 'react';\nimport styled from 'styled-components';\nimport PageHeader from '../../../../components/PageLayout/PageHeader';\nimport SortableModal from '../../../../components/SortableModal';\nimport { breakLine } from '../../../../lib/commonJs';\nimport { recordToTemplateFields } from '../../commonJs';\nimport EditTemplate from '../CreateOrEditTemplate';\nimport DeleteComponent from '../DeleteComponent';\nimport CreateSession from './CreateOrEditSession';\nimport SessionList from './SessionList';\n\nvar TemplateDetail =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(TemplateDetail, _React$Component);\n\n  function TemplateDetail() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, TemplateDetail);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(TemplateDetail)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      status: 0,\n      infoCollapse: true\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"toggleInfo\", function () {\n      var infoCollapse = _this.state.infoCollapse;\n\n      _this.setState({\n        infoCollapse: !infoCollapse\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"goBack\", function () {\n      Router.push('/pathway-template');\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"changeStatus\", function (status) {\n      _this.setState({\n        status: status\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSuccess\", function () {\n      _this.setState({\n        status: 0\n      }, _this.props.refetch);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onRefSessionSorter\", function (ref) {\n      _this.sessionSorter = ref;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickSortBtn\", function () {\n      _this.sessionSorter.showPop();\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getListItemsHelper\", function () {\n      var sessions = _this.props.template.sessionTemplates.map(function (session) {\n        return _objectSpread({}, session, {\n          name: session.purpose\n        });\n      });\n\n      return _Promise.resolve(sessions);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setListItemsHelper\", function (sortItems) {\n      var positions = sortItems.map(function (v) {\n        return {\n          sessionTemplateId: v.id,\n          position: v.sort - 1\n        };\n      });\n      return _this.props.sortSessions(positions);\n    });\n\n    return _this;\n  }\n\n  _createClass(TemplateDetail, [{\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          infoCollapse = _this$state.infoCollapse,\n          status = _this$state.status;\n      var _this$props$template = this.props.template,\n          id = _this$props$template.id,\n          name = _this$props$template.name,\n          highlights = _this$props$template.highlights,\n          introduction = _this$props$template.introduction,\n          purpose = _this$props$template.purpose,\n          remarks = _this$props$template.remarks,\n          industries = _this$props$template.industries,\n          suggestionDays = _this$props$template.suggestionDays,\n          sessionTemplates = _this$props$template.sessionTemplates;\n      var sessionNumber = sessionTemplates.length; // 编辑学习计划模板\n\n      if (status === 1) {\n        var fields = recordToTemplateFields(this.props.template);\n        return React.createElement(React.Fragment, null, React.createElement(PageHeader, {\n          titleText: \"\\u7F16\\u8F91\\u5B66\\u4E60\\u8BA1\\u5212\\u6A21\\u7248\"\n        }), React.createElement(Body, null, React.createElement(EditTemplate, {\n          fields: fields,\n          type: \"edit\",\n          onSuccess: this.onSuccess,\n          onCancel: this.changeStatus.bind(this, 0)\n        })));\n      } // 创建阶段\n\n\n      if (status === 2) {\n        var templateId = this.props.template.id;\n        return React.createElement(React.Fragment, null, React.createElement(PageHeader, {\n          titleText: \"\\u521B\\u5EFA\\u5B66\\u4E60\\u8BA1\\u5212\\u9636\\u6BB5\"\n        }), React.createElement(Body, null, React.createElement(CreateSession, {\n          type: \"create\",\n          onSuccess: this.onSuccess,\n          onCancel: this.changeStatus.bind(this, 0),\n          templateId: templateId\n        })));\n      }\n\n      if (!status) {\n        return React.createElement(React.Fragment, null, React.createElement(Info, null, React.createElement(_Breadcrumb, null, React.createElement(_Breadcrumb.Item, null, React.createElement(Link, {\n          href: \"/pathway-template\"\n        }, React.createElement(\"a\", null, \"\\u5B66\\u4E60\\u8BA1\\u5212\\u6A21\\u677F\\u5E93\"))), React.createElement(_Breadcrumb.Item, null, \"\\u5B66\\u4E60\\u8BA1\\u5212\\u6A21\\u677F\\u8BE6\\u60C5\")), React.createElement(InfoHeader, null, React.createElement(NameWrapper, null, React.createElement(Name, null, name)), React.createElement(Buttons, null, React.createElement(DeleteComponent, {\n          count: sessionNumber,\n          deleteSuccess: this.goBack,\n          id: id,\n          type: \"template\",\n          isButton: true\n        }), React.createElement(_Button, {\n          onClick: this.changeStatus.bind(this, 1),\n          style: {\n            marginLeft: '12px'\n          }\n        }, \"\\u7F16\\u8F91\"))), React.createElement(InfoBody, null, React.createElement(InlineContainer, null, React.createElement(Item, {\n          style: {\n            marginRight: '45px'\n          }\n        }, React.createElement(ItemTitle, null, \"\\u5EFA\\u8BAE\\u5929\\u6570\\uFF1A\"), React.createElement(ItemContent, null, suggestionDays)), React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u884C\\u4E1A\\uFF1A\"), React.createElement(ItemContent, null, industries.map(function (v) {\n          return v.name;\n        }).join('、')))), React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u5BF9\\u5185\\u5907\\u6CE8\\uFF1A\"), React.createElement(ItemContent, null, breakLine(remarks))), !infoCollapse && React.createElement(React.Fragment, null, React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u8BA1\\u5212\\u76EE\\u6807\\uFF1A\"), React.createElement(ItemContent, null, purpose)), React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u76EE\\u6807\\u7B80\\u4ECB\\uFF1A\"), React.createElement(ItemContent, null, breakLine(introduction))), React.createElement(Item, null, React.createElement(ItemTitle, null, \"\\u8BA1\\u5212\\u4EAE\\u70B9\\uFF1A\"), React.createElement(ItemContent, null, breakLine(highlights))))), React.createElement(ToggleWrapper, null, React.createElement(\"a\", {\n          onClick: this.toggleInfo\n        }, infoCollapse ? '展开' : '收起', \"\\u66F4\\u591A\\u4FE1\\u606F\", React.createElement(_Icon, {\n          type: infoCollapse ? 'down' : 'up',\n          style: IconStyle\n        })))), React.createElement(Body, null, React.createElement(TableHeader, null, React.createElement(Name, null, \"\\u6B64\\u5B66\\u4E60\\u8BA1\\u5212\\u5185\\u9636\\u6BB5\\uFF08\".concat(sessionNumber, \"\\uFF09\")), React.createElement(Buttons, null, sessionNumber >= 2 && React.createElement(_Button, {\n          onClick: this.onClickSortBtn\n        }, \"\\u6392\\u5E8F\"), sessionNumber < 2 && React.createElement(_Popover, {\n          placement: \"bottom\",\n          content: React.createElement(React.Fragment, null, React.createElement(\"div\", null, \"\\u4F7F\\u7528\\u6392\\u5E8F\\u529F\\u80FD\\u9700\\u6EE1\\u8DB3\\u5982\\u4E0B\\u6761\\u4EF6\\uFF1A\"), React.createElement(\"div\", null, \"\\u6B64\\u6A21\\u7248\\u81F3\\u5C11\\u9700\\u89812\\u4E2A\\u9636\\u6BB5\\u3002\"))\n        }, React.createElement(_Button, {\n          disabled: true\n        }, \"\\u6392\\u5E8F\")), React.createElement(_Button, {\n          onClick: this.changeStatus.bind(this, 2),\n          type: \"primary\",\n          style: {\n            marginLeft: '12px'\n          }\n        }, \"\\u521B\\u5EFA\\u5B66\\u4E60\\u8BA1\\u5212\\u9636\\u6BB5\"))), React.createElement(SortableModal, {\n          onRef: this.onRefSessionSorter,\n          title: \"\\u6B64\\u6A21\\u677F\\u5185\\u9636\\u6BB5\",\n          getListItemsHelper: this.getListItemsHelper,\n          setListItemsHelper: this.setListItemsHelper\n        }), React.createElement(SessionList, {\n          sessions: sessionTemplates,\n          refetch: this.props.refetch\n        })));\n      }\n\n      return null;\n    }\n  }]);\n\n  return TemplateDetail;\n}(React.Component);\n\nexport default TemplateDetail; // 上半部分\n\nexport var Info = styled.div.withConfig({\n  displayName: \"TemplateDetail__Info\",\n  componentId: \"sc-10e44me-0\"\n})([\"padding:16px 32px;background-color:#fff;\"]);\nexport var InfoHeader = styled.div.withConfig({\n  displayName: \"TemplateDetail__InfoHeader\",\n  componentId: \"sc-10e44me-1\"\n})([\"display:flex;align-items:center;justify-content:space-between;height:60px;\"]);\nexport var NameWrapper = styled.div.withConfig({\n  displayName: \"TemplateDetail__NameWrapper\",\n  componentId: \"sc-10e44me-2\"\n})([\"display:flex;flex:1;overflow:hidden;\"]);\nexport var BadgeWrapper = styled.div.withConfig({\n  displayName: \"TemplateDetail__BadgeWrapper\",\n  componentId: \"sc-10e44me-3\"\n})([\"width:180px;\"]);\nexport var Name = styled.span.withConfig({\n  displayName: \"TemplateDetail__Name\",\n  componentId: \"sc-10e44me-4\"\n})([\"margin-right:10px;overflow:hidden;font-size:20px;font-weight:500;line-height:28px;color:rgba(0,0,0,0.85);text-overflow:ellipsis;white-space:nowrap;\"]);\nexport var Buttons = styled.div.withConfig({\n  displayName: \"TemplateDetail__Buttons\",\n  componentId: \"sc-10e44me-5\"\n})([\"position:relative;margin-left:20px;\"]);\nexport var InfoBody = styled.div.withConfig({\n  displayName: \"TemplateDetail__InfoBody\",\n  componentId: \"sc-10e44me-6\"\n})([\"position:relative;width:826px;font-size:14px;line-height:22px;p{margin-bottom:0;}\"]);\nexport var Item = styled.div.withConfig({\n  displayName: \"TemplateDetail__Item\",\n  componentId: \"sc-10e44me-7\"\n})([\"display:flex;min-width:200px;margin-bottom:16px;\"]);\nexport var InlineContainer = styled.div.withConfig({\n  displayName: \"TemplateDetail__InlineContainer\",\n  componentId: \"sc-10e44me-8\"\n})([\"display:flex;\"]);\nexport var ItemTitle = styled.div.withConfig({\n  displayName: \"TemplateDetail__ItemTitle\",\n  componentId: \"sc-10e44me-9\"\n})([\"max-width:70px;color:rgba(0,0,0,0.25);\"]);\nexport var ItemContent = styled.div.withConfig({\n  displayName: \"TemplateDetail__ItemContent\",\n  componentId: \"sc-10e44me-10\"\n})([\"flex:1;color:rgba(0,0,0,0.65);word-break:break-all;\"]);\nexport var ToggleWrapper = styled.div.withConfig({\n  displayName: \"TemplateDetail__ToggleWrapper\",\n  componentId: \"sc-10e44me-11\"\n})([\"height:22px;margin-top:8px;font-size:14px;line-height:22px;text-align:center;\"]);\nexport var IconStyle = {\n  fontSize: '12px',\n  lineHeight: '22px',\n  marginLeft: '6px',\n  transform: 'scale(1, 0.9)',\n  verticalAlign: 'middle'\n}; // 下半部分\n\nexport var Body = styled.div.withConfig({\n  displayName: \"TemplateDetail__Body\",\n  componentId: \"sc-10e44me-12\"\n})([\"flex:1;min-height:400px;margin:24px;background-color:#fff;\"]);\nexport var TableHeader = styled.div.withConfig({\n  displayName: \"TemplateDetail__TableHeader\",\n  componentId: \"sc-10e44me-13\"\n})([\"display:flex;align-items:center;justify-content:space-between;height:64px;padding:0 32px;\"]);","map":null,"metadata":{},"sourceType":"module"}